<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器缓存 | Hello Wold</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/lanjz/assets/css/0.styles.5dda244b.css" as="style"><link rel="preload" href="/lanjz/assets/js/app.813b5437.js" as="script"><link rel="preload" href="/lanjz/assets/js/2.82bd5d43.js" as="script"><link rel="preload" href="/lanjz/assets/js/181.4022ee34.js" as="script"><link rel="prefetch" href="/lanjz/assets/js/10.40521fb6.js"><link rel="prefetch" href="/lanjz/assets/js/100.88f0c3d5.js"><link rel="prefetch" href="/lanjz/assets/js/101.d8905d25.js"><link rel="prefetch" href="/lanjz/assets/js/102.743b674c.js"><link rel="prefetch" href="/lanjz/assets/js/103.aba07e9d.js"><link rel="prefetch" href="/lanjz/assets/js/104.df5c89cd.js"><link rel="prefetch" href="/lanjz/assets/js/105.5a3d7c34.js"><link rel="prefetch" href="/lanjz/assets/js/106.940b08fa.js"><link rel="prefetch" href="/lanjz/assets/js/107.62aea4cf.js"><link rel="prefetch" href="/lanjz/assets/js/108.9c039939.js"><link rel="prefetch" href="/lanjz/assets/js/109.a75c3c80.js"><link rel="prefetch" href="/lanjz/assets/js/11.00edf672.js"><link rel="prefetch" href="/lanjz/assets/js/110.2bfdb0bc.js"><link rel="prefetch" href="/lanjz/assets/js/111.66098518.js"><link rel="prefetch" href="/lanjz/assets/js/112.a35020cf.js"><link rel="prefetch" href="/lanjz/assets/js/113.1099ca6e.js"><link rel="prefetch" href="/lanjz/assets/js/114.ef11595f.js"><link rel="prefetch" href="/lanjz/assets/js/115.9559b64b.js"><link rel="prefetch" href="/lanjz/assets/js/116.049431eb.js"><link rel="prefetch" href="/lanjz/assets/js/117.d7879052.js"><link rel="prefetch" href="/lanjz/assets/js/118.8226d06e.js"><link rel="prefetch" href="/lanjz/assets/js/119.c82c290e.js"><link rel="prefetch" href="/lanjz/assets/js/12.0434cc42.js"><link rel="prefetch" href="/lanjz/assets/js/120.92fe112a.js"><link rel="prefetch" href="/lanjz/assets/js/121.520edf11.js"><link rel="prefetch" href="/lanjz/assets/js/122.d27d7309.js"><link rel="prefetch" href="/lanjz/assets/js/123.1c72d91a.js"><link rel="prefetch" href="/lanjz/assets/js/124.c8fd3449.js"><link rel="prefetch" href="/lanjz/assets/js/125.fb2898c7.js"><link rel="prefetch" href="/lanjz/assets/js/126.19ffe3b1.js"><link rel="prefetch" href="/lanjz/assets/js/127.65e2f62d.js"><link rel="prefetch" href="/lanjz/assets/js/128.65c5e808.js"><link rel="prefetch" href="/lanjz/assets/js/129.ef20de60.js"><link rel="prefetch" href="/lanjz/assets/js/13.4f21d7bd.js"><link rel="prefetch" href="/lanjz/assets/js/130.613c9c4c.js"><link rel="prefetch" href="/lanjz/assets/js/131.c6d6ed89.js"><link rel="prefetch" href="/lanjz/assets/js/132.165c2b2c.js"><link rel="prefetch" href="/lanjz/assets/js/133.0030c8eb.js"><link rel="prefetch" href="/lanjz/assets/js/134.ea3a5444.js"><link rel="prefetch" href="/lanjz/assets/js/135.dea567ba.js"><link rel="prefetch" href="/lanjz/assets/js/136.a3e2c4d5.js"><link rel="prefetch" href="/lanjz/assets/js/137.4183d669.js"><link rel="prefetch" href="/lanjz/assets/js/138.f3d424ed.js"><link rel="prefetch" href="/lanjz/assets/js/139.8df053f2.js"><link rel="prefetch" href="/lanjz/assets/js/14.53a1979d.js"><link rel="prefetch" href="/lanjz/assets/js/140.f2131c1a.js"><link rel="prefetch" href="/lanjz/assets/js/141.533bb90b.js"><link rel="prefetch" href="/lanjz/assets/js/142.83276daa.js"><link rel="prefetch" href="/lanjz/assets/js/143.6684997e.js"><link rel="prefetch" href="/lanjz/assets/js/144.fbf3d16d.js"><link rel="prefetch" href="/lanjz/assets/js/145.8cc53e60.js"><link rel="prefetch" href="/lanjz/assets/js/146.a7534a68.js"><link rel="prefetch" href="/lanjz/assets/js/147.f606e4f1.js"><link rel="prefetch" href="/lanjz/assets/js/148.1e0d044d.js"><link rel="prefetch" href="/lanjz/assets/js/149.2a0101b2.js"><link rel="prefetch" href="/lanjz/assets/js/15.07c671b5.js"><link rel="prefetch" href="/lanjz/assets/js/150.5fcff7e4.js"><link rel="prefetch" href="/lanjz/assets/js/151.0afcdc40.js"><link rel="prefetch" href="/lanjz/assets/js/152.7d1f36a5.js"><link rel="prefetch" href="/lanjz/assets/js/153.4076cbba.js"><link rel="prefetch" href="/lanjz/assets/js/154.0f3cef85.js"><link rel="prefetch" href="/lanjz/assets/js/155.1dcd665a.js"><link rel="prefetch" href="/lanjz/assets/js/156.56feaeda.js"><link rel="prefetch" href="/lanjz/assets/js/157.71c65cd8.js"><link rel="prefetch" href="/lanjz/assets/js/158.ea57dce7.js"><link rel="prefetch" href="/lanjz/assets/js/159.71c4d199.js"><link rel="prefetch" href="/lanjz/assets/js/16.7c8b9b9c.js"><link rel="prefetch" href="/lanjz/assets/js/160.e51b96b9.js"><link rel="prefetch" href="/lanjz/assets/js/161.de5e6299.js"><link rel="prefetch" href="/lanjz/assets/js/162.59300730.js"><link rel="prefetch" href="/lanjz/assets/js/163.a38fecb7.js"><link rel="prefetch" href="/lanjz/assets/js/164.bbfbe91b.js"><link rel="prefetch" href="/lanjz/assets/js/165.ab6def86.js"><link rel="prefetch" href="/lanjz/assets/js/166.395a7613.js"><link rel="prefetch" href="/lanjz/assets/js/167.8d3ca4e3.js"><link rel="prefetch" href="/lanjz/assets/js/168.b057030f.js"><link rel="prefetch" href="/lanjz/assets/js/169.ad1f910a.js"><link rel="prefetch" href="/lanjz/assets/js/17.fea6ce09.js"><link rel="prefetch" href="/lanjz/assets/js/170.2c28b8d9.js"><link rel="prefetch" href="/lanjz/assets/js/171.0140079a.js"><link rel="prefetch" href="/lanjz/assets/js/172.06f7b7a6.js"><link rel="prefetch" href="/lanjz/assets/js/173.7baf8d4c.js"><link rel="prefetch" href="/lanjz/assets/js/174.014c31ad.js"><link rel="prefetch" href="/lanjz/assets/js/175.bf9ce9a0.js"><link rel="prefetch" href="/lanjz/assets/js/176.2193fe98.js"><link rel="prefetch" href="/lanjz/assets/js/177.06f16aa1.js"><link rel="prefetch" href="/lanjz/assets/js/178.676eb2fe.js"><link rel="prefetch" href="/lanjz/assets/js/179.99ce56c8.js"><link rel="prefetch" href="/lanjz/assets/js/18.6e2dd6b6.js"><link rel="prefetch" href="/lanjz/assets/js/180.87e47708.js"><link rel="prefetch" href="/lanjz/assets/js/182.2b543cb1.js"><link rel="prefetch" href="/lanjz/assets/js/183.c0942e39.js"><link rel="prefetch" href="/lanjz/assets/js/184.1fcbdc46.js"><link rel="prefetch" href="/lanjz/assets/js/185.a4354958.js"><link rel="prefetch" href="/lanjz/assets/js/186.472b0fcc.js"><link rel="prefetch" href="/lanjz/assets/js/187.e395378a.js"><link rel="prefetch" href="/lanjz/assets/js/188.1bf6ca84.js"><link rel="prefetch" href="/lanjz/assets/js/189.b21235ce.js"><link rel="prefetch" href="/lanjz/assets/js/19.849ec92b.js"><link rel="prefetch" href="/lanjz/assets/js/190.00238359.js"><link rel="prefetch" href="/lanjz/assets/js/191.b44e706e.js"><link rel="prefetch" href="/lanjz/assets/js/192.d8361bf0.js"><link rel="prefetch" href="/lanjz/assets/js/193.113a1d6f.js"><link rel="prefetch" href="/lanjz/assets/js/194.79c81974.js"><link rel="prefetch" href="/lanjz/assets/js/195.a48a5b30.js"><link rel="prefetch" href="/lanjz/assets/js/196.2626109d.js"><link rel="prefetch" href="/lanjz/assets/js/197.050c774c.js"><link rel="prefetch" href="/lanjz/assets/js/198.0788a3e2.js"><link rel="prefetch" href="/lanjz/assets/js/199.92cbbcb3.js"><link rel="prefetch" href="/lanjz/assets/js/20.25276dae.js"><link rel="prefetch" href="/lanjz/assets/js/200.b0ea2dbe.js"><link rel="prefetch" href="/lanjz/assets/js/201.68222cc7.js"><link rel="prefetch" href="/lanjz/assets/js/202.29ea7767.js"><link rel="prefetch" href="/lanjz/assets/js/203.16739e32.js"><link rel="prefetch" href="/lanjz/assets/js/21.02609668.js"><link rel="prefetch" href="/lanjz/assets/js/22.1e906bbb.js"><link rel="prefetch" href="/lanjz/assets/js/23.755c9caf.js"><link rel="prefetch" href="/lanjz/assets/js/24.c36814f3.js"><link rel="prefetch" href="/lanjz/assets/js/25.7e6173f8.js"><link rel="prefetch" href="/lanjz/assets/js/26.7aea05eb.js"><link rel="prefetch" href="/lanjz/assets/js/27.744fa4a3.js"><link rel="prefetch" href="/lanjz/assets/js/28.f5b53d34.js"><link rel="prefetch" href="/lanjz/assets/js/29.76d66b5c.js"><link rel="prefetch" href="/lanjz/assets/js/3.9a0ee666.js"><link rel="prefetch" href="/lanjz/assets/js/30.eba97fe8.js"><link rel="prefetch" href="/lanjz/assets/js/31.5f530ed4.js"><link rel="prefetch" href="/lanjz/assets/js/32.9b327fc7.js"><link rel="prefetch" href="/lanjz/assets/js/33.9e882529.js"><link rel="prefetch" href="/lanjz/assets/js/34.fa31ad2e.js"><link rel="prefetch" href="/lanjz/assets/js/35.ec272a7d.js"><link rel="prefetch" href="/lanjz/assets/js/36.96487cfc.js"><link rel="prefetch" href="/lanjz/assets/js/37.993f1bb4.js"><link rel="prefetch" href="/lanjz/assets/js/38.5b7d3ceb.js"><link rel="prefetch" href="/lanjz/assets/js/39.c9c72acf.js"><link rel="prefetch" href="/lanjz/assets/js/4.f3fd3104.js"><link rel="prefetch" href="/lanjz/assets/js/40.3148b58e.js"><link rel="prefetch" href="/lanjz/assets/js/41.e47b453b.js"><link rel="prefetch" href="/lanjz/assets/js/42.be0d2a34.js"><link rel="prefetch" href="/lanjz/assets/js/43.946693e9.js"><link rel="prefetch" href="/lanjz/assets/js/44.13178078.js"><link rel="prefetch" href="/lanjz/assets/js/45.eec0d53d.js"><link rel="prefetch" href="/lanjz/assets/js/46.bccf176e.js"><link rel="prefetch" href="/lanjz/assets/js/47.c8a23e59.js"><link rel="prefetch" href="/lanjz/assets/js/48.12a0a1e8.js"><link rel="prefetch" href="/lanjz/assets/js/49.1de7e7fe.js"><link rel="prefetch" href="/lanjz/assets/js/5.fef5d413.js"><link rel="prefetch" href="/lanjz/assets/js/50.905cb303.js"><link rel="prefetch" href="/lanjz/assets/js/51.5482d68c.js"><link rel="prefetch" href="/lanjz/assets/js/52.08d237fc.js"><link rel="prefetch" href="/lanjz/assets/js/53.a437eb31.js"><link rel="prefetch" href="/lanjz/assets/js/54.bd290db0.js"><link rel="prefetch" href="/lanjz/assets/js/55.88744329.js"><link rel="prefetch" href="/lanjz/assets/js/56.715ed8e7.js"><link rel="prefetch" href="/lanjz/assets/js/57.ef94f80a.js"><link rel="prefetch" href="/lanjz/assets/js/58.7675bd0d.js"><link rel="prefetch" href="/lanjz/assets/js/59.5b40805a.js"><link rel="prefetch" href="/lanjz/assets/js/6.17be76f3.js"><link rel="prefetch" href="/lanjz/assets/js/60.ba0e158a.js"><link rel="prefetch" href="/lanjz/assets/js/61.ff252fc6.js"><link rel="prefetch" href="/lanjz/assets/js/62.7975606f.js"><link rel="prefetch" href="/lanjz/assets/js/63.36ff887d.js"><link rel="prefetch" href="/lanjz/assets/js/64.32fb92e6.js"><link rel="prefetch" href="/lanjz/assets/js/65.db53fb78.js"><link rel="prefetch" href="/lanjz/assets/js/66.8cd55ee0.js"><link rel="prefetch" href="/lanjz/assets/js/67.8744c390.js"><link rel="prefetch" href="/lanjz/assets/js/68.556a80f4.js"><link rel="prefetch" href="/lanjz/assets/js/69.8ef844fa.js"><link rel="prefetch" href="/lanjz/assets/js/7.fbe3e821.js"><link rel="prefetch" href="/lanjz/assets/js/70.6ad0eaab.js"><link rel="prefetch" href="/lanjz/assets/js/71.c98ae989.js"><link rel="prefetch" href="/lanjz/assets/js/72.bd1b52d3.js"><link rel="prefetch" href="/lanjz/assets/js/73.0c3bb53e.js"><link rel="prefetch" href="/lanjz/assets/js/74.9f6a4a8e.js"><link rel="prefetch" href="/lanjz/assets/js/75.8c2bedc8.js"><link rel="prefetch" href="/lanjz/assets/js/76.e4ab5b20.js"><link rel="prefetch" href="/lanjz/assets/js/77.c2f599ba.js"><link rel="prefetch" href="/lanjz/assets/js/78.fa11a911.js"><link rel="prefetch" href="/lanjz/assets/js/79.6c90acb5.js"><link rel="prefetch" href="/lanjz/assets/js/8.1bf3b67c.js"><link rel="prefetch" href="/lanjz/assets/js/80.9ec5e810.js"><link rel="prefetch" href="/lanjz/assets/js/81.5de6e8a0.js"><link rel="prefetch" href="/lanjz/assets/js/82.c5f1e42a.js"><link rel="prefetch" href="/lanjz/assets/js/83.292e2227.js"><link rel="prefetch" href="/lanjz/assets/js/84.e7449179.js"><link rel="prefetch" href="/lanjz/assets/js/85.46f41ed8.js"><link rel="prefetch" href="/lanjz/assets/js/86.d82d0b3e.js"><link rel="prefetch" href="/lanjz/assets/js/87.9f4a4e82.js"><link rel="prefetch" href="/lanjz/assets/js/88.4eb3b150.js"><link rel="prefetch" href="/lanjz/assets/js/89.7cdd7b4f.js"><link rel="prefetch" href="/lanjz/assets/js/9.6de42555.js"><link rel="prefetch" href="/lanjz/assets/js/90.0eb41daa.js"><link rel="prefetch" href="/lanjz/assets/js/91.48c65588.js"><link rel="prefetch" href="/lanjz/assets/js/92.07585057.js"><link rel="prefetch" href="/lanjz/assets/js/93.67545155.js"><link rel="prefetch" href="/lanjz/assets/js/94.5ee44fe4.js"><link rel="prefetch" href="/lanjz/assets/js/95.4d3c9053.js"><link rel="prefetch" href="/lanjz/assets/js/96.a6ebccd4.js"><link rel="prefetch" href="/lanjz/assets/js/97.e18d6648.js"><link rel="prefetch" href="/lanjz/assets/js/98.7227ecda.js"><link rel="prefetch" href="/lanjz/assets/js/99.15737f0e.js">
    <link rel="stylesheet" href="/lanjz/assets/css/0.styles.5dda244b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/lanjz/" class="home-link router-link-active"><!----> <span class="site-name">Hello Wold</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/lanjz/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/ES6/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/HTML5/" class="nav-link">
  HTML5
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Browser/" class="nav-link">
  Browser
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络&amp;算法" class="dropdown-title"><span class="title">网络&amp;算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="网络&amp;算法" class="mobile-dropdown-title"><span class="title">网络&amp;算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/network/" class="nav-link router-link-active">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Algorithm/" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/secure/" class="nav-link">
  Web安全
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Vue3/" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/qiankun/" class="nav-link">
  qiankun
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/NA/" class="nav-link">
  跨平台
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/Node/基础/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Package/" class="nav-link">
  yarn&amp;npm
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Vite/" class="nav-link">
  Vite
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow down"></span></button> <button type="button" aria-label="工程化" class="mobile-dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/工程化/前端优化总结/" class="nav-link">
  前端优化总结
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/系统设计/" class="nav-link">
  系统设计
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/预加载&amp;预解析.html" class="nav-link">
  预加载&amp;预解析
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/重构改善既有代码的设计.html" class="nav-link">
  重构代码原则
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/开发与调试技巧.html" class="nav-link">
  开发与调试
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/组件设计的基本原则.html" class="nav-link">
  组件设计
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/公共模块管理.html" class="nav-link">
  公共模块管理
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/内存泄漏.html" class="nav-link">
  内存泄漏
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/前端异常捕获.html" class="nav-link">
  前端异常捕获
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/自动化部署.html" class="nav-link">
  自动化部署
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/疑难杂症.html" class="nav-link">
  问题小计
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="利其器" class="dropdown-title"><span class="title">利其器</span> <span class="arrow down"></span></button> <button type="button" aria-label="利其器" class="mobile-dropdown-title"><span class="title">利其器</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/利其器/Mac.html" class="nav-link">
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/利其器/Github.html" class="nav-link">
  Github
</a></li></ul></div></div><div class="nav-item"><a href="/lanjz/Im/" class="nav-link">
  关于我
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/lanjz/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/ES6/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/HTML5/" class="nav-link">
  HTML5
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Browser/" class="nav-link">
  Browser
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络&amp;算法" class="dropdown-title"><span class="title">网络&amp;算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="网络&amp;算法" class="mobile-dropdown-title"><span class="title">网络&amp;算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/network/" class="nav-link router-link-active">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Algorithm/" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/secure/" class="nav-link">
  Web安全
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Vue3/" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/qiankun/" class="nav-link">
  qiankun
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/NA/" class="nav-link">
  跨平台
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/Node/基础/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Package/" class="nav-link">
  yarn&amp;npm
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Vite/" class="nav-link">
  Vite
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow down"></span></button> <button type="button" aria-label="工程化" class="mobile-dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/工程化/前端优化总结/" class="nav-link">
  前端优化总结
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/系统设计/" class="nav-link">
  系统设计
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/预加载&amp;预解析.html" class="nav-link">
  预加载&amp;预解析
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/重构改善既有代码的设计.html" class="nav-link">
  重构代码原则
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/开发与调试技巧.html" class="nav-link">
  开发与调试
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/组件设计的基本原则.html" class="nav-link">
  组件设计
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/公共模块管理.html" class="nav-link">
  公共模块管理
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/内存泄漏.html" class="nav-link">
  内存泄漏
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/前端异常捕获.html" class="nav-link">
  前端异常捕获
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/自动化部署.html" class="nav-link">
  自动化部署
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/疑难杂症.html" class="nav-link">
  问题小计
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="利其器" class="dropdown-title"><span class="title">利其器</span> <span class="arrow down"></span></button> <button type="button" aria-label="利其器" class="mobile-dropdown-title"><span class="title">利其器</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/利其器/Mac.html" class="nav-link">
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/利其器/Github.html" class="nav-link">
  Github
</a></li></ul></div></div><div class="nav-item"><a href="/lanjz/Im/" class="nav-link">
  关于我
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/lanjz/network/HTTP及演变.html" class="sidebar-link">HTTP及演变</a></li><li><a href="/lanjz/network/HTTPS.html" class="sidebar-link">HTTPS</a></li><li><a href="/lanjz/network/浏览器缓存.html" class="active sidebar-link">浏览器缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/lanjz/network/浏览器缓存.html#缓存存储策略" class="sidebar-link">缓存存储策略</a></li><li class="sidebar-sub-header"><a href="/lanjz/network/浏览器缓存.html#强缓存" class="sidebar-link">强缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/lanjz/network/浏览器缓存.html#强缓存例子" class="sidebar-link">强缓存例子</a></li><li class="sidebar-sub-header"><a href="/lanjz/network/浏览器缓存.html#from-memory-cache和from-disk-cache" class="sidebar-link">from memory cache和from disk cache</a></li></ul></li><li class="sidebar-sub-header"><a href="/lanjz/network/浏览器缓存.html#协商缓存" class="sidebar-link">协商缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/lanjz/network/浏览器缓存.html#last-modified-if-modified-since" class="sidebar-link">Last-Modified/if-Modified-Since</a></li><li class="sidebar-sub-header"><a href="/lanjz/network/浏览器缓存.html#协商缓存例子-last-modified" class="sidebar-link">协商缓存例子（Last-Modified）</a></li><li class="sidebar-sub-header"><a href="/lanjz/network/浏览器缓存.html#etag-if-none-match" class="sidebar-link">ETag/If-None-Match</a></li><li class="sidebar-sub-header"><a href="/lanjz/network/浏览器缓存.html#协商缓存例子-etag" class="sidebar-link">协商缓存例子（Etag）</a></li></ul></li><li class="sidebar-sub-header"><a href="/lanjz/network/浏览器缓存.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/lanjz/network/跨域.html" class="sidebar-link">跨域</a></li><li><a href="/lanjz/network/CDN.html" class="sidebar-link">CDN</a></li><li><a href="/lanjz/network/Cookie.html" class="sidebar-link">Cookie</a></li><li><a href="/lanjz/network/DNS.html" class="sidebar-link">DNS</a></li><li><a href="/lanjz/network/TCP.html" class="sidebar-link">TCP</a></li><li><a href="/lanjz/network/keep-alive.html" class="sidebar-link">keep-alive</a></li><li><a href="/lanjz/network/WebSocket.html" class="sidebar-link">WebSocket</a></li><li><a href="/lanjz/network/网络层的优化.html" class="sidebar-link">前端优化之 Http 相关优化总结</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="浏览器缓存"><a href="#浏览器缓存" class="header-anchor">#</a> 浏览器缓存</h1> <p>浏览器缓存是一种常见的web性能优化手段，</p> <p>HTTP控制缓存的方式有两种：<code>Cache-Control</code>和<code>Expires</code></p> <ul><li><p>Cache-Control</p> <p><code>Cache-Control</code>有以下几个值：</p> <ul><li><p><code>no-store</code>：禁止进行缓存</p></li> <li><p><code>no-cache</code>：(强制确认缓存)服务器端会验证请求中所描述的缓存是否过期，若未过期（注：实际就是返回304），则缓存才使用本地缓存副本。</p></li> <li><p><code>private</code>：<code>Cache-Control</code>默认值，响应只会被某个用户缓存，中间人（CDN、代理等）不缓存</p></li> <li><p><code>publish</code>：响应除了被某个用户缓存，还可以被中间人（CDN、代理等）缓存</p></li> <li><p><code>max-age={seconds}</code>：表示资源能够被缓存的最大时间。相对<code>Expires</code>给的是具体的绝对时间，<code>max-age</code>是距离发起时间的秒数。</p></li> <li><p><code>must-revalidate</code>：当使用了 <code>must-revalidate</code> 指令，那就意味着缓存在考虑使用一个陈旧的资源时，必须先验证它的状态，已过期的缓存将不被使用。</p></li></ul></li> <li><p>Expires</p> <p><code>expires</code>设置是一个具体的绝对时间,在这个绝对时间内都只使用缓存的数据</p></li></ul> <h2 id="缓存存储策略"><a href="#缓存存储策略" class="header-anchor">#</a> 缓存存储策略</h2> <p>说白了就是如何缓存，从上文的对<code>Cache-Control</code>的介绍中可以知道除了<code>no-store</code>表示不缓存响应内容，其它的属性<code>no-cache</code>、<code>max-age</code>、<code>Publish</code>、<code>Private</code>、<code>must-revalidate</code>，
都是指明对响应内容会做缓存</p> <p>那么问题来了，服务器上的资源是会更新的，客户端如果一直使用缓存的资源，那么就不即时更新服务端上的新资源了，所以客户端什么时候用缓存的资源，什么时候拉取新的资源。这就是下面要讲的缓存更新策略。</p> <p>缓存更新策略主要两大类：强缓存和协商缓存</p> <h2 id="强缓存"><a href="#强缓存" class="header-anchor">#</a> 强缓存</h2> <p>就是给资源指定一个过期时间，超过这个时间就重新获取资源，要不然就从缓存中获取。从上文中可以知道<code>Headers</code>中的<code>expires</code>字段和<code>Cache-Control</code>中的<code>max-age</code>，都可以用来设置这个过期时间。他们区别如下：</p> <ol><li><p><code>expires</code>设置是一个具体的绝对时间，<code>Cache-Control</code>中的<code>max-age</code>设置是一个从请求发起时间开始算的相对秒数，如当值为<code>max-age=300</code>时，300秒内都能缓存中获取资源</p></li> <li><p>当它们同时存在时，使用<code>Cache-Control</code>中的<code>max-age</code></p></li> <li><p><code>Expiress</code>是http1.0的产物，<code>Cache-Control</code>是http1.1的产物</p></li> <li><p>如果有浏览器不支持<code>Cache-Control</code>，则会使用<code>Expiress</code></p></li></ol> <h3 id="强缓存例子"><a href="#强缓存例子" class="header-anchor">#</a> 强缓存例子</h3> <p>例子使用<code>Node+koa</code>构建服务,<code>ehs</code>渲染页面</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// app.js</span>
<span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> views <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-views'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> router  <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./router/index'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> resource <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-static'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">views</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./view'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  extension<span class="token operator">:</span> <span class="token string">'ejs'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 使用一个中间件设置缓存</span>
  <span class="token comment">// 设置响应头Cache-Control 设置资源有效期为300秒</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'Cache-Control'</span><span class="token operator">:</span> <span class="token string">'max-age=300'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">resource</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./img'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Example app listening on port 3000!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// view/index.ejs</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">%=</span> title <span class="token operator">%</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">%=</span> title <span class="token operator">%</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">&quot;./下载2.jpeg&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p id<span class="token operator">=</span><span class="token string">&quot;test&quot;</span><span class="token operator">&gt;</span>点击获取数据<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fetch'</span><span class="token punctuation">,</span> fetch<span class="token punctuation">)</span>
        <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/data'</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'re'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'e'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// router/index.js</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-router'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token string">'koa-demo'</span>
<span class="token punctuation">}</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pah'</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> title <span class="token operator">=</span> <span class="token string">'hello koa22'</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router
</code></pre></div><p>运行之后会发现首次加载的图片或者点击获取数据，返回的<code>Status Code</code>都是<code>200 OK</code></p> <p>然后重新刷新页面，图片的返回code变成了<code>200 OK (from memory cache)</code>,点击获取数据<code>Status Code</code>也变成了<code>200 OK (from disk cache)</code></p> <p>修改缓存方式使用<code>expires</code>试下</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Expires'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUTCString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>运行时，会发布图片没有效果，我们查看一下图片请求的返回头，可以发现在<code>response header</code>除了有我们设置的<code>Expires</code>属性还有
<code>Cache-Control：max-age=0</code>属性，<code>Cache-Control</code>属性优先级大于<code>Expires</code>，所以才导致图片缓存没有效果</p> <p>至于为什么图片的返回头部默认会带有<code>Cache-Control</code>和<code>Last-Modified</code>等属性，我们这里先不深究</p> <p>继续回到例子，我们点击获取数据按钮，效果跟使用<code>Cache-Control</code>的例子是一样的</p> <blockquote><p>如果<code>max-age</code>和<code>expires</code>属性都没有，找找头里的<code>Last-Modified</code>信息。如果有，缓存的寿命就等于头里面<code>Date</code>的值减去<code>Last-Modified</code>的值除以10（注：根据rfc2626其实也就是乘以10%）</p></blockquote> <blockquote><p>缓存失效时间计算公式如下：</p></blockquote> <blockquote><p><code>expirationTime = responseTime + freshnessLifetime - currentAge</code></p></blockquote> <h3 id="from-memory-cache和from-disk-cache"><a href="#from-memory-cache和from-disk-cache" class="header-anchor">#</a> <code>from memory cache</code>和<code>from disk cache</code></h3> <ul><li><p>from memory cache</p> <p>MemoryCache顾名思义，就是将资源缓存到内存中，等待下次访问时不需要重新下载资源，而直接从内存中获取。Webkit早已支持memoryCache。</p> <p>目前Webkit资源分成两类，一类是主资源，比如HTML页面，或者下载项，一类是派生资源，比如HTML页面中内嵌的图片或者脚本链接，分别对应代码中两个类：MainResourceLoader和SubresourceLoader。虽然Webkit支持memoryCache，但是也只是针对派生资源，它对应的类为CachedResource，用于保存原始数据（比如CSS，JS等），以及解码过的图片数据。</p></li> <li><p>from dist cache</p> <p>DiskCache顾名思义，就是将资源缓存到磁盘中，等待下次访问时不需要重新下载资源，而直接从磁盘中获取，它的直接操作对象为CurlCacheManager。</p></li></ul> <table><thead><tr><th>-</th> <th style="text-align:center;">from memory cache</th> <th style="text-align:right;">from dist cache</th></tr></thead> <tbody><tr><td>相同点</td> <td style="text-align:center;">只能存储一些派生类资源文件</td> <td style="text-align:right;">只能存储一些派生类资源文件</td></tr> <tr><td>不同点</td> <td style="text-align:center;">退出进程时数据会被清除</td> <td style="text-align:right;">退出进程时数据不会被清除</td></tr> <tr><td>存储资源</td> <td style="text-align:center;">一般脚本、字体、图片、CSS会存在内存当中</td> <td style="text-align:right;">一般非脚本会存在内存当中，如json数据等</td></tr></tbody></table> <p>但使用强缓存的方式不够灵活，因为就算缓存时间到了，资源也不一定是更新了的，而且资源也可以是在缓存时间内更新的，这样就不能即使更新资源了，此时就要使用协商缓存</p> <h2 id="协商缓存"><a href="#协商缓存" class="header-anchor">#</a> 协商缓存</h2> <p>协商缓存就是，请示资源时，先由服务器去确认资源是否有更新，确认了更新了才返回数据，否则就返回<code>304</code>告诉浏览器从取缓存中的资源</p> <p>那么服务器怎么知道资源是否更新了呢？配合Headers中的两个字段<code>Last-Modified</code> 和 <code>if-modified-since</code>或者<code>ETag</code>字段。</p> <h3 id="last-modified-if-modified-since"><a href="#last-modified-if-modified-since" class="header-anchor">#</a> Last-Modified/if-Modified-Since</h3> <p>协商缓存的思路如下：</p> <ul><li>第一次请求时，服务器返回资源时，会传递一个<code>Last-Modified</code>字段，其内容是这个资源的修改时间。之后再次请求这个资源时，会自带一个<code>if-Modified-Since</code>字段，它的值是上一次传递过来的<code>Lost-Modified</code>的值，服务器将与这个值与现在的文件的最后修改时间做对比，如果相等，就不用重新拉取这个资源，返回304告诉浏览器读缓存里的资源，否则就重新拉取</li></ul> <p><img src="https://lc-gold-cdn.xitu.io/464786ff92e750ee776c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt=""></p> <h3 id="协商缓存例子-last-modified"><a href="#协商缓存例子-last-modified" class="header-anchor">#</a> 协商缓存例子（Last-Modified）</h3> <p>node实现可缓存的服务</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> pathname <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>pathname
    <span class="token keyword">var</span> fsPath <span class="token operator">=</span> __dirname <span class="token operator">+</span> pathname
    fs<span class="token punctuation">.</span><span class="token function">access</span><span class="token punctuation">(</span>fsPath<span class="token punctuation">,</span> fs<span class="token punctuation">.</span>constants<span class="token punctuation">.</span><span class="token constant">R_OK</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//fs.constants.R_OK - path 文件可被调用进程读取</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token comment">//可返回404，在此简略代码不再演示</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> file <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span>fsPath<span class="token punctuation">)</span> <span class="token comment">//文件信息</span>
          <span class="token keyword">var</span> lastModified <span class="token operator">=</span> file<span class="token punctuation">.</span>mtime<span class="token punctuation">.</span><span class="token function">toUTCString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token keyword">var</span> ifModifiedSince <span class="token operator">=</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'if-modified-since'</span><span class="token punctuation">]</span>
          <span class="token comment">//传回Last-Modified后，再请求服务器会携带if-modified-since值来和服务器中的Last-Modified比较</span>
          <span class="token keyword">var</span> maxAgeTime <span class="token operator">=</span> <span class="token number">3</span> <span class="token comment">//设置超时时间</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>ifModifiedSince <span class="token operator">&amp;&amp;</span> lastModified <span class="token operator">==</span> ifModifiedSince<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//客户端修改时间和服务端修改时间对比</span>
              res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">304</span><span class="token punctuation">,</span><span class="token string">&quot;Not Modified&quot;</span><span class="token punctuation">)</span>
              res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>fsPath<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>file</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'readFileError:'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
                        <span class="token string">&quot;Cache-Control&quot;</span><span class="token operator">:</span> <span class="token string">'max-age='</span> <span class="token operator">+</span> maxAgeTime<span class="token punctuation">,</span>
                        <span class="token string">&quot;Last-Modified&quot;</span> <span class="token operator">:</span> lastModified
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3030</span><span class="token punctuation">)</span>
</code></pre></div><p><code>Last-Modifily</code>和<code>if-Modified-Since</code>是根据最后修改时间来判断是否需要重新拉取数据，还有一个使用<code>Etag</code>的方式，根据内容是否变化来判断是否需要重新资源</p> <h3 id="etag-if-none-match"><a href="#etag-if-none-match" class="header-anchor">#</a> ETag/If-None-Match</h3> <p>ETag一般是由文件内容<code>hash</code>生成的，也就是说它可以保证资源的唯一性，资源内容改变了那么<code>hash</code>也会改变</p> <p>有<code>If-None-Match</code>字段将这个ETag带回服务器中，服务器跟这个ETag与当前资源的<code>hash</code>进行比较。来判断是否需要重新返回该资源</p> <h3 id="协商缓存例子-etag"><a href="#协商缓存例子-etag" class="header-anchor">#</a> 协商缓存例子（Etag）</h3> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> hash <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ifNoneMatch <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;If-None-Match&quot;</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ifNoneMatch'</span><span class="token punctuation">,</span> ifNoneMatch<span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>ifNoneMatch <span class="token operator">&amp;&amp;</span> ifNoneMatch <span class="token operator">===</span> hash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">304</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Etag'</span><span class="token punctuation">,</span> hash<span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Cache-Contrl'</span><span class="token punctuation">,</span> <span class="token string">'no-store'</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>第一次点击获取数据是返回的<code>status code</code>是<code>200 OK</code>， 再次点击返回的是<code>304 Not Modified</code></p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>当浏览器访问一个已经访问过的资源时，它会这样做</p> <ol><li><p>看看是否命中强缓存，如果命中，它直接使用缓存</p></li> <li><p>如果没有命中强缓存，就发请求到服务器是否命中协商缓存</p></li> <li><p>如果协商缓存命中，则返回304，告诉浏览器使用本地缓存，否则返回最新资源</p></li></ol> <blockquote><p><a href="https://segmentfault.com/a/1190000017962411" target="_blank" rel="noopener noreferrer">实践这一次，彻底搞懂浏览器缓存机制<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <blockquote><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching_FAQ" target="_blank" rel="noopener noreferrer">MDN-HTTP缓存<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/lanjz/network/HTTPS.html" class="prev">
        HTTPS
      </a></span> <span class="next"><a href="/lanjz/network/跨域.html">
        跨域
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/lanjz/assets/js/app.813b5437.js" defer></script><script src="/lanjz/assets/js/2.82bd5d43.js" defer></script><script src="/lanjz/assets/js/181.4022ee34.js" defer></script>
  </body>
</html>
