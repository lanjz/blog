(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{413:function(t,s,a){t.exports=a.p+"assets/img/browser_13.5ce45ba0.png"},437:function(t,s,a){t.exports=a.p+"assets/img/browser_14.0c389301.png"},482:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmgAAAEZCAMAAAAUpymCAAAC9FBMVEVMaXEAAAAAAAAAAABAQECAgID///+/v7+6urrn5+epqanBwcGDg4OFhYWioqL19fXGxsbs7Oz6+vri4uKurq6goKDU1NTb29vu7u74+Pi4uLjLy8vx8fHl5eXz8/OwsLBra2ubm5tmZmbS0tKsrKx3d3dwcHC8vLyzs7OWlpZ0dHSnp6eIiIiUlJRoaGiRkZGKioqYmJjExMRycnLp6enIyMiPj4/X19dtbW2kpKSMjIx+fn79/f3Z2dl5eXnQ0NB8fHydnZ3d3d3Nzc21tbXg4ODsz8/KfHzWmprapKTNhITw29unJSWYAADMgICsMTEgAACMPj6yQUHmwcGfAAB5AADLf3+NOjqQKCibBga/YGDFcHCiFxf36+vRjIz89/f9+/vcqKjhtLS4UFDPiIg0OT1ocXrP4vO9zdvD1OPM3u7I2urO4PHC0+LH2Oe2xdLA0N6cpq+vvMi4xtR3en3K3O2xv8tzdXe0ws+Pl52DiY5vcXO6ydZ7f4KeqbKnsr2AhYmTm6KotL5/g4eGjJFydHahrLWOlZuMk5mIjpSIlaCtucWjr7lqamptbm+ptcCbpKyUnKR1eHqWn6hAPTOAeWa7ytiKkZd9goX/8sz77snb0bTz58Tg1rfu4sHZz7PEvKWEgnqhnI2cmIq7tJ6WkoZ5d3OQjYLVzLB9e3Vwb23BuaP98MvSya53dnHx5cOkn4+4sZ2MiX+xq5jGvqa/t6H26sZzcm/i17nq373d07Xm27zJwKenoZGUkIWtp5b47MeAfnfLwqns4b+Jhn21rpvNxKupo5OYlIe/tZnPxKbv47/XzKzf1LLn27lgW02gmICIgW1IRDpybFvHvZ9oY1NMSD3z58KclH2EfWqMhXC4r5OQiXOwp41XU0WWjnhEQTbb0K8cGxYEBANcV0oXFhIICAYkIh3j17Z5c2G8spaon4YgHhoMCwo8OTA2MysQDw0uLCTDuZxsZlbTyKlQTEBkX1AoJiC0q5Cso4p7h5EAAADyqG2AAAAA/HRSTlMAV3////////////////////////////////////////////////////////////////////////////////////////////////////////////8I0////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2dULVUsAAAON0lEQVR4AezStwHCQBAAsI9Hhv23peQ7kq+yNIMKOwYAALVBkro862ngNa31MSHF6G2JNgNSTNEQDdHYimggGqKBaIiGaByO8ZVT8EM05jm+cbkG+dG43YOPo/F4smtX+8ljUQDFr1g4EQiQNoSw0SLBKYQQqI27u7//M0wJ4+7ycf441+u3I+foWvxuGLoJxZKVNKFcAVOvHP+vVnX7onAJ4KSsUg0olt1SXfcaZZTfGpriShNotc1UB7peo5fIm1w1QBcLUn2z28kPGnIBlc6wN/KbUBgnJpOxTGf8Zio0ZZ6ChbfkasW1XIK2nrEJYNseY/a7NPwKbOZobSuE6RZy6x0kvRBFhfbbBRtoDKFdZzyJ/xjQi9h3WgHJvsnhBtDF6Xpa/AVbSsBNnt9BhaYMhtzKLa7sTV9iJXSPIDM7hIcemjSBrJijFfEXKpL+3deoKjQlOWdyA3upGpIyjjSu5dav6tFdR6MpBnCzJbA4fUn1AVuW/A4qNGUnl14V6m1M7wLIDKEmK4tdNOzBvVSg6nUZr4C0d8/0CriWGooK7Xdwpd8Dxldgza/TJX9//M8vsvM6Goz6k+LDMGeylKx9vX38crgAulI2UFRov0MiZwK5JNiWJ4kywKEB1egCmNfrnt/QgG5b1hkbLdoBtbY0+auo0JSq6kmF9k+4E5c/QYX21NPPoPy6Vpufpzz73PM/G1pc2QsvvvgSf5KivPTiiy/Hrf1EaHFlj1RofwEV2qO4tR+E9sqrx8pir730BHid/6+XngCvvRiLW/tOaG+8+eIT5i3+v158wrz9vYn2zrtnOtHSlsOvcKw0P5K94Nc9WBqx5gYwoGKZ5zXR3n3vqR+coz3//ruPf5/fOdpv2NazF5cfyQ34dfdzTm4mMKpDKzqXc7TYB09/+BNXnR9+9MFPXAwof0Ud28zpFm8wPaPQXnjm45+5vfHJpy+fTWh20sqUgbsiZf2o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"},636:function(t,s,a){"use strict";a.r(s);var n=a(58),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"html渲染过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#html渲染过程"}},[t._v("#")]),t._v(" HTML渲染过程")]),t._v(" "),n("h2",{attrs:{id:"html解析过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#html解析过程"}},[t._v("#")]),t._v(" HTML解析过程")]),t._v(" "),n("p",[t._v("解析 HTML 的过程实质就是根据文档结构转换成可以表示文档结构的语法树的过程")]),t._v(" "),n("p",[n("img",{attrs:{src:a(413),alt:""}})]),t._v(" "),n("p",[n("strong",[t._v("解析HTML文档的过程")])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("浏览器采用流式布局模型（Flow Based Layou）")])]),t._v(" "),n("li",[n("p",[t._v("解析HTML，生成 DOM 树；解析 CSS 生成 CSSOM 树")])]),t._v(" "),n("li",[n("p",[t._v("将 DOM 树和 CSSOM 树结合生成渲染树（Render Tree）")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("Layout(回流)")]),t._v("：根据生成的渲染树，进行回流（Layout），得到的几何信息（位置、大小）")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("Painting(重绘)")]),t._v("：根据渲染树及回流得到的几何信息，得到节点绝对像素")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("Display")]),t._v("：将像素发送给GPU，展示在页面上")])])]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[n("code",[t._v("布局")]),t._v("，"),n("code",[t._v("重排")]),t._v(", "),n("code",[t._v("回流")]),t._v("是一个意思，只是不同浏览器的内核术语不同")])]),t._v(" "),n("h2",{attrs:{id:"渲染过程各环节进行分解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#渲染过程各环节进行分解"}},[t._v("#")]),t._v(" 渲染过程各环节进行分解")]),t._v(" "),n("h3",{attrs:{id:"生成渲染树"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生成渲染树"}},[t._v("#")]),t._v(" 生成渲染树")]),t._v(" "),n("p",[t._v("图解：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(437),alt:""}})]),t._v(" "),n("p",[t._v("为构建渲染树，浏览器主要完成了以下工作：")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("从DOM树的根节点开始遍历每个节点")])]),t._v(" "),n("li",[n("p",[t._v("对于每个见的节点，从CSSOM树中找到对应的样式规则，并应用它们")])]),t._v(" "),n("li",[n("p",[t._v("根据可见节点和对应的样式，组合生成渲染树")])])]),t._v(" "),n("p",[t._v("第一步中提到了可见节点，那么我就得知道怎么区别可见和不可见节点。比如不可见的节点包含")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("一些不会渲染输出的节点，比如"),n("code",[t._v("script")]),t._v("、"),n("code",[t._v("link")]),t._v("等")])]),t._v(" "),n("li",[n("p",[t._v("通过CSS隐藏的节点。比如"),n("code",[t._v("display:none")]),t._v("。注意，利用"),n("code",[t._v("visibility")]),t._v("和"),n("code",[t._v("opecity")]),t._v("隐藏的节点，还是会显示在渲染树上。只有"),n("code",[t._v("display:none")]),t._v("的节点才不会显示在渲染树上。")])])]),t._v(" "),n("p",[t._v("从上面的例子来讲，我们可以看到 "),n("code",[t._v("span")]),t._v(" 标签的样式有一个 "),n("code",[t._v("display:none")]),t._v("，因此，它最终并没有在渲染树上。")]),t._v(" "),n("p",[n("strong",[t._v("注意：渲染树只包含可见的节点")])]),t._v(" "),n("h3",{attrs:{id:"回流"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#回流"}},[t._v("#")]),t._v(" 回流")]),t._v(" "),n("p",[t._v("上文提到通过DOM节点和样式规则生成渲染树，可是我们还需要计算他们在视图（viewport）内的确切位置和大小，这个计算的阶段就是回流。")]),t._v(" "),n("p",[t._v("为了弄清楚每个对象在页面中的确切大不和位置，浏览器从渲染树的根节点开始遍历。看例子：")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token doctype"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),n("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("viewport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("width=device-width,initial-scale=1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Critial Path: Hello world!"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token special-attr"}},[n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),n("span",{pre:!0,attrs:{class:"token value css language-css"}},[n("span",{pre:!0,attrs:{class:"token property"}},[t._v("width")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 50%")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token special-attr"}},[n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),n("span",{pre:!0,attrs:{class:"token value css language-css"}},[n("span",{pre:!0,attrs:{class:"token property"}},[t._v("width")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 50%")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Hello world!"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("p",[t._v("我们可以看到，第一个 "),n("code",[t._v("div")]),t._v(" 将节点的显示尺寸设置为视口宽度的50%，第二个 "),n("code",[t._v("div")]),t._v(" 将其尺寸设置为父节点的50%。而在回流这个阶段，我们就需要根据视口具体的宽度，将其转为实际的像素值。（如下图）")]),t._v(" "),n("p",[n("img",{attrs:{src:a(482),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"重绘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重绘"}},[t._v("#")]),t._v(" 重绘")]),t._v(" "),n("p",[t._v("我们通过渲染树和回流阶段，知道了哪些节点是可见的，并且知道了节点的样式、大小、位置信息等，那么我就可以将渲染树的各个节点都转换屏幕上的实际像素，这个阶段就是做重绘节点")]),t._v(" "),n("p",[t._v("既然知道了浏览器的渲染过程后，我们就来探讨下，何时会发生回流重绘。")]),t._v(" "),n("h3",{attrs:{id:"何时发生回流重绘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#何时发生回流重绘"}},[t._v("#")]),t._v(" 何时发生回流重绘")]),t._v(" "),n("p",[t._v("从前面我们知道回流是计算节点的大小、位置等几何信息，那么当节点的布局几何信息发生变化的时候，就需要回流。比如以下情况")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("添加或删除可见DOM节点")])]),t._v(" "),n("li",[n("p",[t._v("节点尺寸发生了变化包括外边距、内边框、边框大小、高度和宽度等）")])]),t._v(" "),n("li",[n("p",[t._v("节点位置发生了变化")])]),t._v(" "),n("li",[n("p",[t._v("节点内容发生了变化，比如文本变化或图片被另一个不同尺寸的图片所替代。")])]),t._v(" "),n("li",[n("p",[t._v("页面一开始加载的时候")])]),t._v(" "),n("li",[n("p",[t._v("浏览器窗口大小改变的时候（因为回流的根据视图大小来计算元素的位置和大小等几何信息的）")])])]),t._v(" "),n("h2",{attrs:{id:"浏览器的优化机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的优化机制"}},[t._v("#")]),t._v(" 浏览器的优化机制")]),t._v(" "),n("p",[t._v("由于每次回流重绘都会造成额外的计算消耗，因此现代浏览器通过队列化修改并批量执行来优化重排过程。浏览器会将修改的操作放入到队列中，直到过一段时间或者到了一定的阈值，才清空队列。但是 "),n("strong",[t._v("当你获取布局信息的操作时候，会强制队列刷新")]),t._v(" ，比如当你访问以下属性或者使用以下方法：")]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("offsetTop")]),t._v("、"),n("code",[t._v("offsetLeft")]),t._v("、"),n("code",[t._v("offsetWidth")]),t._v("、"),n("code",[t._v("offsetHeight")])])]),t._v(" "),n("li",[n("p",[n("code",[t._v("scrollTop")]),t._v("、"),n("code",[t._v("scrollLeft")]),t._v("、"),n("code",[t._v("scrollWidth")]),t._v("、"),n("code",[t._v("scrollHeight")])])]),t._v(" "),n("li",[n("p",[n("code",[t._v("clientTop")]),t._v("、"),n("code",[t._v("clientLeft")]),t._v("、"),n("code",[t._v("clientWidth")]),t._v("、"),n("code",[t._v("clientHeight")])])]),t._v(" "),n("li",[n("p",[n("code",[t._v("getComputedStyle()")])])]),t._v(" "),n("li",[n("p",[n("code",[t._v("getBoundingClientRect")])])]),t._v(" "),n("li",[n("p",[t._v("具体可以访问这个网站："),n("a",{attrs:{href:"https://gist.github.com/paulirish/5d52fb081b3570c81e3a",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gist.github.com/paulirish/5d52fb081b3570c81e3a"),n("OutboundLink")],1)])])]),t._v(" "),n("p",[t._v("以上属性和方法都需要返回最新的布局信息，因此浏览器不得不清空队列，触发回流重绘来返回正确的值。因此，我们在修改样式的时候，"),n("strong",[t._v("最好避免频繁使用上面列出的属性，他们都会刷新渲染队列。")]),t._v(" 如果要使用它们，最好将值缓存起来")]),t._v(" "),n("h3",{attrs:{id:"减少回流和重绘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#减少回流和重绘"}},[t._v("#")]),t._v(" 减少回流和重绘")]),t._v(" "),n("p",[t._v("既然我们大概了解了回流和重绘的理论知识，也知道回流和重绘对浏览器渲染性能的影响，那接下就总结一下如何减少回流和重绘")]),t._v(" "),n("p",[n("strong",[t._v("最小化回流和重绘")])]),t._v(" "),n("p",[t._v("由于回流和重绘可能造成比较昂贵的代价，因此最好减少它的发生次数。为了减少发生次数，我们可以合并多次对 DOM 和样式的修改，然后一次处理掉。考虑这个例子")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" el "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("padding "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'5px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("borderLeft "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("borderRight "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("例子中，有三个样式属性被修改了，每一个都会影响元素的几何结构，引起回流。当然，大部分现代浏览器都对其做了优化，因此，只会触发一次重排。但是如果在旧版的浏览器或者在上面代码执行的时候，有其他代码访问了布局信息(上文中的会触发回流的布局信息)，那么就会导致三次重排。")]),t._v(" "),n("p",[t._v("因此，我们可以合并所有的改变然后依次处理，比如我们可以采取以下的方式")]),t._v(" "),n("ol",[n("li",[t._v("使用 "),n("code",[t._v("cssText")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" el "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cssText "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'border-left: 1px; border-right: 2px; padding: 5px;'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("修改 CSS 的 "),n("code",[t._v("class")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" el "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("className "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' active'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[n("strong",[t._v("批量修改 DOM")])]),t._v(" "),n("p",[t._v("当我们需要对 DOM 对一系列修改的时候，可以通过以下涌出减少回流重绘次数：")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("使元素脱离文档流")])]),t._v(" "),n("li",[n("p",[t._v("对其进行多次修改")])]),t._v(" "),n("li",[n("p",[t._v("将元素带回到文档中")])])]),t._v(" "),n("p",[t._v("该过程的第一步和第三步可能会引起回流，但是经过第一步，对 DOM 的所有修改都不会引起回流重绘，因为它已经不在渲染树了")]),t._v(" "),n("p",[t._v("有三种方式可以让 DOM 脱离文档流：")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("隐藏元素，应用修改，重新显示")])]),t._v(" "),n("li",[n("p",[t._v("使用文档片段（document fragment）在当前DOM之外构建一个子树，再把它拷贝因文档")])]),t._v(" "),n("li",[n("p",[t._v("将原始元素拷贝到一个脱离文档的节点中，修改节点后，再替换原始的元素")])])]),t._v(" "),n("p",[t._v("考虑我们要执行一段批量插入节点的代码：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendDataToElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("appendToElement"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" li"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \tli "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        li"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        appendToElement"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("li"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ul "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'list'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendDataToElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ul"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("如果我们直接这样执行的话，由于每次循环都会插入一个新的节点，会导致浏览器回流一次。")]),t._v(" "),n("p",[t._v("我们可以使用这三中方式进行优化：")]),t._v(" "),n("ol",[n("li",[t._v("隐藏元素、应用修改、重新显示")])]),t._v(" "),n("p",[t._v("这个会在节点隐藏和显示的时候，产生两次回流")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendDataToElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("appendToElement"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" li"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \tli "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        li"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        appendToElement"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("li"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ul "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'list'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nul"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("display "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendDataToElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ul"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nul"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("display "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'block'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("使用文档片段(document fragment)在当前 DOM 之外构建一个子树，再把它拷贝回文档")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ul "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'list'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fragment "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createDocumentFragment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendDataToElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fragment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nul"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fragment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[t._v("将原始元素拷贝到一个脱离文档的节点中，修改节点后，再替换原始的元素。")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ul "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'list'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" clone "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ul"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cloneNode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendDataToElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("clone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nul"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parentNode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replaceChild")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("clone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ul"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[n("strong",[t._v("避免触发同步布局事件")])]),t._v(" "),n("p",[t._v("上文我们说过，当我们访问元素的一些属性的时候，会导致浏览器强制清空队列，进行强制同步布局。举个例子，比如说我们想将一个 "),n("code",[t._v("p")]),t._v(" 标签数组的宽度赋值为一个元素的宽度，我们可能写出这样的代码：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initP")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" paragraphs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        paragraphs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" box"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetWidth "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("这段代码看上去是没有什么问题，可是其实会造成很大的性能问题。在每次循环的时候，都读取了 "),n("code",[t._v("box")]),t._v(" 的一个 "),n("code",[t._v("offsetWidth")]),t._v(" 属性值，然后利用它来更新 "),n("code",[t._v("p")]),t._v(" 标签的 "),n("code",[t._v("width")]),t._v(" 属性。这就导致了每一次循环的时候，浏览器都必须先使上一次循环中的样式更新操作生效，才能响应本次循环的样式读取操作。每一次循环都会强制浏览器刷新队列。我们可以优化为:")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" width "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" box"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetWidth"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initP")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" paragraphs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        paragraphs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" width "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[n("strong",[t._v("对于复杂动画效果，使用定位让其脱离文档流")])]),t._v(" "),n("p",[t._v("对于复杂动画效果，由于会经常的引起回流重绘，因此，我们可以使用绝对定位，让它脱离文档流。否则会引起父元素以及后续元素频繁的回流。")]),t._v(" "),n("p",[n("strong",[t._v("css3硬件加速（GPU加速）")])]),t._v(" "),n("p",[t._v("比起考虑如何减少回流重绘，我们更期望的是，根本不要回流重绘。这个时候，css3硬件加速就闪亮登场啦！！")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("使用 css3 硬件加速，可以让 "),n("code",[t._v("transform")]),t._v("、"),n("code",[t._v("opacity")]),t._v("、"),n("code",[t._v("filters")]),t._v(" 这些动画不会引起回流重绘")])]),t._v(" "),n("li",[n("p",[t._v("对于动画的其它属性，比如 "),n("code",[t._v("background-color")]),t._v(" 这些，还是会引起回流重绘的，不过它还是可以提升这些动画的性能")])])]),t._v(" "),n("p",[t._v("css3硬件加速的坑:")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("如果你为太多元素使用 css3 硬件加速，会导致内存占用较大，会有性能问题")])]),t._v(" "),n("li",[n("p",[t._v("在GPU渲染字体会导致抗锯齿无效。这是因为 GPU 和 CPU 的算法不同。因此如果你不在动画结束的时候关闭硬件加速，会产生字体模糊。（后面会说如果避免这个问题）")])])]),t._v(" "),n("p",[n("strong",[t._v("避免使用 CSS 表达式，可能会引发回流")])]),t._v(" "),n("p",[n("strong",[t._v("避免使用 table 布局，可能很小的一个小改动会造成整个 table 的重新布局")])]),t._v(" "),n("p",[t._v("删除冗余的样式，提高构建呈现树阶段的样式匹配速度")]),t._v(" "),n("h2",{attrs:{id:"q-a"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#q-a"}},[t._v("#")]),t._v(" Q&A")]),t._v(" "),n("h3",{attrs:{id:"关于使用css3硬件加速-导致字体模糊"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关于使用css3硬件加速-导致字体模糊"}},[t._v("#")]),t._v(" 关于使用CSS3硬件加速，导致字体模糊")]),t._v(" "),n("p",[t._v("总结来说就是使用 "),n("code",[t._v("transform")]),t._v(" 时，"),n("code",[t._v("translate")]),t._v("、"),n("code",[t._v("scale")]),t._v("、"),n("code",[t._v("rotate")]),t._v(" 属性的值应该尽量为整数，如果是非整数的话会导致字体模糊")]),t._v(" "),n("h3",{attrs:{id:"说一下从-url-输入到返回请求的过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#说一下从-url-输入到返回请求的过程"}},[t._v("#")]),t._v(" 说一下从 url 输入到返回请求的过程")]),t._v(" "),n("ol",[n("li",[n("p",[n("code",[t._v("url")]),t._v(" 解析，根据 "),n("code",[t._v("dns")]),t._v(" 系统进行 "),n("code",[t._v("ip")]),t._v(" 查找")])]),t._v(" "),n("li",[n("p",[t._v("查找到IP之后，就是http协议的三次握手")])]),t._v(" "),n("li",[n("p",[t._v("返回 HTML，可能存在缓存")])]),t._v(" "),n("li",[n("p",[t._v("HTML 内容的解析 和 脚本执行")])])]),t._v(" "),n("h3",{attrs:{id:"dom树节点和渲染树节点一一对应吗"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dom树节点和渲染树节点一一对应吗"}},[t._v("#")]),t._v(" dom树节点和渲染树节点一一对应吗")]),t._v(" "),n("p",[n("img",{attrs:{src:a(437),alt:""}})]),t._v(" "),n("p",[t._v("根据之前上图的渲染图未所以发现 dom 树节点和渲染树节点并不是一一对应的，比如 "),n("code",[t._v("display:node")]),t._v(" 的元素将不会出现在渲染树中")]),t._v(" "),n("h3",{attrs:{id:"css-如何阻塞文档解析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#css-如何阻塞文档解析"}},[t._v("#")]),t._v(" CSS 如何阻塞文档解析？")]),t._v(" "),n("p",[t._v("理论上，既然样式表不改变 DOM 树，也就没有必要停下文档的解析等待它们。然而，存在一个问题，JavaScript 脚本执行时可能在文档的解析过程中请求样式信息，如果样式还没有加载和解析，脚本将得到错误的值，显然这将会导致很多问题。所以如果浏览器尚未完成 CSSOM 的下载和构建，而我们却想在此时运行脚本，那么浏览器将延迟 JavaScript 脚本执行和文档的解析，直至其完成 CSSOM 的下载和构建。也就是说，在这种情况下，浏览器会先下载和构建 CSSOM，然后再执行 JavaScript，最后再继续文档的解析。")]),t._v(" "),n("h3",{attrs:{id:"css加载会阻塞-dom-解析吗"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#css加载会阻塞-dom-解析吗"}},[t._v("#")]),t._v(" CSS加载会阻塞 DOM 解析吗")]),t._v(" "),n("p",[t._v("在 DOM 解析这个阶段不依赖 CSS 的，所以 CSS 加载不会阻塞dom解析")]),t._v(" "),n("h3",{attrs:{id:"css加载会阻塞-dom-渲染吗"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#css加载会阻塞-dom-渲染吗"}},[t._v("#")]),t._v(" CSS加载会阻塞 DOM 渲染吗")]),t._v(" "),n("p",[t._v("DOM 渲染需要 "),n("code",[t._v("css tree + dom tree = render tree")]),t._v(" 所以 CSS 加载会阻塞 DOM 树渲染")]),t._v(" "),n("h3",{attrs:{id:"css加载会阻塞后面js语句的执行嘛"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#css加载会阻塞后面js语句的执行嘛"}},[t._v("#")]),t._v(" css加载会阻塞后面js语句的执行嘛")]),t._v(" "),n("p",[t._v("因为 JS 可能需要访问 DOM 样式，所以 CSS 加载会阻塞后面 JS 语句的执行")]),t._v(" "),n("h3",{attrs:{id:"什么情况会阻塞渲染"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么情况会阻塞渲染"}},[t._v("#")]),t._v(" 什么情况会阻塞渲染？")]),t._v(" "),n("p",[t._v("首先渲染的前提是生成渲染树，所以 HTML 和 CSS 肯定会阻塞渲染。如果你想渲染的越快，你越应该降低一开始需要渲染的文件大小，并且扁平层级，优化选择器。然后当浏览器在解析到 script 标签时，会暂停构建 DOM，完成后才会从暂停的地方重新开始。也就是说，如果你想首屏渲染的越快，就越不应该在首屏就加载 JS 文件，这也是都建议将 "),n("code",[t._v("script")]),t._v(" 标签放在 "),n("code",[t._v("body")]),t._v(" 标签底部的原因。")]),t._v(" "),n("p",[t._v("当然在当下，并不是说 "),n("code",[t._v("script")]),t._v(" 标签必须放在底部，因为你可以给 "),n("code",[t._v("script")]),t._v(" 标签添加 "),n("code",[t._v("defer")]),t._v(" 或者 "),n("code",[t._v("async")]),t._v(" 属性。当 "),n("code",[t._v("script")]),t._v(" 标签加上 "),n("code",[t._v("defer")]),t._v(" 属性以后，表示该 JS 文件会并行下载，但是会放到 HTML 解析完成后(DOMContentLoaded 事件触发前)顺序执行，所以对于这种情况你可以把 "),n("code",[t._v("script")]),t._v(" 标签放在任意位置。对于没有任何依赖的 JS 文件可以加上 "),n("code",[t._v("async")]),t._v(" 属性，表示 JS 文件下载和解析不会阻塞渲染。")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器的工作原理：新式网络浏览器幕后揭秘"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://segmentfault.com/a/1190000018130499",target:"_blank",rel:"noopener noreferrer"}},[t._v("css加载会造成阻塞吗"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);