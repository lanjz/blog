import{_ as t,o,c,b as n,a as e,d as p,e as s,r as l}from"./app.910feec5.js";var i="/lanjz/assets/babel_1.a600ee34.jpg";const u={},r=p('<h1 id="babel" tabindex="-1"><a class="header-anchor" href="#babel" aria-hidden="true">#</a> Babel</h1><p>Babel \u662F\u4E00\u4E2A\u901A\u7528\u7684\u591A\u529F\u80FD JavaScript \u7F16\u8BD1\u5668\uFF0C\u4F46\u4E0E\u4E00\u822C\u7F16\u8BD1\u5668\u4E0D\u540C\u7684\u662F\u5B83\u53EA\u662F\u628A\u540C\u79CD\u8BED\u8A00\u7684\u9AD8\u7248\u672C\u89C4\u5219\u8F6C\u6362\u4E3A\u4F4E\u7248\u672C\u89C4\u5219\uFF0C\u800C\u4E0D\u662F\u8F93\u51FA\u53E6\u4E00\u79CD\u4F4E\u7EA7\u673A\u5668\u53EF\u8BC6\u522B\u7684\u4EE3\u7801\uFF0C\u5E76\u4E14\u5728\u4F9D\u8D56\u4E0D\u540C\u7684\u62D3\u5C55\u63D2\u4EF6\u4E0B\u53EF\u7528\u4E8E\u4E0D\u540C\u5F62\u5F0F\u7684\u9759\u6001\u5206\u6790\u3002</p><p>\u901A\u4FD7\u8BB2\u5C31\u662F\u5C06es next(ECMScript2015\uFF0CECMScript2016\uFF0CECMScript2017\u7B49)\u7684\u8BED\u6CD5\u8F6C\u6362\u4E3A\u5411\u540E\u517C\u5BB9\u7684JavaScript\u8BED\u6CD5\uFF0C\u4F7F\u4EE3\u7801\u80FD\u591F\u8FD0\u884C\u5728\u5F53\u524D\u7684\u548C\u65E7\u7248\u672C\u7684\u6D4F\u89C8\u5668\u6216\u5176\u5B83\u73AF\u5883\u4E2D</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u9759\u6001\u5206\u6790\uFF1A\u6307\u5728\u4E0D\u9700\u8981\u6267\u884C\u4EE3\u7801\u7684\u524D\u63D0\u4E0B\u5BF9\u4EE3\u7801\u8FDB\u884C\u5206\u6790\u4EE5\u53CA\u76F8\u5E94\u5904\u7406\u7684\u4E00\u4E2A\u8FC7\u7A0B\uFF0C\u4E3B\u8981\u5E94\u7528\u4E8E\u8BED\u6CD5\u68C0\u67E5\u3001\u7F16\u8BD1\u3001\u4EE3\u7801\u9AD8\u4EAE\u3001\u4EE3\u7801\u8F6C\u6362\u3001\u4F18\u5316\u3001\u538B\u7F29\u7B49\u7B49</p></div><h2 id="babel-\u4E3B\u8981\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#babel-\u4E3B\u8981\u6A21\u5757" aria-hidden="true">#</a> Babel \u4E3B\u8981\u6A21\u5757</h2><ul><li><p><code>@babel/core</code>\uFF1A Babel \u7684\u7F16\u8BD1\u5668\uFF0C\u6838\u5FC3 API \u90FD\u5728\u8FD9\u91CC\u9762\uFF0C\u6BD4\u5982\u5E38\u89C1\u7684 <code>transform</code>\u3001<code>parse</code></p></li><li><p><code>@babel/cli</code>\uFF1A<code>cli</code> \u662F\u547D\u4EE4\u884C\u5DE5\u5177, \u5B89\u88C5\u4E86 <code>@babel/cli </code>\u5C31\u80FD\u591F\u5728\u547D\u4EE4\u884C\u4E2D\u4F7F\u7528 <code>babel</code> \u547D\u4EE4\u6765\u7F16\u8BD1\u6587\u4EF6\u3002\u5F53\u7136\u6211\u4EEC\u4E00\u822C\u4E0D\u4F1A\u7528\u5230\uFF0C\u6253\u5305\u5DE5\u5177\u5DF2\u7ECF\u5E2E\u6211\u4EEC\u505A\u597D\u4E86</p></li><li><p><code>@babel/node</code>\uFF1A\u76F4\u63A5\u5728 node \u73AF\u5883\u4E2D\uFF0C\u8FD0\u884C ES6 \u7684\u4EE3\u7801\u3002</p></li><li><p><code>babylon</code>\uFF1ABabel \u7684JS\u8BCD\u6CD5\u89E3\u6790\u5668</p></li><li><p><code>babel-traverse</code>\uFF1A\u7528\u4E8E\u5BF9 AST \u7684\u904D\u5386\uFF0C\u7EF4\u62A4\u4E86\u6574\u68F5\u6811\u7684\u72B6\u6001\uFF0C\u5E76\u4E14\u8D1F\u8D23\u66FF\u6362\u3001\u79FB\u9664\u548C\u6DFB\u52A0\u8282\u70B9\uFF0C\u8981\u7ED9 <code>plugin</code> \u7528</p></li><li><p><code>babel-types</code>\uFF1A\u7528\u4E8E AST \u8282\u70B9\u7684 Lodash \u5F0F\u5DE5\u5177\u5E93, \u5B83\u5305\u542B\u4E86\u6784\u9020\u3001\u9A8C\u8BC1\u4EE5\u53CA\u53D8\u6362 AST \u8282\u70B9\u7684\u65B9\u6CD5\uFF0C\u5BF9\u7F16\u5199\u5904\u7406 AST \u903B\u8F91\u975E\u5E38\u6709\u7528</p></li><li><p><code>babel-generator</code>\uFF1ABabel \u7684\u4EE3\u7801\u751F\u6210\u5668\uFF0C\u5B83\u8BFB\u53D6 AST \u5E76\u5C06\u5176\u8F6C\u6362\u4E3A\u4EE3\u7801\u548C\u6E90\u7801\u6620\u5C04\uFF08sourcemaps\uFF09</p></li><li><p><code>babel-runtime</code>: \u529F\u80FD\u7C7B\u4F3C <code>babel-polyfill</code> \uFF0C\u4E00\u822C\u7528\u4E8E <code>library</code> \u6216 <code>plugin\u4E2D</code>\uFF0C\u56E0\u4E3A\u5B83\u4E0D\u4F1A\u6C61\u67D3\u5168\u5C40\u4F5C\u7528\u57DF</p></li></ul><h2 id="\u8FD0\u884C\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u8FD0\u884C\u539F\u7406" aria-hidden="true">#</a> \u8FD0\u884C\u539F\u7406</h2><p><img src="'+i+`" alt=""></p><p>Babel \u5DE5\u4F5C\u5206\u4E3A\u4E09\u5927\u9636\u6BB5\uFF1A</p><ol><li><p>\u89E3\u6790(Parse)\uFF1A\u5C06\u4EE3\u7801\u5B57\u7B26\u4E32\u89E3\u6790\u4E3A\u62BD\u8C61\u8BED\u6CD5\u6811\uFF1B</p></li><li><p>\u8F6C\u6362(Transform)\uFF1A\u904D\u5386\u62BD\u8C61\u6811\uFF0C\u5BF9\u62BD\u8C61\u8BED\u6CD5\u6811\u8FDB\u884C\u518D\u53D8\u6362\uFF1B</p></li></ol><p><code>babel</code> \u63A5\u6536\u5F97\u5230 AST \u5E76\u901A\u8FC7 <code>babel-traverse</code> \u5BF9\u5176\u8FDB\u884C\u904D\u5386\uFF0C\u5728\u6B64\u8FC7\u7A0B\u4E2D\u8FDB\u884C\u6DFB\u52A0\u3001\u66F4\u65B0\u53CA\u79FB\u9664\u7B49\u64CD\u4F5C</p><ol start="3"><li>\u751F\u6210(Generate)\uFF1A\u4F7F\u7528 <code>babel-generator</code> \u6A21\u5757\u5C06 AST \u518D\u8F6C\u6362\u6362\u4E3A JS \u4EE3\u7801</li></ol><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>\u6B64\u5916\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0Cbabel \u53EA\u662F\u8F6C\u8BD1\u65B0\u6807\u51C6\u5F15\u5165\u7684\u8BED\u6CD5\uFF0C\u6BD4\u5982 ES6 \u7BAD\u5934\u51FD\u6570\uFF0C\u800C\u65B0\u6807\u51C6\u5F15\u5165\u7684\u65B0\u7684\u539F\u751F\u5BF9\u8C61\u5BF9\u8C61\u65B0\u589E\u7684\u539F\u578B\u65B9\u6CD5\u53CA\u65B0\u589E\u7684 API \u7B49\uFF08Proxy\u3001Set \u7B49\uFF09, \u8FD9\u4E9B\u4E8B\u4E0D\u4F1A\u8F6C\u8BD1\u7684\uFF0C\u9700\u8981\u5F15\u5165\u5BF9\u5E94\u7684 <code>polyfill</code> \u6765\u89E3\u51B3</p></div><h3 id="\u89E3\u6790" tabindex="-1"><a class="header-anchor" href="#\u89E3\u6790" aria-hidden="true">#</a> \u89E3\u6790</h3><p>\u89E3\u6790\u7B2C\u4E00\u6B65\u5206\u4E3A\u4E24\u4E2A\u6B65\u9AA4: \u5206\u8BCD\u548C\u8BED\u6CD5\u5206\u6790</p><ol><li>\u5206\u8BCD:\u5C06\u6574\u4E2A\u4EE3\u7801\u5B57\u7B26\u4E32\u5206\u5272\u6210 \u8BED\u6CD5\u5355\u5143 \u6570\u7EC4</li></ol><blockquote><p>\u8BED\u6CD5\u5355\u5143\u662F\u88AB\u89E3\u6790\u8BED\u6CD5\u5F53\u4E2D\u5177\u5907\u5B9E\u9645\u610F\u4E49\u7684\u6700\u5C0F\u5355\u5143\uFF0C\u901A\u4FD7\u70B9\u8BF4\u5C31\u662F\u7C7B\u4F3C\u4E8E\u81EA\u7136\u8BED\u8A00\u4E2D\u7684\u8BCD\u8BED</p></blockquote><p>\u62C6\u5206\u8FC7\u7A0B\u5C31\u662F\u5C31\u662F\u7B80\u5355\u7C97\u66B4\u5730\u4E00\u4E2A\u5B57\u7B26\u4E00\u4E2A\u5B57\u7B26\u5730\u904D\u5386\uFF0C\u7136\u540E\u5206\u60C5\u51B5\u8BA8\u8BBA\uFF0C\u6574\u4E2A\u5B9E\u73B0\u65B9\u6CD5\u5C31\u662F\u987A\u5E8F\u904D\u5386\u548C\u5927\u91CF\u7684\u6761\u4EF6\u5224\u65AD</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;if \\&quot;1 &gt; 0\\&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u5E0C\u671B\u5F97\u5230\u7684\u5206\u8BCD\u662F\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;if&#39;</span>     <span class="token string">&#39; &#39;</span>       <span class="token string">&#39;(&#39;</span>    <span class="token string">&#39;1&#39;</span>      <span class="token string">&#39; &#39;</span>    <span class="token string">&#39;&gt;&#39;</span>    <span class="token string">&#39; &#39;</span>    <span class="token string">&#39;)&#39;</span>    <span class="token string">&#39; &#39;</span>    <span class="token string">&#39;{&#39;</span>
<span class="token string">&#39;\\n  &#39;</span>   <span class="token string">&#39;alert&#39;</span>   <span class="token string">&#39;(&#39;</span>    <span class="token string">&#39;&quot;if \\&quot;1 &gt; 0\\&quot;&quot;&#39;</span>    <span class="token string">&#39;)&#39;</span>    <span class="token string">&#39;;&#39;</span>    <span class="token string">&#39;\\n&#39;</span>   <span class="token string">&#39;}&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>\u8BED\u4E49\u5206\u6790:\u5728\u5206\u8BCD\u7ED3\u679C\u7684\u57FA\u7840\u4E4B\u4E0A\u5206\u6790 \u8BED\u6CD5\u5355\u5143\u4E4B\u95F4\u7684\u5173\u7CFB</li></ol><p>\u8BED\u4E49\u5206\u6790\u5C31\u662F\u628A\u8BCD\u6C47\u8FDB\u884C\u7ACB\u4F53\u7684\u7EC4\u5408\uFF0C\u786E\u5B9A\u8BCD\u8BED\u6700\u7EC8\u662F\u4EC0\u4E48\u610F\u601D\u3001\u591A\u4E2A\u8BCD\u8BED\u4E4B\u95F4\u6709\u4EC0\u4E48\u5173\u7CFB\u4EE5\u53CA\u53C8\u5E94\u8BE5\u518D\u54EA\u91CC\u65AD\u53E5\u7B49</p><p>\u7B80\u5355\u6765\u8BF4\u8BED\u6CD5\u5206\u6790\u662F\u5BF9\u8BED\u53E5\u548C\u8868\u8FBE\u5F0F\u8BC6\u522B\uFF0C\u8FD9\u662F\u4E2A\u9012\u5F52\u8FC7\u7A0B\uFF0C\u5728\u89E3\u6790\u4E2D\uFF0CBabel \u4F1A\u5728\u89E3\u6790\u6BCF\u4E2A\u8BED\u53E5\u548C\u8868\u8FBE\u5F0F\u7684\u8FC7\u7A0B\u4E2D\u8BBE\u7F6E\u4E00\u4E2A\u6682\u5B58\u5668\uFF0C\u7528\u6765\u6682\u5B58\u5F53\u524D\u8BFB\u53D6\u5230\u7684\u8BED\u6CD5\u5355\u5143\uFF0C\u5982\u679C\u89E3\u6790\u5931\u8D25\uFF0C\u5C31\u4F1A\u8FD4\u56DE\u4E4B\u524D\u7684\u6682\u5B58\u70B9\uFF0C\u518D\u6309\u7167\u53E6\u4E00\u79CD\u65B9\u5F0F\u8FDB\u884C\u89E3\u6790\uFF0C\u5982\u679C\u89E3\u6790\u6210\u529F\uFF0C\u5219\u5C06\u6682\u5B58\u70B9\u9500\u6BC1\uFF0C\u4E0D\u65AD\u91CD\u590D\u4EE5\u4E0A\u64CD\u4F5C\uFF0C\u76F4\u5230\u6700\u540E\u751F\u6210\u5BF9\u5E94\u7684\u8BED\u6CD5\u6811</p><p>\u6211\u7684\u53E6\u4E00\u79CD\u7406\u89E3\u662F\uFF1A\u5728\u89E3\u6790\u6BCF\u4E2A\u8BED\u53E5\u548C\u8868\u8FBE\u5F0F\u7684\u8FC7\u7A0B\u4E2D\u8BBE\u7F6E\u4E00\u4E2A\u6682\u5B58\u5668\uFF0C\u7528\u6765\u6682\u5B58\u5F53\u524D\u8BFB\u53D6\u5230\u7684\u8BED\u6CD5\u5355\u5143\uFF0C\u5982\u679C\u8BFB\u53D6\u5230\u7684\u8BED\u6CD5\u5355\u5143\u80FD\u4E0E\u6682\u5B58\u7684\u6700\u540E\u4E00\u4E2A\u8BED\u6CD5\u5355\u5143\u5339\u914D\u6210\u5B8C\u6574\u7684\u8BED\u6CD5\uFF0C\u90A3\u4E48\u5C31\u5C06\u5F53\u524D\u7684\u8BED\u6CD5\u5355\u5143\u4ECE\u6808\u4E2D\u63A8\u51FA</p><h3 id="\u8F6C\u6362-transformation" tabindex="-1"><a class="header-anchor" href="#\u8F6C\u6362-transformation" aria-hidden="true">#</a> \u8F6C\u6362\uFF08Transformation\uFF09</h3><p>Transformation \u4F1A\u5BF9\u751F\u6210\u7684AST\u8FDB\u884C\u904D\u5386\uFF0C\u904D\u5386\u8FC7\u7A0B\u4E2D\u4F1A\u8C03\u7528\u8282\u70B9\u4E2D\u6CE8\u518C\u7684 <code>visitor</code> \u51FD\u6570\uFF0C<code>visitor</code> \u51FD\u6570\u4E2D\u53EF\u4EE5\u5BF9AST\u8282\u70B9\u8FDB\u884C\u589E\u5220\u6539</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">babel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">types</span><span class="token operator">:</span> t <span class="token punctuation">}</span> <span class="token operator">=</span> babel<span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">visitor</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u5BF9ast\u8282\u70B9\u8FDB\u884C\u589E\u5220\u6539\u64CD\u4F5C</span>
        path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>name <span class="token operator">=</span> path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5E73\u65F6\u4F7F\u7528\u7684 Babel \u63D2\u4EF6\u5C31\u662F\u4F5C\u7528\u4E8E\u8FD9\u4E2A\u9636\u6BB5\uFF0C\u5982\u679C\u8FD9\u4E2A\u9636\u6BB5\u4E0D\u4F7F\u7528\u4EFB\u4F55\u63D2\u4EF6\uFF0C\u90A3\u4E48 Babel \u4F1A\u539F\u6837\u8F93\u51FA\u4EE3\u7801</p>`,29),d=s("\u914D\u7F6E\u63D2\u4EF6\u7684\u65B9\u5F0F\u4E00\u822C\u662F\u5728\u9879\u76EE\u6839\u76EE\u5F55\u521B\u5EFA "),k=n("code",null,"babel.config.js",-1),v=s(" \u3001 "),b=n("code",null,"babel.config.json",-1),m=s(" \u6216 "),g=n("code",null,".babelrc",-1),y=s("\uFF0C\u5177\u4F53\u770B "),f={href:"https://www.babeljs.cn/docs/config-files",target:"_blank",rel:"noopener noreferrer"},q=s("Babel-Config Files"),h=p(`<p>\u914D\u7F6E\u793A\u4F8B\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// .babelrc \u6587\u4EF6</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/preset-env&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-decorators&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;legacy&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-class-properties&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;loose&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>presets</code> \u8868\u793A Babel \u9884\u8BBE\u63D2\u4EF6\uFF0C \u6BCF\u5E74\u6BCF\u4E2A <code>Preset</code> \u53EA\u7F16\u8BD1\u5F53\u5E74\u6279\u51C6\u7684\u5185\u5BB9\u3002\u800C <code>babel-preset-env</code> \u76F8\u5F53\u4E8E ES2015 \uFF0CES2016 \uFF0CES2017 \u53CA\u6700\u65B0\u7248\u672C</p><p><code>plugins</code> \u662F\u901A\u8FC7 npm \u5B89\u88C5\u7684\u5176\u5B83\u63D2\u4EF6</p><p>Preset \u548C Plugin \u548C\u5177\u4F53\u4F7F\u7528\u533A\u522B\u4E0B\u6587\u518D\u8BB2\uFF0C\u603B\u4E4B\u8F6C\u6362\u9636\u6BB5\u9700\u8981\u901A\u8FC7\u8FD9\u4E9B\u63D2\u4EF6\u6765\u8FDB\u884C\u5DE5\u4F5C\uFF0C\u5C06\u4E4B\u524D\u7684 AST \u8F6C\u6362\u6210\u65B0\u7684 AST</p><h3 id="\u751F\u6210-code-generation" tabindex="-1"><a class="header-anchor" href="#\u751F\u6210-code-generation" aria-hidden="true">#</a> \u751F\u6210\uFF08Code Generation\uFF09</h3><p>\u6700\u540E\u4F7F\u7528 <code>babel-generator</code> \u6839\u636E\u4E0A\u4E00\u6B65\u751F\u6210\u7684\u65B0 AST \u6811\u751F\u6210 ES5 \u4EE3\u7801\u3002</p><h2 id="\u5177\u4F53\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u5177\u4F53\u4F7F\u7528" aria-hidden="true">#</a> \u5177\u4F53\u4F7F\u7528</h2><p>\u7ED3\u5408 Webpack \u6765\u770B\u4E0B\u600E\u4E48\u4F7F\u7528 Babel\uFF0C\u53CA Preset \u548C Plugin \u7684\u533A\u522B</p><p>\u5B89\u88C5\u9700\u8981\u7528\u5230\u7684\u6A21\u5757\uFF1A<code>babel-loadr</code> \u548C Babel \u7684\u6838\u5FC3\u6A21\u5757 <code>@babel/core</code>\uFF1A <code>yarn add @babel/core babel-loader -D</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Webpack \u914D\u7F6E\uFF1A vue.deploy.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].js&#39;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token punctuation">{</span>
				<span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				<span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
					<span class="token string">&#39;babel-loader&#39;</span>
				<span class="token punctuation">]</span>
			<span class="token punctuation">}</span>
		
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5165\u53E3\u6587\u4EF6:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// src/index.js</span>
<span class="token keyword">function</span> <span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;Hello&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">abc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7BAD\u5934\u51FD\u6570&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> element<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>package.json</code> \u6DFB\u52A0\u542F\u52A8\u547D\u4EE4</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code> <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --progress --colors &quot;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6267\u884C\u547D\u4EE4 <code>yarn build</code>, \u8F93\u51FA\u4EE5\u4E0B\u7ED3\u679C</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">abc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7BAD\u5934\u51FD\u6570&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230\u5E76\u6CA1\u505A\u4EFB\u4F55\u7684\u8F6C\u6362\uFF0C\u539F\u56E0\u4E0A\u6587\u4E5F\u8BF4\u8FC7\u6211\u4EEC\u5E76\u6CA1\u6709\u4F7F\u7528\u4EFB\u4F55\u7684\u8F6C\u6362\u63D2\u4EF6\uFF0C\u6240\u4EE5\u5728\u8F6C\u6362\u9636\u6BB5\u5C31\u539F\u6837\u8F93\u51FA\u4E86</p><p>\u63A5\u4E0B\u6765\u6211\u4EEC\u5728\u9879\u76EE\u76EE\u5F55\u521B\u5EFA <code>.babelrc</code> \u6587\u4EF6\u5E76\u5199\u4EE5\u4E0B\u914D\u7F6E\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/* .babelrc */</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-transform-arrow-functions&quot;</span><span class="token punctuation">]</span>    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BB0\u5F97\u5B89\u88C5\u6A21\u5757 <code>yarn add @babel/plugin-transform-arrow-functions -D</code>\u3002 \u7136\u540E\u91CD\u65B0\u6253\u5305</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">abc</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7BAD\u5934\u51FD\u6570&#39;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8BF4\u660E\u8F6C\u6362\u6210\u529F\u4E86!</p><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B Babel \u5C06\u4ECE <code>node_modules</code> \u4E2D\u67E5\u627E\u4F7F\u7528\u7684\u63D2\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u4F60\u7684 <code>Plugin/Preset</code> \u7684\u76F8\u5BF9\u6216\u7EDD\u5BF9\u8DEF\u5F84</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token string">&quot;./node_modules/asdf/plugin&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;transform-class-properties&quot;</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u5F53 <code>plugins</code> \u5305\u542B\u591A\u4E2A\u63D2\u4EF6\u65F6\uFF0C\u5B83\u7684\u6309\u6B63\u987A\u5E8F\u6267\u884C\u7684\u3002 \u4E5F\u5C31\u662F\u5148\u6267\u884C <code>./node_modules/asdf/plugin</code> \u518D\u6267\u884C <code>transform-class-properties</code></p></div><p>\u540C\u7406\u5982\u679C\u60F3\u4F7F\u7528\u5176\u5B83 ES6 \u7684\u8BED\u6CD5\u53EA\u8981\u914D\u7F6E\u76F8\u5E94\u7684\u8F6C\u6362\u63D2\u4EF6\u5373\u53EF\uFF0C\u4F46\u662F\u6709\u90A3\u4E48\u591A\u7684\u8BED\u6CD5\u9700\u8981\u8F6C\u6362\uFF0C\u4E00\u4E2A\u4E2A\u7684\u6DFB\u52A0\u63D2\u4EF6\u4E5F\u592A\u9EBB\u70E6\u4E86\uFF0C\u8FD9\u65F6\u5019\u5C31\u53EF\u4EE5\u4F7F\u7528 Babel \u63D0\u4F9B\u7684 <code>preset</code></p><h3 id="preset" tabindex="-1"><a class="header-anchor" href="#preset" aria-hidden="true">#</a> Preset</h3><p>\u4E0A\u6587\u8BF4\u8FC7 <code>preset</code> \u662F Babel \u5B98\u65B9\u5E2E\u6211\u4EEC\u505A\u4E86\u4E00\u4E9B\u9884\u8BBE\u7684\u63D2\u4EF6\u96C6\uFF0C\u5B98\u65B9\u63D0\u4F9B\u4E86\u5F88\u591A <code>presets</code>\uFF0C\u6BD4\u5982:</p><ul><li><p><code>preset-env</code>: \u5904\u7406 es6+ \u89C4\u8303\u8BED\u6CD5\u7684\u63D2\u4EF6\u96C6\u5408</p></li><li><p><code>preset-stage</code>: \u5904\u7406\u5C1A\u5904\u5728\u63D0\u6848\u8BED\u6CD5\u7684\u63D2\u4EF6\u96C6\u5408</p></li><li><p><code>preset-react</code>: \u5904\u7406 <code>react</code> \u8BED\u6CD5\u7684\u63D2\u4EF6\u96C6\u5408</p></li></ul><p>\u8FD8\u6709\u5176\u5B83\u7684\u7B49\u7B49\u7B49\u7B49\u3002\u3002</p><p><code>Presets</code> \u662F\u6309\u7167 ECMAScript \u8349\u6848\u6765\u7EC4\u7EC7\u7684\uFF0C\u901A\u5E38\u53EF\u4EE5\u5206\u4E3A\u4EE5\u4E0B\u4E09\u5927\u7C7B</p><ol><li>\u5DF2\u7ECF\u88AB\u5199\u5165 ECMAScript \u6807\u51C6\u91CC\u7684\u7279\u6027\uFF0C\u7531\u4E8E\u4E4B\u524D\u6BCF\u5E74\u90FD\u6709\u65B0\u7279\u6027\u88AB\u52A0\u5165\u5230\u6807\u51C6\u91CC\uFF0C\u6240\u4EE5\u53C8\u7EC6\u5206\u5982\u4E0B\u3002</li></ol><ul><li><p>ES2015\uFF1A\u5305\u542B\u57282015\u5E74\u52A0\u5165\u7684\u65B0\u7279\u6027</p></li><li><p>ES2016\uFF1A\u5305\u542B\u57282016\u5E74\u52A0\u5165\u7684\u65B0\u7279\u6027</p></li><li><p>ES2017\uFF1A\u5305\u542B\u57282017\u5E74\u52A0\u5165\u7684\u65B0\u7279\u6027</p></li><li><p>Env\uFF1A\u5305\u542B\u5F53\u524D\u6240\u6709EAMAScript\u6807\u51C6\u91CC\u7684\u6700\u65B0\u7279\u6027</p></li></ul><ol start="2"><li>\u88AB\u793E\u533A\u63D0\u51FA\u6765\u7684\u4F46\u8FD8\u672A\u5199\u5165ECMAScript\u6807\u51C6\u91CC\u7684\u7279\u6027\uFF0C\u8FD9\u5176\u4E2D\u53C8\u5206\u4E3A\u4EE5\u4E0B\u56DB\u79CD\u3002</li></ol><ul><li><p>stage0\uFF1A\u53EA\u662F\u4E00\u4E2A\u7F8E\u597D\u6FC0\u8FDB\u7684\u60F3\u6CD5\uFF0C\u4E00\u4E9BBabel\u63D2\u4EF6\u5B9E\u73B0\u4E86\u5BF9\u8FD9\u4E9B\u7279\u6027\u7684\u652F\u6301\uFF0C\u4F46\u662F\u4E0D\u786E\u5B9A\u662F\u5426\u4F1A\u88AB\u5B9A\u4E3A\u6807\u51C6</p></li><li><p>stage1\uFF1A\u503C\u5F97\u88AB\u7EB3\u5165\u6807\u51C6\u7684\u7279\u6027</p></li><li><p>stage2\uFF1A\u8BE5\u7279\u6027\u89C4\u8303\u5DF2\u7ECF\u88AB\u8D77\u8349\uFF0C\u5C06\u4F1A\u7EB3\u5165\u6807\u51C6\u8FDB\u800C</p></li><li><p>state3\uFF1A\u8BE5\u7279\u6027\u89C4\u8303\u5DF2\u7ECF\u5B9A\u7A3F\uFF0C\u5404\u5927\u6D4F\u89C8\u5668\u5382\u5546\u548CNode.js\u793E\u533A\u5DF2\u5F00\u59CB\u7740\u624B\u5B9E\u73B0</p></li><li><p>state4\uFF1A\u5728\u63A5\u4E0B\u7684\u4E00\u5E74\u91CC\u5C06\u4F1A\u52A0\u5165\u6807\u51C6\u4E2D</p></li></ul><ol start="3"><li>\u7528\u4E8E\u652F\u6301\u4E00\u4E9B\u7279\u5B9A\u5E94\u7528\u573A\u666F\u4E0B\u7684\u8BED\u6CD5\u7684\u7279\u6027\uFF0C\u548CECMAScript\u6807\u51C6\u6CA1\u6709\u5173\u7CFB\uFF0C\u4F8B\u5982 <code>babel-preset-react</code> \u7528\u4E8E\u652F\u6301React\u5F00\u53D1\u91CC\u7684JSX\u8BED\u6CD5</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;es2015&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;stage-2&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u4E0E Plugin \u6267\u884C\u987A\u5E8F\u76F8\u53CD\uFF0C\u50CF\u4E0A\u9762\u7C9F\u5B50\u4F7F\u7528\u4E86\u591A\u4E2A <code>Preset</code> \uFF0C\u6267\u884C\u7684\u65F6\u5019\u662F\u5012\u5E8F\u6267\u884C\u7684\uFF0C\u5373\u4F1A\u6309\u4EE5\u4E0B\u987A\u5E8F\u8FD0\u884C: <code>stage-2</code>\uFF0C <code>react</code>\uFF0C \u6700\u540E <code>es2015</code></p></div><h4 id="reset-env" tabindex="-1"><a class="header-anchor" href="#reset-env" aria-hidden="true">#</a> reset-env</h4><p>\u8FD9\u91CC\u6211\u4EEC\u4E3B\u8981\u4ECB\u7ECD\u4E0B <code>preset-env</code>, <code>babel-preset-env</code> \u76F8\u5F53\u4E8E\u652F\u6301 ES2015 \uFF0CES2016 \uFF0CES2017 \u53CA\u6700\u65B0\u7248\u672C\u7684\u8BED\u6CD5\u7279\u6027\u7684\u8F6C\u6362</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/* .babelrc */</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span>    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6211\u4EEC\u4FEE\u6539\u4E00\u4E0B\u6E90\u6587\u4EF6\uFF0C\u52A0\u5165\u66F4\u591A ES6 \u6765\u9A8C\u8BC1\u4E00\u4E0B\u6548\u679C\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> abc<span class="token punctuation">}</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span>includes<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6253\u5305\u540E\u770B\u4E0B\u7ED3\u679C\u53EF\u4EE5\u770B\u5230\u7BAD\u5934\u51FD\u6570\u548C\u89E3\u6784\u90FD\u6210\u529F\u8F6C\u6362\u4E86\uFF0C\u4F46\u662F <code>Promise</code>\u3001<code>inclides</code> \u5E76\u6CA1\u6709\u8F6C\u6362\u6210\u529F\uFF0C\u5728IE\u6D4F\u89C8\u5668\u4E2D\u6253\u5F00\u9875\u9762\uFF0C\u63A7\u5236\u53F0\u4E5F\u62A5\u9519\u4E86</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token constant">SCRIPT5009</span><span class="token operator">:</span> \u201CPromise\u201D\u672A\u5B9A\u4E49
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u56E0\u4E3A Preset \u53EA\u80FD\u5904\u7406ES6\u65B0\u8BED\u6CD5\uFF0C\u65B0\u7684API\u53CA\u65B0\u539F\u751F\u5BF9\u8C61\u7684\u65B9\u6CD5\u4E0D\u80FD\u8F6C\u6362</p></div><p><strong>Preset \u53EA\u662F\u8F6C\u8BD1\u65B0\u6807\u51C6\u5F15\u5165\u7684\u8BED\u6CD5</strong>\uFF0C\u6BD4\u5982:</p><ul><li><p>\u7BAD\u5934\u51FD\u6570</p></li><li><p><code>let/const</code></p></li><li><p>\u89E3\u6784</p></li><li><p>\u7B49\u7B49\u65B0\u8BED\u6CD5</p></li></ul><p><strong>\u5BF9\u4E8E\u65B0\u6807\u51C6\u5F15\u5165\u7684\u5168\u5C40\u53D8\u91CF\u3001\u65B9\u6CD5\u53CA\u90E8\u5206\u539F\u751F\u5BF9\u8C61\u65B0\u589E\u7684\u539F\u578B\u94FE\u4E0A\u7684\u65B9\u6CD5\uFF0CBabel \u8868\u793A\u8D85\u7EB2\u4E86</strong></p><ul><li><p>\u5168\u5C40\u53D8\u91CF</p></li><li><p><code>Promise</code></p></li><li><p><code>Symbol</code></p></li><li><p><code>WeakMap</code></p></li><li><p><code>Set</code></p></li><li><p><code>includes</code></p></li><li><p><code>generator</code> \u51FD\u6570</p></li></ul><p>\u5BF9\u4E8E\u4E0A\u9762\u7684\u8FD9\u4E9B API\uFF0CPreset \u662F\u4E0D\u4F1A\u8F6C\u8BD1\u7684\uFF0C\u9700\u8981\u5F15\u5165 <code>polyfill</code> \u6765\u89E3\u51B3</p><h3 id="polyfill" tabindex="-1"><a class="header-anchor" href="#polyfill" aria-hidden="true">#</a> Polyfill</h3><p><code>polyfill</code> \u662F\u4E00\u4E2A\u9488\u5BF9ES2015+\u73AF\u5883\u7684 <code>shim</code>\uFF0C\u4F7F\u7528 <code>babel-polyfill</code> \u4F1A\u628A ES2015+ \u73AF\u5883\u6574\u4F53\u5F15\u5165\u5230\u4F60\u7684\u4EE3\u7801\u73AF\u5883\u4E2D\uFF0C\u8BA9\u4F60\u7684\u4EE3\u7801\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u65B0\u6807\u51C6\u6240\u5F15\u5165\u7684\u65B0\u539F\u751F\u5BF9\u8C61\uFF0C\u65B0API\u7B49\uFF0C\u4E00\u822C\u6765\u8BF4\u5355\u72EC\u7684\u5E94\u7528\u548C\u9875\u9762\u90FD\u53EF\u4EE5\u8FD9\u6837\u4F7F\u7528\u3002\u8BF4\u767D\u4E86\u5C31\u662F\u4F7F\u7528 es5 \u7684\u65B9\u5F0F\u5B9E\u73B0\u4E86 es6\u7684\u65B9\u6CD5</p><p>\u5B9E\u73B0\u4E0A\u6765\u8BF4 <code>@babel/polyfill</code> \u5305\u53EA\u662F\u7B80\u5355\u7684\u628A <code>core-js</code> \u548C <code>regenerator runtime</code> \u5305\u88C5\u4E86\u4E0B\uFF0C\u8FD9\u4E24\u4E2A\u5305\u624D\u662F\u771F\u6B63\u7684\u5B9E\u73B0\u4EE3\u7801\u6240\u5728\uFF08\u540E\u6587\u4F1A\u8BE6\u7EC6\u4ECB\u7ECD <code>core-js</code> \uFF09\u3002</p><h4 id="\u4F7F\u7528\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528\u65B9\u6CD5" aria-hidden="true">#</a> \u4F7F\u7528\u65B9\u6CD5</h4><ol><li><p>\u5148\u5B89\u88C5\u5305\uFF1A <code>npm install --save @babel/polyfill</code></p></li><li><p>\u786E\u4FDD\u5728\u5165\u53E3\u5904\u5BFC\u5165 <code>polyfill</code>\uFF0C\u56E0\u4E3A <code>polyfill</code> \u4EE3\u7801\u9700\u8981\u5728\u6240\u6709\u5176\u4ED6\u4EE3\u7801\u524D\u5148\u88AB\u8C03\u7528\uFF0C\u4EE5\u4E0B\u4E24\u79CD\u65B9\u5F0F\u90FD\u53EF\u4EE5</p></li></ol><ul><li><p>\u76F4\u63A5\u5728\u5165\u53E3\u6587\u4EF6\u4E2D\u5F15\u5165\uFF1A <code>import &quot;@babel/polyfill&quot;</code></p></li><li><p>Webpack\u914D\u7F6E\uFF1A <code>module.exports = { entry: [&quot;@babel/polyfill&quot;, &quot;./app/js&quot;] }</code></p></li></ul><p>\u6211\u4EEC\u5728\u4F8B\u5B50\u4E2D\u5F15\u7528 <code>babel-polyfill</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">&#39;@babel/polyfill&#39;</span>
<span class="token keyword">function</span> <span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;Hello&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">abc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7BAD\u5934\u51FD\u6570&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Array.includes&#39;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> element<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u91CD\u65B0\u6253\u5305\u540E\u53D1\u73B0\u80FD\u5728IE\u4E0B\u8FD0\u884C\u4E86\uFF0C\u63A7\u5236\u4E5F\u80FD\u51FA <code>Array.includes true</code></p><h4 id="polyfill\u7684\u4E0D\u8DB3" tabindex="-1"><a class="header-anchor" href="#polyfill\u7684\u4E0D\u8DB3" aria-hidden="true">#</a> Polyfill\u7684\u4E0D\u8DB3</h4><p>\u5F15\u7528 <code>Polyfill</code> \u89E3\u51B3\u4E86ES6 \u65B0\u65B9\u6CD5\u7B49 Api \u4E0D\u80FD\u7528\u7684\u95EE\u9898\uFF0C\u4F46\u540C\u65F6\u4E5F\u4F1A\u53D1\u73B0\u6253\u5305\u51FA\u6765\u7684\u6587\u4EF6\u5927\u4E86\u975E\u5E38\u591A\uFF0C\u4E0D\u7528 <code>@babel/polyfill</code> \u4E4B\u524D\u624D <code>5.1KB</code> \u4F7F\u7528\u4E4B\u540E\u53D8\u6210\u4E86 <code>442KB</code>\uFF0C\u6240\u4EE5\u76F4\u63A5\u4F7F\u7528 <code>@babel/polyfill</code> \u4F1A\u5B58\u5728\u4E00\u4E9B\u95EE\u9898\uFF1A</p><ul><li><p>\u6253\u5305\u6587\u4EF6\u4F53\u79EF\u53D8\u5927</p></li><li><p><code>@babel/polyfill</code> \u4F1A\u6C61\u67D3\u5168\u5C40\u53D8\u91CF\uFF0C\u5982\u679C\u6253\u5305\u51FA\u6765\u7684\u6587\u4EF6\u662F\u4E00\u4E2A\u516C\u5171\u5E93\uFF0C\u90A3\u4E48\u5C31\u53EF\u80FD\u591A\u6B21\u5F15\u7528 <code>@babel/polyfill</code>\uFF0C\u53EF\u80FD\u5BFC\u81F4\u51B2\u7A81</p></li></ul><p><strong>\u9488\u5BF9\u7B2C\u4E00\u4E2A\u4F53\u79EF\u5927\u95EE\u9898</strong></p><p><code>@babel/preset-env</code> \u63D0\u4F9B\u4E86 <code>useBuiltIns</code> \u5C5E\u6027\u5E2E\u52A9\u6211\u4EEC\u6309\u9700\u5F15\u5165\u9700\u8981\u7684 <code>polyfill</code>\u3002\u53EF\u4EE5\u8BBE\u7F6E\u7684\u503C\u6709\uFF1A<code>false</code>,<code>entry</code> \u548C <code>usage</code>\uFF0C\u9ED8\u8BA4\u503C\u662F <code>false</code></p><ul><li><p><code>false</code>\uFF1A\u8868\u793A\u4E0D\u5F15\u5165 <code>polyfill</code></p></li><li><p><code>entry</code>: \u6839\u636E <code>target</code> \u914D\u7F6E\u7684\u7684\u6D4F\u89C8\u5668\u5217\u8868\uFF0C\u5F15\u5165\u6D4F\u89C8\u5668\u4E0D\u517C\u5BB9\u7684 <code>polyfill</code>\u3002<strong>\u9700\u8981\u5728\u5165\u53E3\u6587\u4EF6\u624B\u52A8\u6DFB\u52A0 <code>import &#39;@babel/polyfill&#39;</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span>
        <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;entry&quot;</span><span class="token punctuation">,</span>
          <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token string-property property">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;edge&quot;</span><span class="token operator">:</span> <span class="token string">&quot;17&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;safari&quot;</span><span class="token operator">:</span> <span class="token string">&quot;11.1&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;chrome&quot;</span><span class="token operator">:</span> <span class="token string">&quot;67&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6253\u5305\u540E\u4E5F\u80FD\u53D1\u73B0\u4F53\u79EF\u53D8\u5C0F\u4E86\u5F88\u591A\u3002\u6CE8\u610F\u5982\u679C\u6CA1\u6709\u6307\u5B9A <code>browserslist</code>\uFF0C\u8DDF <code>false</code> \u6CA1\u533A\u522B</p></li><li><p><code>usage</code>\uFF1A<code>usage</code> \u4F1A\u6839\u636E\u914D\u7F6E\u7684\u6D4F\u89C8\u5668\u517C\u5BB9\uFF0C\u4EE5\u53CA\u4F60\u4EE3\u7801\u4E2D\u7528\u5230\u7684 API \u6765\u8FDB\u884C <code>polyfill</code>\uFF0C\u5B9E\u73B0\u4E86\u6309\u9700\u6DFB\u52A0\u8F7D\uFF0C<strong>\u4E0D\u9700\u8981\u81EA\u6DFB\u52A0 <code>import &#39;@babel/polyfill&#39;</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span>
        <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
          <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u5F53 <code>useBuiltIns</code> \u503C\u662F <code>entry</code> \u6216 <code>usage</code> \u65F6\uFF0C\u9700\u8981\u6307\u5B9A <code>core-js</code> \u6A21\u5757\u7684\u7248\u672C</p></div><p>\u4F8B\u5B50\uFF1A</p><p>\u6E90\u7801</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7F16\u8BD1\u540E</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;core-js/modules/es7.array.includes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;core-js/modules/es6.promise&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;core-js/modules/es6.object.to-string&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7ED3\u5408 <code>@babel/preset-env</code> \u7684\u914D\u7F6E\uFF0C\u53EF\u4EE5\u89E3\u51B3\u5F15\u7528 <code>polyfill</code> \u8FC7\u5927\u7684\u95EE\u9898\uFF0C\u4F46\u5BF9\u4E8E\u7B2C\u4E8C\u4E2A\u95EE\u9898\u9700\u8981\u4F7F\u7528 <code>babel-runtime</code> \u89E3\u51B3</p><h3 id="runtime" tabindex="-1"><a class="header-anchor" href="#runtime" aria-hidden="true">#</a> runtime</h3><p>\u76F4\u63A5\u4F7F\u7528 <code>babel-polyfill</code> \u5BF9\u4E8E\u5E94\u7528\u6216\u9875\u9762\u7B49\u73AF\u5883\u5728\u4F60\u63A7\u5236\u4E4B\u4E2D\u7684\u60C5\u51B5\u6765\u8BF4\uFF0C\u5E76\u6CA1\u6709\u4EC0\u4E48\u95EE\u9898\u3002\u4F46\u662F\u5BF9\u4E8E\u5728 <code>library</code> \u4E2D\u4F7F\u7528 <code>polyfill</code> \uFF0C\u5C31\u53D8\u5F97\u4E0D\u53EF\u884C\u4E86\u3002 \u56E0\u4E3A <code>library</code> \u662F\u4F9B\u5916\u90E8\u4F7F\u7528\u7684\uFF0C\u4F46\u5916\u90E8\u7684\u73AF\u5883\u5E76\u4E0D\u5728 <code>library</code> \u7684\u53EF\u63A7\u8303\u56F4\uFF0C\u800C <code>polyfill</code> \u662F\u4F1A\u6C61\u67D3\u539F\u6765\u7684\u5168\u5C40\u73AF\u5883\u7684\uFF08\u56E0\u4E3A\u65B0\u7684\u539F\u751F\u5BF9\u8C61\u3001API\u8FD9\u4E9B\u90FD\u76F4\u63A5\u7531 <code>polyfill</code> \u5F15\u5165\u5230\u5168\u5C40\u73AF\u5883\uFF09\u3002\u8FD9\u6837\u5C31\u5F88\u5BB9\u6613\u4F1A\u53D1\u751F\u51B2\u7A81\uFF0C\u6240\u4EE5\u8FD9\u4E2A\u65F6\u5019\uFF0C<code>babel-runtime</code> \u5C31\u53EF\u4EE5\u6D3E\u4E0A\u7528\u573A\u4E86\u3002</p><p>\u7C9F\u5B50\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/* .babelrc */</span>

<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>  
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u6E90\u7801</span>
<span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u7F16\u8BD1\u540E\u7ED3\u679C</span>
<span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _interopRequireDefault <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/runtime-corejs3/helpers/interopRequireDefault&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _includes <span class="token operator">=</span> <span class="token function">_interopRequireDefault</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/runtime-corejs3/core-js-stable/instance/includes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _promise <span class="token operator">=</span> <span class="token function">_interopRequireDefault</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/runtime-corejs3/core-js-stable/promise&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">_promise</span><span class="token punctuation">[</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _includes<span class="token punctuation">[</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4ECE\u4E0A\u9762\u4EE3\u7801\u53EF\u4EE5\u770B\u5230\uFF0C\u5F53\u6211\u4EEC\u8981\u4F7F\u7528 <code>Promise</code> \u65F6\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u662F\u4ECE <code>@babel/runtime-corejs3/core-js-stable/instance/includes</code> \u5BFC\u51FA\u5E76\u8D4B\u503C\u7ED9\u4E86\u4E00\u4E2A <code>_promise</code> \u53D8\u91CF\uFF0C\u901A\u8FC7 <code>_promise</code> \u6765\u4F7F\u7528 <code>Promise</code> \uFF0C\u8FD9\u6837\u65E2\u6709\u4E86 <code>Promise</code> \u7684\u529F\u80FD\uFF0C\u540C\u65F6\u53C8\u6CA1\u6709\u6C61\u67D3\u5168\u5C40\u73AF\u5883</p><h4 id="runtime\u7684\u4E0D\u8DB3\u4E4B\u5904" tabindex="-1"><a class="header-anchor" href="#runtime\u7684\u4E0D\u8DB3\u4E4B\u5904" aria-hidden="true">#</a> runtime\u7684\u4E0D\u8DB3\u4E4B\u5904</h4><p>runtime \u7684\u4F7F\u7528\u8DDF polyfill \u7C7B\u4F3C\uFF0C\u8FD8\u80FD\u89E3\u51B3\u5168\u5C40\u6C61\u67D3\u7684\u95EE\u9898\uFF0C\u90A3\u662F\u4E0D\u662F\u5C31\u53EF\u4EE5\u4E0D\u7528 polyfill \u4E86\u5462\uFF1F \u770B\u4E0B\u9762\u8FD9\u4E2A\u4F8B\u5B50</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// .babelrc</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/preset-env&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7BAD\u5934\u51FD\u6570&#39;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token string">&#39;abc&#39;</span><span class="token punctuation">}</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>includes<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u7684 babel \u914D\u7F6E\u4F7F\u7528 presets \u8F6C\u6362\u65B0\u8BED\u6CD5\uFF0C\u4F7F\u7528 transform-runtime \u4EE3\u66FF\u65B0\u7684\u5168\u5C40\u65B9\u6CD5\u548C API \uFF0C\u4F46\u662F\u6253\u5305\u8FD0\u884C\u540E\u53D1\u73B0 <code>console.log([].includes)</code> \u5728IE \u4E0B\u8F93\u51FA\u4E3A <code>undefined</code>\uFF0C<strong>\u8BF4\u660E transform-runtime \u662F\u4E0D\u80FD\u5904\u7406\u5BF9\u8C61\u539F\u578B\u4E0A\u7684\u65B9\u6CD5</strong>\uFF0C\u6240\u4EE5\u6839\u636E\u8FD9\u79CD\u60C5\u51B5\uFF0C\u4ECD\u7136\u9700\u8981\u4F7F\u7528 polyfill \u8FDB\u884C\u89E3\u51B3</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F7F\u7528 babel \u5206\u522B\u770B\u4E0B\u4E24\u8005\u6253\u5305\u51FA\u6765\u7684\u533A\u522B</p><p>\u6CA1\u6709\u4F7F\u7528 polyfill</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _interopRequireDefault <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/runtime-corejs2/helpers/interopRequireDefault&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _promise <span class="token operator">=</span> <span class="token function">_interopRequireDefault</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/runtime-corejs2/core-js/promise&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7BAD\u5934\u51FD\u6570&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token string">&#39;abc&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
    a <span class="token operator">=</span> _a<span class="token punctuation">.</span>a<span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">_promise</span><span class="token punctuation">[</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>includes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6DFB\u52A0\u4E86 polyfill</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _interopRequireDefault <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/runtime-corejs2/helpers/interopRequireDefault&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;core-js/modules/es7.array.includes.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _promise <span class="token operator">=</span> <span class="token function">_interopRequireDefault</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/runtime-corejs2/core-js/promise&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7BAD\u5934\u51FD\u6570&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token string">&#39;abc&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
    a <span class="token operator">=</span> _a<span class="token punctuation">.</span>a<span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">_promise</span><span class="token punctuation">[</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>includes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230\u6DFB\u52A0 polyfill \u540E\u8F93\u51FA\u6587\u4EF6\u591A\u4E86\u4E00\u884C <code>require(&quot;core-js/modules/es7.array.includes.js&quot;);</code>\uFF0C\u4EE5\u6B64\u8FBE\u5230 \u5B9E\u73B0 <code>[].includes</code> \u7684\u76EE\u7684</p><h4 id="transform-runtime\u548Cbabel-runtime" tabindex="-1"><a class="header-anchor" href="#transform-runtime\u548Cbabel-runtime" aria-hidden="true">#</a> transform-runtime\u548Cbabel-runtime</h4><p><code>babel-plugin-transform-runtime</code> \u63D2\u4EF6\u4F9D\u8D56 <code>babel-runtime</code>\uFF0C<code>babel-runtime</code> \u662F\u771F\u6B63\u63D0\u4F9B <code>runtime</code> \u73AF\u5883\u7684\u5305\uFF1B\u4E5F\u5C31\u662F\u8BF4 <code>transform-runtime</code> \u63D2\u4EF6\u662F\u628A js \u4EE3\u7801\u4E2D\u4F7F\u7528\u5230\u7684\u65B0\u539F\u751F\u5BF9\u8C61\u548C\u9759\u6001\u65B9\u6CD5\u8F6C\u6362\u6210\u5BF9 <code>runtime</code> \u5B9E\u73B0\u5305\u7684\u5F15\u7528\uFF0C\u4E0B\u9762\u662F\u4E00\u4E2A\u4F7F\u7528 <code>transform-runtime</code> \u63D2\u4EF6\u540E\u7684\u6253\u5305\u7684\u4F8B\u5B50\uFF1A</p><p>\u53E6\u5916\uFF0C\u4ECE\u4E0A\u9762\u6253\u5305\u8F93\u51FA\u7684\u4F8B\u5B50\u6211\u4EEC\u4E5F\u53EF\u4EE5\u9690\u7EA6\u53D1\u73B0\uFF0C<code>babel-runtime</code> \u5176\u5B9E\u4E5F\u4E0D\u662F\u771F\u6B63\u7684\u5B9E\u73B0\u4EE3\u7801\u6240\u5728\uFF0C\u771F\u6B63\u7684\u4EE3\u7801\u5B9E\u73B0\u662F\u5728 <code>core-js</code> \u4E2D\uFF0C\u540E\u9762\u6211\u4EEC\u518D\u8BF4</p><p>\u603B\u7ED3\u6765\u8BF4 <code>babel-plugin-transform-runtime</code> \u63D2\u4EF6\u7684\u529F\u80FD\u6709\u4EE5\u4E0B\u51E0\u70B9\uFF1A</p><ul><li><p>\u5F53\u4EE3\u7801\u4E2D\u6709\u4F7F\u7528\u5230\u7684 ES6 \u5F15\u5165\u7684\u65B0\u539F\u751F\u5BF9\u8C61\u548C\u9759\u6001\u65B9\u6CD5\u65F6\uFF0C\u8FD9\u4E9B\u65B9\u6CD5\u4F7F\u7528 <code>babel-runtime/core-js</code> \u5BF9\u5E94\u7684\u65B9\u6CD5\u66FF\u4EE3</p></li><li><p>\u5F53\u4F7F\u7528 <code>generators</code> \u6216 <code>async</code> \u51FD\u6570\u65F6\uFF0C\u7528 <code>babel-runtime/regenerator</code> \u5BFC\u51FA\u7684\u51FD\u6570\u53D6\u4EE3</p></li><li><p>\u628A Babel \u751F\u6210\u7684\u8F85\u52A9\u51FD\u6570\u6539\u4E3A\u7528 <code>babel-runtime/helpers</code> \u5BFC\u51FA\u7684\u51FD\u6570\u6765\u66FF\u4EE3\uFF08 Babel \u9ED8\u8BA4\u4F1A\u5728\u6BCF\u4E2A\u6587\u4EF6\u9876\u90E8\u653E\u7F6E\u6240\u9700\u8981\u7684\u8F85\u52A9\u51FD\u6570\uFF0C\u5982\u679C\u6587\u4EF6\u591A\u7684\u8BDD\uFF0C\u8FD9\u4E9B\u8F85\u52A9\u51FD\u6570\u5C31\u5728\u6BCF\u4E2A\u6587\u4EF6\u4E2D\u90FD\u91CD\u590D\u4E86\uFF0C\u901A\u8FC7\u5F15\u7528 <code>babel-runtime/helpers</code> \u5C31\u53EF\u4EE5\u7EDF\u4E00\u8D77\u6765\uFF0C\u51CF\u5C11\u4EE3\u7801\u4F53\u79EF\uFF09</p></li><li><p>\u5B83\u53EF\u4EE5\u4E3A\u4F60\u7684\u4EE3\u7801\u521B\u5EFA\u4E00\u4E2A <code>sandboxed environment</code>\uFF08\u6C99\u7BB1\u73AF\u5883\uFF09\uFF0C\u8FD9\u5728\u4F60\u7F16\u5199\u4E00\u4E9B\u7C7B\u5E93\u7B49\u516C\u5171\u4EE3\u7801\u7684\u65F6\u5019\u5C24\u5176\u91CD\u8981\u3002</p></li></ul><p>\u5EFA\u8BAE\u4E0D\u8981\u76F4\u63A5\u4F7F\u7528 <code>babel-runtime</code>\uFF0C\u56E0\u4E3A<code> transform-runtime</code> \u4F9D\u8D56<code> babel-runtime</code>\uFF0C\u5927\u90E8\u5206\u60C5\u51B5\u4E0B\u90FD\u53EF\u4EE5\u7528 <code>transform-runtime</code> \u8FBE\u6210\u76EE\u7684</p><p><code>transform-runtime</code> \u5728 <code>.babelrc</code> \u91CC\u914D\u7F6E\u7684\u65F6\u5019\uFF0C\u8FD8\u53EF\u4EE5\u8BBE\u7F6E <code>helpers</code>\u3001<code>polyfill</code>\u3001<code>regenerator</code> \u8FD9\u4E09\u4E2A\u5F00\u5173\uFF0C\u4EE5\u81EA\u884C\u51B3\u5B9A<code> runtime</code> \u662F\u5426\u8981\u5F15\u5165\u5BF9\u5E94\u7684\u529F\u80FD</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u6CE8\u610F\uFF1A\u8FD9\u91CC\u4E00\u5B9A\u8981\u914D\u7F6E <code>corejs</code>\uFF0C\u540C\u65F6\u5B89\u88C5 <code>@babel/runtime-corejs2</code>\uFF0C\u4E0D\u914D\u7F6E\u7684\u60C5\u51B5\u4E0B <code>@babel/plugin-transform-runtime</code> \u9ED8\u8BA4\u662F\u4E0D\u5F15\u5165\u8FD9\u4E9B <code>polyfill</code> \u7684<code>helper</code> \u7684</p></div><h2 id="core-js" tabindex="-1"><a class="header-anchor" href="#core-js" aria-hidden="true">#</a> core-js</h2><p>\u4ECE\u4E0A\u9762\u4F8B\u5B50\u53EF\u4EE5\u770B\u5230 core-js \u624D\u662F\u5B9E\u73B0 shim \u7684\u6838\u5FC3\u6240\u5728\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u76F4\u63A5\u5F15\u5165\u6765\u5B9E\u73B0 <code>polyfill</code></p><p><strong>core-js\u7684\u4F7F\u7528</strong></p><ol><li>\u7C7B\u4F3C <code>polyfill</code>\uFF0C\u76F4\u63A5\u628A\u7279\u6027\u6DFB\u52A0\u5230\u5168\u5C40\u73AF\u5883\uFF0C\u8FD9\u79CD\u65B9\u5F0F\u4F53\u9A8C\u6700\u5B8C\u6574</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;core-js/fn/set&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;core-js/fn/array/from&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;core-js/fn/array/find-index&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; [1, 2, 3]</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>isNaN<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// =&gt; 2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>\u7C7B\u4F3C<code>runtime</code> \u4E00\u6837\uFF0C\u4EE5\u5E93\u7684\u5F62\u5F0F\u6765\u4F7F\u7528\u7279\u6027\uFF0C\u8FD9\u79CD\u65B9\u5F0F\u4E0D\u4F1A\u6C61\u67D3\u5168\u5C40\u540D\u5B57\u7A7A\u95F4\uFF0C\u4F46\u662F\u4E0D\u80FD\u4F7F\u7528\u5B9E\u4F8B\u65B9\u6CD5</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> Set       <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;core-js/library/fn/set&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> from      <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;core-js/library/fn/array/from&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> findIndex <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;core-js/library/fn/array/find-index&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// =&gt; [1, 2, 3]</span>
<span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> isNaN<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u56E0\u4E3A\u7B2C\u4E8C\u79CD\u5E93\u7684\u5F62\u5F0F\u4E0D\u80FD\u4F7F\u7528 <code>prototype</code> \u65B9\u6CD5\uFF0C\u6240\u4EE5\u7B2C\u4E09\u79CD\u65B9\u5F0F\u4F7F\u7528\u4E86\u4E00\u4E2A\u5C0F\u6280\u5DE7\uFF0C\u901A\u8FC7 <code>::</code> \u8FD9\u4E2A\u7B26\u53F7\u800C\u4E0D\u662F <code>.</code> \u6765\u8C03\u7528\u5B9E\u4F8B\u65B9\u5F0F\uFF0C\u4ECE\u800C\u8FBE\u5230\u66F2\u7EBF\u6551\u56FD\u7684\u76EE\u7684\u3002\u8FD9\u79CD\u65B9\u5F0F\u7684\u4F7F\u7528\uFF0C\u8DEF\u5F84\u4E2D\u90FD\u4F1A\u5E26\u6709 <code>/virtual/ </code></li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>fill<span class="token punctuation">,</span> findIndex<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;core-js/library/fn/array/virtual&#39;</span><span class="token punctuation">;</span>

<span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> b <span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">it</span> <span class="token operator">=&gt;</span> it <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>it <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 4</span>

<span class="token comment">// \u5BF9\u6BD4\u4E0Bpolyfill\u7684\u5B9E\u73B0 </span>
<span class="token comment">// Array(10).fill(0).map((a, b) =&gt; b * b).findIndex(it =&gt; it &amp;&amp; !(it % 8));</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h2><p>babel \u7684\u4F7F\u7528\u4F9D\u8D56\u63D2\u4EF6\u3002Preset \u662F\u5B98\u65B9\u9884\u8BBE\u7684\u63D2\u4EF6\u96C6\u3002\u4F46\u662F Preset \u53EF\u4EE5\u8F6C\u6362\u65B0\u7684\u8BED\u6CD5\uFF0C\u4F46\u5BF9\u4E8E\u65B0\u7684\u5168\u5C40\u65B9\u6CD5\u548CAPI\u53CA\u5BF9\u8C61\u539F\u578B\u4E0A\u7684\u65B0\u65B9\u6CD5\u662F\u4E0D\u540C\u8F6C\u6362\u7684</p><p>\u5BF9\u4E8E Preset \u4E0D\u80FD\u5E72\u7684\u4E8B\u60C5\uFF0C\u53EF\u4EE5\u4F7F\u7528 polyfill \u6765\u89E3\u51B3\uFF0C\u4F46\u662F\u5982\u679C\u76F4\u63A5\u5168\u91CF\u5F15\u5165 polyfill \u4F1A\u6709\u4E24\u4E2A\u95EE\u9898</p><ol><li><p>\u6253\u5305\u6587\u4EF6\u4F53\u79EF\u53D8\u5927</p></li><li><p><code>@babel/polyfill</code> \u4F1A\u6C61\u67D3\u5168\u5C40\u53D8\u91CF\uFF0C\u5982\u679C\u6253\u5305\u51FA\u6765\u7684\u6587\u4EF6\u662F\u4E00\u4E2A\u516C\u5171\u5E93\uFF0C\u90A3\u4E48\u5C31\u53EF\u80FD\u591A\u6B21\u5F15\u7528 <code>@babel/polyfill</code>\uFF0C\u53EF\u80FD\u5BFC\u81F4\u51B2\u7A81</p></li></ol><p>\u9488\u5BF9\u7B2C\u4E00\u4E2A\u95EE\u9898\u53EF\u4EE5\u5728\u914D\u7F6E Preset \u65F6\uFF0C\u6309\u9700\u5F15\u5165 polyfill\uFF0C\u9488\u5BF9\u7B2C\u4E8C\u4E2A\u95EE\u9898\u53EF\u4EE5\u4F7F\u7528 <code>transform-runtime</code> \u8FDB\u884C\u89E3\u51B3</p><p>\u591A\u4E2A Preset \u7684\u914D\u7F6E\u6267\u884C\u65F6\u662F\u6309\u5012\u5E8F\u6267\u884C\u7684\uFF0C\u591A\u4E2A Plugin \u7684\u914D\u7F6E\u662F\u6309\u6B63\u5E8F\u6267\u884C\u7684\uFF0C<code>Preset</code> \u548C <code>plugins</code> \u53EF\u4EE5\u540C\u65F6\u5B58\u5728\uFF0C\u90A3\u4E48\u95EE\u9898\u6765\u4E86\uFF0C\u5982\u679C <code>presets</code> \u548C <code>plugins</code> \u540C\u65F6\u5B58\u5728\u65F6\uFF0C\u5148\u6267\u884C\u54EA\u4E2A\u5462\uFF1F</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// .babelrc \u6587\u4EF6</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/preset-env&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-decorators&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;legacy&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-class-properties&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;loose&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7B54\u6848\u662F\u5148\u6267\u884C <code>plugins</code> \u7684\u914D\u7F6E\uFF0C\u518D\u6267\u884C <code>presets</code> \u7684\u914D\u7F6E</p><p>\u6240\u4EE5\u4E0A\u9762\u4EE3\u7801\u7684\u6267\u884C\u987A\u5E8F\u4E3A</p><ol><li><p><code>@babel/plugin-proposal-decorators</code></p></li><li><p><code>@babel/plugin-proposal-class-properties</code></p></li><li><p><code>@babel/plugin-transform-runtime</code></p></li><li><p><code>@babel/preset-env</code></p></li></ol><p><strong>babel\u914D\u7F6E</strong></p><p>\u5982\u679C\u9879\u76EE\u4E0D\u662F\u7528\u4E8E\u516C\u5171\u5E93</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/* .babelrc */</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span><span class="token number">2</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u662F\u7528\u4E8E\u516C\u5171\u5E93\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/* .babelrc */</span>

<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>  
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6700\u4F73\u914D\u7F6E\u5E94\u8BE5\u662F\u8FD9\u4E2A\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>\u4F7F\u7528 <code>@babel/plugin-transform-runtime</code> \u5F15\u5165\u65B0\u7684\u5168\u5C40\u65B9\u6CD5</p></li><li><p>\u4F7F\u7528 <code>@babel/preset-env</code> \u8F6C\u6362\u65B0\u8BED\u6CD5</p></li><li><p>\u4E3A\u4F55\u8FD8\u8981\u4F7F\u7528 <code>useBuiltIns</code> \u5462\uFF1F\uFF0C\u4E3B\u662F\u4E3A\u4E86\u67D0\u4E9B\u5BF9\u8C61\u539F\u578B\u4E0A\u7684\u65B9\u6CD5\uFF0C\u4EE5 <code>[].includes</code> \u4E3A\u4F8B\uFF0C<code>transform-runtime</code> \u5BFC\u51FA\u7684 Array \u662F\u6CA1\u6709 <code>includes</code> \u65B9\u6CD5\u7684\uFF0C\u6240\u4EE5\u8FD8\u662F\u9700\u8981\u4F7F\u7528 <code>useBuiltIns</code> \u8FDB\u884C\u52A0\u6301</p></li></ul><h3 id="qa" tabindex="-1"><a class="header-anchor" href="#qa" aria-hidden="true">#</a> QA</h3><p><strong>\u5728\u8FD0\u884C DEMO \u65F6\uFF0C\u53D1\u73B0\u6253\u5305\u51FA\u6765\u7684\u6587\u4EF6\uFF0C\u867D\u7136\u9879\u76EE\u4E2D\u7684 js \u8BED\u6CD5\u8F6C\u6362\u4E86\uFF0C\u4F46\u662F webpack \u6A21\u5757\u5316\u76F8\u5173\u7684\u4EE3\u7801\u8FD8\u662F\u51FA\u73B0\u7684\u7BAD\u5934\u51FD\u6570\u7B49ES6 \u4EE3\u7801</strong></p><p>\u56E0\u4E3A webpack5 \u9ED8\u8BA4\u4F7F\u7528ecma 6\u3002\u89E3\u51B3\u65B9\u5F0F\uFF0C\u5728 webpack \u914D\u7F6E\u9700\u8981\u6DFB\u52A0</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;web&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;es5&#39;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead</strong></p><p>\u6211\u7684\u89E3\u51B3\u65B9\u5F0F\u662F\u5728\u7ED9\u914D\u7F6E <code>babel-loader</code> \u5904\uFF0C\u6DFB\u52A0 <code>exclude</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;babel-loader&#39;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">core-js|runtime</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token comment">// include: path.resolve(__dirname)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,135),j={href:"https://segmentfault.com/a/1190000018721165",target:"_blank",rel:"noopener noreferrer"},x=s("\u53F2\u4E0A\u6700\u6E05\u6670\u6613\u61C2\u7684babel\u914D\u7F6E\u89E3\u6790"),w={href:"http://louiszhai.github.io/2019/12/02/webpack4.ie/#%E4%BB%A3%E7%A0%81%E5%9C%A8IE9%E4%B8%8B%E8%BF%90%E8%A1%8C",target:"_blank",rel:"noopener noreferrer"},_=s("webpack4\u7F16\u8BD1\u4EE3\u7801\u5982\u4F55\u5B8C\u7F8E\u9002\u914DIE\u5185\u6838");function P(S,E){const a=l("ExternalLinkIcon");return o(),c("div",null,[r,n("p",null,[d,k,v,b,m,g,y,n("a",f,[q,e(a)])]),h,n("p",null,[n("a",j,[x,e(a)])]),n("p",null,[n("a",w,[_,e(a)])])])}var A=t(u,[["render",P],["__file","Babel-Loader.html.vue"]]);export{A as default};
