import{_ as u,o as i,c as l,b as n,a,w as r,e as s,d as o,r as t}from"./app.4d5def3b.js";var e="/lanjz/assets/federation_1.019881bc.png";const k={},d=n("h1",{id:"module-federation",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#module-federation","aria-hidden":"true"},"#"),s(" Module Federation")],-1),v={href:"https://webpack.docschina.org/concepts/module-federation/",target:"_blank",rel:"noopener noreferrer"},m=s("Module Federation"),_=s(" \u662F Webpack 5 \u7684\u4E00\u4E2A\u65B0\u7279\u6027\u3002\u6587\u6863\u7684\u4ECB\u7ECD\u5982\u4E0B\uFF1A"),b=n("br",null,null,-1),g=s(" \u4E00\u4E2A\u5E94\u7528\u53EF\u4EE5\u7531\u591A\u4E2A\u72EC\u7ACB\u7684\u6784\u5EFA\u7EC4\u6210\u3002\u8FD9\u4E9B\u72EC\u7ACB\u7684\u6784\u5EFA\u4E4B\u95F4\u6CA1\u6709\u4F9D\u8D56\u5173\u7CFB\uFF0C\u4ED6\u4EEC\u53EF\u4EE5\u72EC\u7ACB\u5F00\u53D1\u3001\u90E8\u7F72\u3002\u4E0A\u8FF0\u89E3\u91CA\uFF0C\u5176\u5B9E\u5C31\u662F\u5FAE\u524D\u7AEF\u7684\u6982\u5FF5\u3002\u4F7F\u7528 module federation\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5728\u4E00\u4E2A javascript \u5E94\u7528\u4E2D\u52A8\u6001\u52A0\u8F7D\u5E76\u8FD0\u884C\u53E6\u4E00\u4E2A javascript \u5E94\u7528\u7684\u4EE3\u7801\uFF0C\u5E76\u5B9E\u73B0\u5E94\u7528\u4E4B\u95F4\u7684\u4F9D\u8D56\u5171\u4EAB"),y=n("p",null,"\u5176\u5B9E\u770B\u5230\u53BB\u597D\u50CF\u5C31\u662F\u652F\u6301\u6A21\u5757\u4ECE\u522B\u7684\u9879\u76EE\u5730\u5740\u8FDB\u884C\u52A0\u8F7D\uFF0C\u4ECE\u800C\u8FBE\u5230\u590D\u7528\u6A21\u5757\u7684\u7684\u6548\u679C",-1),h=n("h2",{id:"\u6E90\u7801\u7B80\u6790",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u6E90\u7801\u7B80\u6790","aria-hidden":"true"},"#"),s(" \u6E90\u7801\u7B80\u6790")],-1),f=s("\u9996\u9875\u56DE\u987E\u4E00\u4E2A Webpack \u5B9E\u73B0\u7684 "),w=s("\u6A21\u5757\u52A0\u8F7D"),q=s(" \u7684\u539F\u7406\uFF1A"),x=o("<ul><li><p>Webpack \u6253\u5305\u540E\u7684\u6587\u4EF6\u5B9A\u4E49\u4E86\u4E00\u4E2A <code>__webpack_modules__</code> \u5BF9\u8C61\uFF0C\u7528\u4E8E\u5B58\u50A8\u6A21\u5757\u7684\u6267\u884C\u5185\u5BB9\u3002<code>key</code> \u503C\u5BF9\u5E94\u6A21\u5757\u7684 <code>id</code>\uFF0C <code>value</code> \u5BF9\u5E94\u6A21\u5757\u7684\u6A21\u5757\u5185\u5BB9</p></li><li><p>Webpack \u6253\u5305\u540E\u7684\u6587\u4EF6\u5B9A\u4E49\u4E86\u4E00\u4E2A <code>_webpack_module_cache__</code> \u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u7528\u4E8E\u7F13\u5B58\u6A21\u5757\u7684 <code>export</code> \u5BFC\u51FA\u7ED3\u679C\u3002<code>key</code> \u503C\u5BF9\u5E94\u6A21\u5757\u7684 <code>id</code>\uFF0C<code>value</code> \u5BF9\u5E94\u6A21\u5757\u7684\u8F93\u51FA</p></li><li><p>Webpack \u8FD8\u63D0\u4F9B\u4E86\u4E00\u4E2A <code>__webpack_require__</code> \u5BF9\u8C61\uFF0C\u53EF\u7528\u4E8E\u83B7\u53D6\u6A21\u5757\u7684\u8F93\u51FA\u3002\u6E90\u4EE3\u7801\u4E2D\u7684 <code>import xx from &#39;xxx&#39;</code>,\u6700\u7EC8\u4F1A\u88AB\u8F6C\u5316\u4E3A <code>__webpack_require__.[xx](...)</code> \u7684\u5F62\u5F0F</p></li><li><p>\u5BF9\u4E8E\u6BCF\u4E00\u4E2A\u62BD\u79BB\u51FA\u6765\u7684\u6A21\u5757 Webpack \u4F1A\u628A\u8FD9\u4E2A\u6A21\u5757\u6253\u5305\u4E3A\u4E00\u4E2A\u542B\u81EA\u6267\u884C\u65B9\u6CD5\u7684 JS \u6587\u4EF6\u3002\u5F53\u52A0\u8F7D\u8FD9\u4E2A JS \u6587\u4EF6\u7684\u65F6\u5019\u4F1A\u6267\u884C\u6A21\u5757\u5BF9\u5E94\u7684\u76F8\u5173\u4EE3\u7801\uFF0C\u5C06\u5BF9\u5185\u4FDD\u5B58\u5230 <code>__webpack_modules__</code> \u5BF9\u8C61\u4E2D</p></li><li><p>\u4E4B\u540E\u4F1A\u6267\u884C\u6A21\u5757\u7684\u4EE3\u7801\u5185\u5BB9\uFF0C\u8F93\u51FA <code>exports</code> \u5BFC\u51FA\u7ED3\u679C\u540C\u65F6\u4FDD\u5B58\u5230 <code>__webpack_module_cache__</code></p></li></ul><p>\u4E4B\u524D\u6A21\u5757\u52A0\u8F7D\u53EA\u652F\u6301\u5F53\u524D\u9879\u76EE\u6240\u5728\u7684\u5730\u5740\uFF0CFederation \u7684\u5B9E\u73B0\u5C31\u5728\u539F\u6765\u7684\u57FA\u672C\u4E0A\u652F\u6301\u4E86\u4ECE\u5176\u5B83\u5730\u4E0A\u8FDB\u884C\u6A21\u5757\u7684\u83B7\u53D6</p>",2),j=s("\u5B98\u65B9\u63D0\u4F9B\u4E86\u5F88\u591A\u4F7F\u7528 Federation \u7684\u7C9F\u5B50 "),S={href:"https://github.com/module-federation/module-federation-examples",target:"_blank",rel:"noopener noreferrer"},E=s("Module Federation Examples"),M=o(`<p>\u8FD9\u91CC\u4EE5 <code>Advanced API/automatic-vendor-sharing</code> \u4E3A\u57FA\u7840\u53BB\u63A2\u7D22 Federation \u7684\u8FD0\u884C\u539F\u7406\uFF0C\u7C9F\u5B50\u4E0B\u9762\u6709\u4E24\u4E2A\u5E94\u7528\uFF0C\u914D\u7F6E\u7684 Federation \u5982\u4E0B\u6240\u793A\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// app1 \u7684 Webpack \u914D\u7F6E</span>
<span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;app1&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;remoteEntry.js&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">remotes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">app2</span><span class="token operator">:</span> <span class="token string">&quot;app2@http://localhost:3002/remoteEntry.js&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">exposes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;./Button&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./src/Button&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>deps<span class="token punctuation">,</span>
    <span class="token literal-property property">react</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">singleton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;react-dom&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">singleton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// app2 \u7684 Webpack \u914D\u7F6E</span>
<span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;app2&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;remoteEntry.js&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">remotes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">app1</span><span class="token operator">:</span> <span class="token string">&quot;app1@http://localhost:3001/remoteEntry.js&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">exposes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;./Button&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./src/Button&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>deps<span class="token punctuation">,</span>
    <span class="token literal-property property">react</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">singleton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;react-dom&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">singleton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\u4ECE [\u5171\u4EAB\u4F9D\u8D56] \u548C [\u52A0\u8F7Dremote] \u4E24\u4E2A\u89D2\u5EA6\u53BB\u4E86\u89E3\u4E00\u4E0B Webpack \u662F\u600E\u4E48\u5904\u7406\u7684</p><h3 id="\u5171\u4EAB\u4F9D\u8D56" tabindex="-1"><a class="header-anchor" href="#\u5171\u4EAB\u4F9D\u8D56" aria-hidden="true">#</a> \u5171\u4EAB\u4F9D\u8D56</h3><p>\u7C9F\u5B50\u4E2D <code>react</code> \u548C <code>react-dom</code> \u4E24\u4E2A\u914D\u7F6E\u662F\u5171\u4EAB\u7684\uFF0C\u5F53\u6211\u4EEC\u914D\u7F6E\u4E86 Federation \u7684\u5171\u4EAB\u6A21\u5757\u914D\u7F6E\u540E\uFF0C\u4E3B\u6587\u4EF6\u5185\u5BB9\u5C06\u4F1A\u6DFB\u52A0\u5982\u4E0B\u4EE3\u7801\u5185\u5BB9</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token comment">/*! import() */</span><span class="token punctuation">[</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;webpack_sharing_consume_default_react_react-_2849&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;src_bootstrap_js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">__webpack_require__</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">,</span> <span class="token comment">/*! ./bootstrap */</span> <span class="token string">&quot;./src/bootstrap.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6E90\u7801\u4E2D\u8FD9\u6BB5\u4EE3\u7801\u662F\u901A\u8FC7 <code>eval</code> \u5305\u88C5\u8D77\u6765\u7684\uFF0C\u4F5C\u7528\u662F\u4F7F\u7528 <code>__webpack_require__.e</code> \u65B9\u6CD5\u52A0\u8F7D <code>webpack_sharing_consume_default_react_react-_2849</code> \u548C <code>src_bootstrap_js</code> \u4E24\u4E2A\u6A21\u5757\uFF0C\u8FD9\u91CC\u8DDF\u5171\u4EAB\u914D\u7F6E\u6709\u5173\u7684\u662F <code>webpack_sharing_consume_default_react_react-_2849</code> \u6587\u4EF6</p><p><code>__webpack_require__.e</code> \u5B9E\u9645\u6267\u884C\u7684 <code>__webpack_require__.f.consumes</code> \u65B9\u6CD5\u53BB\u83B7\u53D6 <code>webpack_sharing_consume_default_react_react-_2849</code> \u6A21\u5757</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u4FDD\u5B58\u6A21\u5757\u7684\u52A0\u8F7D\u7684\u72B6\u6001</span>
<span class="token keyword">var</span> installedModules <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
__webpack_require__<span class="token punctuation">.</span>f<span class="token punctuation">.</span><span class="token function-variable function">consumes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">chunkId<span class="token punctuation">,</span> promises</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>chunkMapping<span class="token punctuation">,</span> chunkId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// \u5224\u65AD chunkMapping \u5BF9\u8C61\u4E2D\u662F\u5426\u5B58\u5728 chunkId \u5C5E\u6027\uFF0C\u5373\u5224\u65AD\u5F53\u524D\u6A21\u5757\u662F\u5426\u5C5E\u6027\u5171\u4EAB\u6A21\u5757</span>
        chunkMapping<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// \u6839\u636E chunkId \u83B7\u53D6\u8981\u8F7D\u7684\u6A21\u5757</span>
            <span class="token comment">// \u5982\u679C installedModules \u5DF2\u7ECF\u8BE5\u6A21\u5757\u7684\u72B6\u6001\uFF0C\u76F4\u63A5\u53D6\u51FA\u4F7F\u7528</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>installedModules<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> promises<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>installedModules<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u8BBE\u7F6E\u6210\u529F\u7684\u56DE\u8C03</span>
            <span class="token keyword">var</span> <span class="token function-variable function">onFactory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">factory</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                installedModules<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// \u6210\u529F\u540E\u72B6\u6001\u7F6E\u4E3A 0 \uFF0C\u8868\u793A\u5DF2\u7ECF\u5B89\u88C5\u8FC7</span>
                __webpack_require__<span class="token punctuation">.</span>m<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">delete</span> __webpack_require__<span class="token punctuation">.</span>c<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token comment">// \u8BBE\u7F6E\u5931\u8D25\u7684\u56DE\u8C03</span>
            <span class="token keyword">var</span> <span class="token function-variable function">onError</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">delete</span> installedModules<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
                __webpack_require__<span class="token punctuation">.</span>m<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">delete</span> __webpack_require__<span class="token punctuation">.</span>c<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">throw</span> error<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> promise <span class="token operator">=</span> moduleToHandlerMapping<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u6267\u884C\u5BF9\u5E94\u7684\u65B9\u6CD5</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>promise<span class="token punctuation">.</span>then<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    promises<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>installedModules<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>onFactory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>onError<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token function">onFactory</span><span class="token punctuation">(</span>promise<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">onError</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9996\u5148 <code>chunkMapping</code> \u662F\u4E00\u4E2A\u6620\u5C04\u5BF9\u8C61\uFF0C\u901A\u8FC7\u5F53\u524D\u6A21\u5757\u540D\u8FD9\u4EF6\u4E8B\u54EA\u4E9B\u5177\u4F53\u7684\u6A21\u5757</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> chunkMapping <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token string-property property">&quot;webpack_sharing_consume_default_react_react-_2849&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token string">&quot;webpack/sharing/consume/default/react/react?2849&quot;</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;src_bootstrap_js&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token string">&quot;webpack/sharing/consume/default/react-dom/react-dom&quot;</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;webpack_sharing_consume_default_react_react-_76b1&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token string">&quot;webpack/sharing/consume/default/react/react?76b1&quot;</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>consumes</code> \u65B9\u6CD5\u5C31\u662F\u627E\u51FA\u8FD9\u4E2A\u6A21\u5757\u5BF9\u5E94\u5728\u7684\u8DEF\u5F84\uFF0C\u901A\u8FC7 <code>var promise = moduleToHandlerMapping[id]()</code> \u6267\u884C\u5BF9\u5E94\u7684\u65B9\u6CD5\uFF0C\u7136\u540E\u5C06\u8FD4\u56DE\u7684 <code>promise</code> \u8FD4\u56DE\u5B58\u5230 <code>promises</code> \u4E2D.<br> \u5F53 <code>promise</code> \u6267\u884C\u5B8C\u6210\u540E\u6267\u884C\u56DE\u8C03 <code>onFactory</code> \u65B9\u6CD5\uFF0C <code>onFactory</code> \u5C31\u662F\u6267\u884C\u52A0\u8F7D\u7684\u6587\u4EF6\uFF0C\u83B7\u53D6 <code>module.exports</code></p><p>\u4E0A\u9762\u7684 <code> moduleToHandlerMapping[id]()</code> \u4E5F\u662F\u4E00\u4E2A\u6620\u5C04\u5173\u7CFB\uFF0C\u5982\u4E0B\u6240\u793A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> moduleToHandlerMapping <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token string-property property">&quot;webpack/sharing/consume/default/react/react?2849&quot;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token function">loadSingletonVersionCheckFallback</span><span class="token punctuation">(</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;vendors-node_modules_react_index_js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;node_modules_object-assign_index_js-node_modules_prop-types_checkPropTypes_js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token comment">/*! react */</span> <span class="token string">&quot;./node_modules/react/index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\uFF0C
  <span class="token comment">//...\u7701\u7565</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E\u4ECE <code>moduleToHandlerMapping</code> \u5F97\u5230\u6A21\u5757\u52A0\u8F7D\u7684\u65B9\u6CD5\uFF0C\u5177\u4F53\u4EE3\u7801\u4E3A\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">loadSingletonVersionCheckFallback</span><span class="token punctuation">(</span>
    <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span> <span class="token punctuation">[</span>
          __webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;vendors-node_modules_react_index_js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
          __webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;node_modules_object-assign_index_js-node_modules_prop-types_checkPropTypes_js&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token comment">/*! react */</span> <span class="token string">&quot;./node_modules/react/index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> loadSingletonVersionCheckFallback <span class="token operator">=</span>  <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">scopeName<span class="token punctuation">,</span> scope<span class="token punctuation">,</span> key<span class="token punctuation">,</span> version<span class="token punctuation">,</span> fallback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>scope <span class="token operator">||</span> <span class="token operator">!</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>scope<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">getSingletonVersion</span><span class="token punctuation">(</span>scope<span class="token punctuation">,</span> scopeName<span class="token punctuation">,</span> key<span class="token punctuation">,</span> version<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">scopeName<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> promise <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span><span class="token constant">I</span><span class="token punctuation">(</span>scopeName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>promise <span class="token operator">&amp;&amp;</span> promise<span class="token punctuation">.</span>then<span class="token punctuation">)</span> <span class="token keyword">return</span> promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> scopeName<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">[</span>scopeName<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>scopeName<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">[</span>scopeName<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>loadSingletonVersionCheckFallback</code> \u5B9E\u9645\u4E0A\u6267\u884C\u7684 <code>init</code> \u8FD4\u56DE\u7684\u51FD\u6570\uFF0C\u6839\u636E\u5F53\u524D\u4F8B\u5B50\u53C2\u6570\u5BF9\u5E94\u4E3A\uFF1A</p><ul><li><p>scopeName\uFF1A <code>default</code></p></li><li><p>a\uFF1A <code>react</code></p></li><li><p>b\uFF1A <code>[1,16,13,0]</code></p></li><li><p>c\uFF1A Promise \u51FD\u6570</p></li></ul><p><code>init</code> \u65B9\u6CD5\u6267\u884C <code>__webpack_require__.I(scopeName)</code>\uFF0C<code>scopeName=default</code> \u662F\u9ED8\u8BA4\u503C</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/* webpack/runtime/sharing */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u521D\u59CB\u5316\u4E00\u4E2A __webpack_require__.S \u4FDD\u5B58\u5171\u4EAB\u7684\u4F9D\u8D56\u540D\u3001\u7248\u672C\u53F7\u3001\u83B7\u53D6\u65B9\u6CD5</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> initPromises <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> initTokens <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">I</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> initScope</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>initScope<span class="token punctuation">)</span> initScope <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// \u5904\u7406\u5FAA\u73AF\u521D\u59CB\u5316\u8C03\u7528      </span>
        <span class="token keyword">var</span> initToken <span class="token operator">=</span> initTokens<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>initToken<span class="token punctuation">)</span> initToken <span class="token operator">=</span> initTokens<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">// \u5982\u679C\u5B58\u5728\uFF0C\u8BF4\u660E\u4E4B\u524D\u83B7\u53D6\u540E\uFF0C\u76F4\u63A5\u8FD4\u56DE</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>initScope<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>initToken<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        initScope<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>initToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u9632\u6B62\u91CD\u590D\u8C03\u7528</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>initPromises<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> initPromises<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// \u4FDD\u5B58\u5F53\u524D\u5171\u4EAB\u6A21\u5757\u5230 __webpack_require__.S</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span> __webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8FD0\u884C\u8FD9\u4E2A\u6A21\u5757\u7684\u6240\u6709\u521D\u59CB\u5316\u4EE3\u7801\u7247\u6BB5</span>
        <span class="token keyword">var</span> scope <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token function-variable function">warn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> console <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span> <span class="token operator">&amp;&amp;</span> console<span class="token punctuation">.</span>warn <span class="token operator">&amp;&amp;</span> console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> uniqueName <span class="token operator">=</span> <span class="token string">&quot;@automatic-vendor-sharing/app1&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// \u6CE8\u518C\u5171\u4EAB\u6A21\u5757</span>
        <span class="token keyword">var</span> <span class="token function-variable function">register</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> version<span class="token punctuation">,</span> factory<span class="token punctuation">,</span> eager</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> versions <span class="token operator">=</span> scope<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> scope<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> activeVersion <span class="token operator">=</span> versions<span class="token punctuation">[</span>version<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6DFB\u52A0\u5F53\u524D\u6A21\u5757\u7684\u4FE1\u606F\u5230 versions \u5BF9\u8C61\u4E2D\uFF0C\u53D8\u5411\u4FDD\u5B58\u5230 __webpack_require__.S \u5BF9\u4E8E\u4E2D. \u5176\u4E2D get \u5C5E\u6027\u8868\u793A\u6267\u884C\u6A21\u5757\u7684\u83B7\u53D6\u65B9\u6CD5</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>activeVersion <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token operator">!</span>activeVersion<span class="token punctuation">.</span>loaded <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>eager <span class="token operator">!=</span> <span class="token operator">!</span>activeVersion<span class="token punctuation">.</span>eager <span class="token operator">?</span> eager <span class="token operator">:</span> uniqueName <span class="token operator">&gt;</span> activeVersion<span class="token punctuation">.</span>from<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> versions<span class="token punctuation">[</span>version<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">get</span><span class="token operator">:</span> factory<span class="token punctuation">,</span> <span class="token literal-property property">from</span><span class="token operator">:</span> uniqueName<span class="token punctuation">,</span> <span class="token literal-property property">eager</span><span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>eager <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token function-variable function">initExternal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> <span class="token function-variable function">handleError</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;Initialization of sharing external failed: &quot;</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment">// \u83B7\u53D6\u53E6\u4E2A\u5E94\u7528\u7684 remoteEntry.js \u6A21\u5757\uFF0C\u8FD9\u91CC\u8FD4\u56DE promise</span>
                <span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>module<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token comment">// module \u6267\u884C\u6210\u529F\u540E\u7684\u56DE\u8C03</span>
                <span class="token keyword">var</span> <span class="token function-variable function">initFn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>module <span class="token operator">&amp;&amp;</span> module<span class="token punctuation">.</span>init <span class="token operator">&amp;&amp;</span> module<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">,</span> initScope<span class="token punctuation">)</span><span class="token punctuation">)</span>
                 <span class="token comment">// \u6267\u884C\u662F\u5BFC\u6B65\u7684\uFF0C\u5148\u4FDD\u5B58 promise \u5230 promises \u4E2D\uFF0C\u7B49\u6210\u529F\u540E\u518D\u6267\u884C initFn</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>then<span class="token punctuation">)</span> <span class="token keyword">return</span> promises<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>initFn<span class="token punctuation">,</span> handleError<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// \u5982\u679C\u662F\u5DF2\u7ECF\u52A0\u8FC7\u7684\uFF0C\u76F4\u63A5\u6267\u884C initFn</span>
                <span class="token keyword">var</span> initResult <span class="token operator">=</span> <span class="token function">initFn</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// \u6DFB\u52A0\u5F02\u5E38\u7684\u60C5\u51B5</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>initResult <span class="token operator">&amp;&amp;</span> initResult<span class="token punctuation">.</span>then<span class="token punctuation">)</span> <span class="token keyword">return</span> promises<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>initResult<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>handleError<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">handleError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> promises <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token string">&quot;default&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;16.14.0&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;vendors-node_modules_react-dom_index_js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;webpack_sharing_consume_default_react_react-_76b1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token comment">/*! ./node_modules/react-dom/index.js */</span> <span class="token string">&quot;./node_modules/react-dom/index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;16.14.0&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;vendors-node_modules_react_index_js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;node_modules_object-assign_index_js-node_modules_prop-types_checkPropTypes_js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token comment">/*! ./node_modules/react/index.js */</span> <span class="token string">&quot;./node_modules/react/index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">initExternal</span><span class="token punctuation">(</span><span class="token string">&quot;webpack/container/reference/app2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>promises<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> initPromises<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> initPromises<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>promises<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>initPromises<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u4EE3\u7801\u901A\u8FC7 <code>register</code> \u65B9\u6CD5\u6DFB\u52A0\u5171\u4EAB\u6A21\u5757\u7684\u4FE1\u606F\u5230 <code>__webpack_require__.S</code> \u5BF9\u8C61\u4E2D\uFF0C\u6B64\u65F6 <code>__webpack_require__.S</code> \u5BF9\u8C61\u7684\u5185\u5BB9\u5927\u81F4\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><p><img src="`+e+`" alt=""></p><p>\u7136\u540E\u6267\u884C <code>initExternal(&quot;webpack/container/reference/app2&quot;)</code> \u65B9\u6CD5\uFF0C\u8C03\u7528 <code>__webpack_require__(id)</code> \u6267\u884C <code>webpack/container/reference/app2</code> \u6A21\u5757\u7684\u5185\u5BB9\uFF08\u8FD9\u90E8\u5206\u662F\u76F4\u63A5\u5728\u4E3B\u6587\u4EF6\u4E2D\uFF0C\u6240\u4EE5\u4E0D\u7528\u53E6\u5916\u52A0\u8F7D\u53EF\u4EE5\u76F4\u63A5\u6267\u884C\uFF09\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> __webpack_error__ <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u5982\u679C\u5B58\u5728 app2 \u6267\u884C\u6210\u529F\u7684\u56DE\u8C03      </span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> app2 <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u901A\u8FC7\u52A0\u8F7D remoteEntry.js</span>
	__webpack_require__<span class="token punctuation">.</span><span class="token function">l</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:3002/remoteEntry.js&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> app2 <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">var</span> errorType <span class="token operator">=</span> event <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&#39;load&#39;</span> <span class="token operator">?</span> <span class="token string">&#39;missing&#39;</span> <span class="token operator">:</span> event<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">var</span> realSrc <span class="token operator">=</span> event <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>target <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>src<span class="token punctuation">;</span>
		__webpack_error__<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;Loading script failed.\\n(&#39;</span> <span class="token operator">+</span> errorType <span class="token operator">+</span> <span class="token string">&#39;: &#39;</span> <span class="token operator">+</span> realSrc <span class="token operator">+</span> <span class="token string">&#39;)&#39;</span><span class="token punctuation">;</span>
		__webpack_error__<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;ScriptExternalLoadError&#39;</span><span class="token punctuation">;</span>
		__webpack_error__<span class="token punctuation">.</span>type <span class="token operator">=</span> errorType<span class="token punctuation">;</span>
		__webpack_error__<span class="token punctuation">.</span>request <span class="token operator">=</span> realSrc<span class="token punctuation">;</span>
		<span class="token function">reject</span><span class="token punctuation">(</span>__webpack_error__<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;app2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>app2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>webpack/container/reference/app2</code> \u7684\u5185\u5BB9\u5C31\u662F\u6267\u884C <code>__webpack_require__.l</code> \u52A8\u6001\u521B\u5EFA <code>script</code> \u52A0\u8F7D <code>http://localhost:3002/remoteEntry.js</code> \u8FD9\u91CC\u5148\u4E0D\u5173\u5FC3 <code>remoteEntry</code> \u7684\u5185\u5BB9\uFF0C\u56DE\u5851\u4E00\u4E0B\u8FC7\u7A0B\uFF1A</p><ol><li><p>\u5F53\u8FD9\u91CC\u6267\u884C\u540E <code>module.exports</code> \u8FD4\u56DE\u7684\u5C31\u662F\u4E00\u4E2A Promise , \u4E14 <code>resolve()</code> \u6267\u884C\u7684\u65F6\u5019\u662F\u6CA1\u8FD4\u56DE\u4EFB\u52A1\u503C\u7684</p></li><li><p>\u4E0A\u9762\u7684 <code>module</code>\uFF0C\u5728\u662F <code>__webpack_require__.I =&gt; initExternal()</code> \u6267\u884C\u7684 <code>var module = __webpack_require__(id)</code></p></li><li><p>\u5F53 <code>resolve()</code> \u540E\u5C06\u4F1A\u6267\u884C\u7684\u56DE\u8C03\u4E3A <code>var initFn = (module) =&gt; (module &amp;&amp; module.init &amp;&amp; module.init(__webpack_require__.S[name], initScope))</code></p></li><li><p>\u539F\u6765\u6267\u884C\u7684\u662F\u8FD9\u4E2A\u6A21\u5757\u5BFC\u51FA\u7684 <code>init</code> \u65B9\u6CD5</p></li></ol><p>\u603B\u7ED3\u6765\u8BF4\u5C31\u662F\u52A0\u8F7D <code>remoteEntry.js</code> \u540E\u5C31\u6267\u884C\u8FD9\u4E2A\u6A21\u5757\u7684 <code>init</code> \u65B9\u6CD5\uFF0C\u73B0\u5728\u5728\u770B\u4E0B\u8FD9\u4E2A <code>init</code> \u505A\u4E86\u4EC0\u4E48</p><p>\u6B64\u65F6 <code>__webpack_require__</code> \u4F5C\u7528\u5C31\u662F\u52A0\u8F7D <code>remoteEntry</code>\uFF0C\u8FD4\u56DE\u7684 <code>module.exports</code> \u662F\u4E00\u4E2A Promise\uFF0C\u8FD9\u4E2A Promise \u7684\u56DE\u8C03\u662F <code>app2</code></p><p>\u56DE\u5230 <code>initExternal</code> \u65B9\u6CD5\u4E2D\uFF0C\u6267\u884C <code> return promises.push(module.then(initFn, handleError))</code>, \u8FD4\u56DE\u5230 <code>promises</code> \u96C6\u5408\u4E2D</p><p><code>__webpack_require__.I</code> \u8FD4\u56DE\u7684\u5C31\u662F\u8FD9\u4E2A Promise \u96C6\u5408 <code>promises</code>\uFF0C\u5F53\u8FD9\u4E2A <code>promises.then</code> \u89E6\u53D1\u540E\u6267\u884C\u7684\u662F <code>init</code> \u4E2D\u7684 <code>fn</code> \u51FD\u6570\u53C2\u6570</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">shareScope<span class="token punctuation">,</span> initScope</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>__webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> oldScope <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">[</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;default&quot;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>oldScope <span class="token operator">&amp;&amp;</span> oldScope <span class="token operator">!==</span> shareScope<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Container initialization failed as it has already been initialized with a different share scope&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	__webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> shareScope<span class="token punctuation">;</span>
	<span class="token keyword">return</span> __webpack_require__<span class="token punctuation">.</span><span class="token constant">I</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> initScope<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u7684\u53C2\u6570 <code>shareScope</code> \u662F\u5C31\u662F app1 \u4E2D <code>__webpack_require__.S[name]\uFF08\u5171\u4EAB\u6A21\u5757\uFF09</code>\uFF0C\u4E5F\u5C31\u662F\u4F1A\u4F7F\u7528 <code>app1</code>\u7684\u5171\u4EAB\u6A21\u5757\u914D\u7F6E\u6765\u521D\u59CB\u5316 <code>app2</code> \u7684\u5171\u4EAB\u6A21\u5757\u914D\u7F6E\uFF0C\u8FD9\u6837\u5C31\u7B7E\u5230\u4E86\u4E24\u4E2A\u5E94\u7528\u4F7F\u7528\u7684\u4E00\u4EFD\u7684\u5171\u4EAB\u6A21\u5757\u7684\u914D\u7F6E.<br> \u7ED3\u5C3E\u6267\u884C <code>__webpack_require__.I(name, initScope)</code> \uFF0C\u8FD9\u91CC\u7684\u6267\u884C\u53EA\u4F1A\u6267\u884C <code>register</code> \u4E0D\u4F1A\u6267\u884C <code>initExternal</code></p><p>\u5230\u76EE\u524D\u4E3A\u6B62 <code> __webpack_require__.I</code> \u7B97\u662F\u6267\u884C\u4E86\uFF0C\u56DE\u5230 \u8C03\u7528 <code> __webpack_require__.I</code> \u65B9\u6CD5\u7684\u5730\u65B9\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> loadSingletonVersionCheckFallback <span class="token operator">=</span>  <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">scopeName<span class="token punctuation">,</span> scope<span class="token punctuation">,</span> key<span class="token punctuation">,</span> version<span class="token punctuation">,</span> fallback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>scope <span class="token operator">||</span> <span class="token operator">!</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>scope<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">getSingletonVersion</span><span class="token punctuation">(</span>scope<span class="token punctuation">,</span> scopeName<span class="token punctuation">,</span> key<span class="token punctuation">,</span> version<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">scopeName<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> promise <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span><span class="token constant">I</span><span class="token punctuation">(</span>scopeName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>promise <span class="token operator">&amp;&amp;</span> promise<span class="token punctuation">.</span>then<span class="token punctuation">)</span> <span class="token keyword">return</span> promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> scopeName<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">[</span>scopeName<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>scopeName<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span><span class="token constant">S</span><span class="token punctuation">[</span>scopeName<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">getSingletonVersion</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">scope<span class="token punctuation">,</span> scopeName<span class="token punctuation">,</span> key<span class="token punctuation">,</span> requiredVersion</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> version <span class="token operator">=</span> <span class="token function">findSingletonVersionKey</span><span class="token punctuation">(</span>scope<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">satisfy</span><span class="token punctuation">(</span>requiredVersion<span class="token punctuation">,</span> version<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">typeof</span> console <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span> <span class="token operator">&amp;&amp;</span> console<span class="token punctuation">.</span>warn <span class="token operator">&amp;&amp;</span> console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token function">getInvalidSingletonVersionMessage</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> version<span class="token punctuation">,</span> requiredVersion<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span>scope<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>version<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>__webpack_require__.I</code> \u6267\u884C\u540E\u5C31\u662F \u8C03\u7528 <code>get(scope[key][version])</code> \u7684\u6765\u83B7\u53D6\u5171\u4EAB\u7684\u6A21\u5757\u4E86\uFF0C\u5177\u4F53\u6267\u884C\u65B9\u6CD5\u5C31\u662F <code>register</code> \u5171\u79BB\u6A21\u5757\u65F6\u7684\u4F20\u7684\u7B2C\u4E09\u4E2A\u53C2\u6570\uFF0Ceg:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;16.14.0&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;vendors-node_modules_react_index_js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;node_modules_object-assign_index_js-node_modules_prop-types_checkPropTypes_js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token comment">/*! ./node_modules/react/index.js */</span> <span class="token string">&quot;./node_modules/react/index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5C31\u662F\u6267\u884C <code>__webpack_require__.e(&quot;vendors-node_modules_react_index_js&quot;)</code> \u548C <code>__webpack_require__.e(&quot;node_modules_object-assign_index_js-node_modules_prop-types_checkPropTypes_js&quot;)</code> \u52A0\u8F7D\u8FD9\u4E24\u4E2A\u6587\u4EF6\uFF0C\u5C06\u6A21\u5757\u5185\u5BB9\u4FDD\u5B58\u5230 <code>__webpack_modules__</code> \u5BF9\u8C61\u4E2D</p><h4 id="\u5C0F\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u5C0F\u7ED3" aria-hidden="true">#</a> \u5C0F\u7ED3</h4><p>\u5355\u4ECE\u4EE3\u7801\u7684\u8C03\u7528\u8FC7\u7A0B\u771F\u7684\u975E\u5E38\u7684\u7ED5\uFF0C\u6574\u7406\u4E00\u4E0B\u6D41\u7A0B\u5927\u81F4\u4E3A\uFF1A</p><p>\u6267\u884C\u5165\u53E3\u6A21\u5757\u4EE3\u7801\u65F6\uFF0C\u4F1A\u901A\u8FC7 <code>__webpack_require__.I</code> \u65B9\u6CD5\u521D\u59CB\u5316 <code>__webpack_require__.S</code> \u5BF9\u8C61\uFF0C\u8FD9\u4E2A\u5BF9\u5E94\u662F\u8BB0\u5F55\u5F53\u524D\u5E94\u7528\u5171\u4EAB\u6A21\u5757\u7684\u914D\u7F6E\u7684\uFF0C\u7136\u540E\u8C03\u7528 app2 \u7684 <code>remoteEntry.js</code>\uFF0C<code>app2/remoteEntry.js</code> \u52A0\u8F7D\u6210\u529F\u540E\u4F1A \u4F7F\u7528 <code>app1/__webpack_require__.S</code> \u521D\u59CB\u5316 <code>app2/__webpack_require__.S</code>,\u8FBE\u5230\u5171\u6709\u4E00\u4E2A\u5171\u4EAB\u6A21\u5757\u7684\u914D\u7F6E.<br> \u4E4B\u540E\u6267\u884C\u5171\u4EAB\u6A21\u5757\u7684 <code>get</code> \u65B9\u6CD5\u53BB\u83B7\u5177\u4F53\u7684\u6A21\u5757</p><h3 id="remote\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#remote\u6A21\u5757" aria-hidden="true">#</a> remote\u6A21\u5757</h3><p>\u4E0A\u6587\u6709\u8BB2\u5230\u5728\u52A0\u8F7D\u4E86 <code>remoteEntry.js</code>\uFF0C\u6709\u5B9A\u4E49\u4E86 <code>init</code> \u65B9\u6CD5\u6765\u521D\u59CB\u5316\u4E24\u8FB9\u7684\u5171\u4EAB\u6A21\u5757\u914D\u7F6E\uFF0C\u9664\u4E86 <code>init</code> \u65B9\u6CD5\u5176\u5B9E\u8FD8\u5B9A\u4E49\u4E86\u4E00\u4E2A <code>get</code>, \u7528\u6765\u83B7\u53D6\u8FDC\u7A0B\u5E94\u7528\u7684 <code>remote</code> \u6A21\u5757</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> moduleMap <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token string-property property">&quot;./Button&quot;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;webpack_sharing_consume_default_react_react-_2849&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;src_Button_js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token comment">/*! ./src/Button */</span> <span class="token string">&quot;./src/Button.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> getScope</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	__webpack_require__<span class="token punctuation">.</span><span class="token constant">R</span> <span class="token operator">=</span> getScope<span class="token punctuation">;</span>
	getScope <span class="token operator">=</span> <span class="token punctuation">(</span>
		__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>moduleMap<span class="token punctuation">,</span> module<span class="token punctuation">)</span>
			<span class="token operator">?</span> moduleMap<span class="token punctuation">[</span>module<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token operator">:</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;Module &quot;&#39;</span> <span class="token operator">+</span> module <span class="token operator">+</span> <span class="token string">&#39;&quot; does not exist in container.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
	__webpack_require__<span class="token punctuation">.</span><span class="token constant">R</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> getScope<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u56E0\u6B64\u9700\u8981\u52A0\u8F7D <code>remote</code> \u6A21\u5757\u65F6\u5C31\u662F\u901A\u8FC7\u4E0A\u9762\u7684\u65B9\u6CD5\u53BB\u52A0\u8FDC\u7A0B\u5E94\u7528\u7684\u6A21\u5757</p><h2 id="module-federation-\u914D\u7F6E\u9879\u8BE6\u89E3" tabindex="-1"><a class="header-anchor" href="#module-federation-\u914D\u7F6E\u9879\u8BE6\u89E3" aria-hidden="true">#</a> module federation \u914D\u7F6E\u9879\u8BE6\u89E3</h2><p>\u4E00\u4E2A\u5B8C\u6574\u7684 module federation \u914D\u7F6E\u9879\uFF0C\u5305\u542B\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">library</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">remotes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">app2</span><span class="token operator">:</span> <span class="token string">&#39;app2@xxxx&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">app3</span><span class="token operator">:</span> <span class="token string">&#39;app3@xxxx&#39;</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">exposes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;./Button&#39;</span><span class="token operator">:</span> <span class="token string">&#39;./src/Button&#39;</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;react&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token keyword">import</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">singleton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">requiredVersion</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">strictVersion</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">shareScope</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">packageName</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">sharedKey</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">eager</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">shareScope</span><span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="name" tabindex="-1"><a class="header-anchor" href="#name" aria-hidden="true">#</a> name</h3><p>\u5F53\u524D\u5E94\u7528\u7684\u522B\u540D</p><h3 id="filename" tabindex="-1"><a class="header-anchor" href="#filename" aria-hidden="true">#</a> <strong>filename</strong></h3><p>\u5165\u53E3\u6587\u4EF6\u540D\uFF0C remote \u5E94\u7528\u4F9B host \u5E94\u7528\u6D88\u8D39\u65F6\uFF0Cremote \u5E94\u7528\u63D0\u4F9B\u7684\u8FDC\u7A0B\u6587\u4EF6\u7684\u6587\u4EF6\u540D\u3002</p><h3 id="exposes" tabindex="-1"><a class="header-anchor" href="#exposes" aria-hidden="true">#</a> <strong>exposes</strong></h3><p>remote \u5E94\u7528\u88AB host \u5E94\u7528\u6D88\u8D39\u65F6\uFF0C\u6709\u54EA\u4E9B\u8F93\u51FA\u5185\u5BB9\u53EF\u4EE5\u88AB host \u5E94\u7528\u4F7F\u7528\u3002</p><p><code>exposes</code> \u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C <code>key</code> \u4E3A\u8F93\u51FA\u5185\u5BB9\u5728 host \u5E94\u7528\u4E2D\u7684\u76F8\u5BF9\u8DEF\u5F84\uFF0C<code>value</code> \u4E3A\u8F93\u51FA\u5185\u5BB9\u7684\u5728\u5F53\u524D\u5E94\u7528\u7684\u76F8\u5BF9\u8DEF\u5F84(\u4E5F\u53EF\u4EE5\u662F\u7EDD\u5BF9\u8DEF\u5F84)</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token operator">...</span>
    <span class="token literal-property property">exposes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    	<span class="token string-property property">&#39;./Button&#39;</span><span class="token operator">:</span> <span class="token string">&#39;../src/component/Button&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\uFF1A\u5982\u679C\u6211\u4EEC\u5728 host \u5E94\u7528\u4E2D\u662F <code>import(&#39;app2/Button&#39;)</code>, \u90A3\u4E48 <code>exposes</code> \u4E2D\u7684 <code>key</code> \u5FC5\u987B\u4E3A <code>&#39;./Button&#39;</code>; \u5982\u679C\u662F <code>import(&#39;app2/shared/Button&#39;)</code>\uFF0C \u90A3\u4E48 <code>exposes</code> \u4E2D\u7684 <code>key</code> \u5FC5\u987B\u4E3A <code>&#39;./shared/Button&#39;</code>.</p><h3 id="library" tabindex="-1"><a class="header-anchor" href="#library" aria-hidden="true">#</a> <strong>library</strong></h3><p><code>library</code> \u5B9A\u4E49\u4E86 remote \u5E94\u7528\u5982\u4F55\u5C06\u8F93\u51FA\u5185\u5BB9\u66B4\u9732\u7ED9 host \u5E94\u7528\u3002</p><p>\u914D\u7F6E\u9879\u7684\u503C\u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u5982 <code>{ type: &#39;xxx&#39;, name: &#39;xxx&#39;}</code>\u3002</p><p>\u5176\u4E2D\uFF0C<code>name</code>\uFF0C\u66B4\u9732\u7ED9\u5916\u90E8\u5E94\u7528\u7684\u53D8\u91CF\u540D\uFF1B <code>type</code>\uFF0C\u66B4\u9732\u53D8\u91CF\u7684\u65B9\u5F0F\u3002</p><p><code>type</code> \u7684\u503C\uFF0C\u548C <code>output.libraryTarget</code> \u7684\u503C\u7C7B\u4F3C:</p><ul><li><p>var: remote \u7684\u8F93\u51FA\u5185\u5BB9\u5206\u914D\u7ED9\u4E00\u4E2A\u901A\u8FC7 var \u5B9A\u4E49\u7684\u53D8\u91CF</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> app2<span class="token punctuation">;</span> app2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">return</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>assign: remote \u7684\u8F93\u51FA\u5185\u5BB9\u5206\u914D\u7ED9\u4E00\u4E2A\u4E0D\u901A\u8FC7 var \u5B9A\u4E49\u7684\u53D8\u91CF\uFF1B</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>app2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">return</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>this: remote \u7684\u8F93\u51FA\u5185\u5BB9\u4F5C\u4E3A\u5F53\u524D\u4E0A\u4E0B\u6587 <code>this</code> \u7684\u4E00\u4E2A\u5C5E\u6027\uFF0C\u5C5E\u6027\u540D\u4E3A <code>name</code> \u5BF9\u5E94\u7684\u503C</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">[</span><span class="token string">&quot;app2&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">return</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>window: remote \u7684\u8F93\u51FA\u5185\u5BB9\u4F5C\u4E3A window \u5BF9\u8C61\u7684\u4E00\u4E2A\u5C5E\u6027\uFF0C\u5C5E\u6027\u540D\u4E3A name \u5BF9\u5E94\u7684\u503C</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code> window<span class="token punctuation">[</span><span class="token string">&quot;app2&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">return</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>self: remote \u7684\u8F93\u51FA\u5185\u5BB9\u4F5C\u4E3A self \u5BF9\u8C61\u7684\u4E00\u4E2A\u5C5E\u6027\uFF0C\u5C5E\u6027\u540D\u4E3A name \u5BF9\u5E94\u7684\u503C\uFF1B</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>self<span class="token punctuation">[</span><span class="token string">&quot;app2&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">return</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>commonjs2: remote \u7684\u8F93\u51FA\u5185\u5BB9\u4F5C\u4E3A module.exports \u7684\u4E00\u4E2A \u5C5E\u6027\uFF0C\u5C5E\u6027\u540D\u4E3A name \u5BF9\u5E94\u7684\u503C\uFF1B</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token punctuation">[</span><span class="token string">&quot;app2&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">return</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>amd: remoteEntry.js \u7B26\u5408 AMD \u89C4\u8303</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;app2&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>umd: remoteEntry.js \u7B26\u5408 UMD \u89C4\u8303\uFF1B</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> module <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span>
         module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span>
         <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span>
         exports<span class="token punctuation">[</span><span class="token string">&quot;app2&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">else</span>
         root<span class="token punctuation">[</span><span class="token string">&quot;app2&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
 <span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>jsonp: \u5C06 remote \u7684\u8F93\u51FA\u5185\u5BB9\u5305\u88F9\u5230\u4E00\u4E2A jsonp \u5305\u88C5\u5BB9\u5668\u4E2D;</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">app2</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>system: remoteEntry.js \u7B26\u5408 Systemjs \u89C4\u8303</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>System<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&quot;app2&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">__WEBPACK_DYNAMIC_EXPORT__<span class="token punctuation">,</span> __system_context__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">execute</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	    <span class="token function">__WEBPACK_DYNAMIC_EXPORT__</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="remotes" tabindex="-1"><a class="header-anchor" href="#remotes" aria-hidden="true">#</a> <strong>remotes</strong></h3><p>\u88AB\u5F53\u524D host \u5E94\u7528\u6D88\u8D39\u7684 remote \u5E94\u7528\u3002</p><p>remotes \u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0Ckey \u503C\u662F\u4E00\u4E2A\u8981\u6D88\u8D39\u7684\u5E94\u7528\u7684\u522B\u540D\u3002\u5982\u679C\u6211\u4EEC\u5728\u8981 host \u5E94\u7528\u4E2D\u4F7F\u7528 remote \u5E94\u7528\u7684 button \u7EC4\u4EF6\u65F6\uFF0C\u6211\u4EEC\u7684\u4EE3\u7801\u5982\u4E0B:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> RemoteButton <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span>&#39;app2<span class="token operator">/</span>button<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5176\u4E2D\uFF0C <code>import url</code> \u4E2D\u7684 app2 \u5BF9\u5E94 remotes \u914D\u7F6E\u9879\u4E2D\u7684 <code>key</code> \u503C\u3002</p><p><code>value</code> \u4E3A remote \u5E94\u7528\u7684\u5BF9\u5916\u8F93\u51FA\u53CAurl\uFF0C\u683C\u5F0F\u5FC5\u987B\u4E25\u683C\u9075\u5FAA: <code>obj@url</code>\u3002\u5176\u4E2D\uFF0C obj \u5BF9\u5E94 remote \u5E94\u7528\u4E2D <code>library</code> \u4E2D\u7684 <code>name</code> \u914D\u7F6E\u9879\uFF0C <code>url</code> \u5BF9\u5E94 remote \u5E94\u7528\u4E2D remoteEnter \u6587\u4EF6\u7684\u94FE\u63A5</p><h3 id="shared" tabindex="-1"><a class="header-anchor" href="#shared" aria-hidden="true">#</a> <strong>shared</strong></h3><p><code>shared</code> \u914D\u7F6E\u9879\u6307\u793A <code>remote</code> \u5E94\u7528\u7684\u8F93\u51FA\u5185\u5BB9\u548C <code>host</code> \u5E94\u7528\u53EF\u4EE5\u5171\u7528\u54EA\u4E9B\u4F9D\u8D56\u3002 <code>shared</code> \u8981\u60F3\u751F\u6548\uFF0C\u5219 <code>host</code> \u5E94\u7528\u548C <code>remote</code> \u5E94\u7528\u7684 <code>shared</code> \u914D\u7F6E\u7684\u4F9D\u8D56\u8981\u4E00\u81F4</p><ul><li><p>import</p><p>\u5171\u4EAB\u4F9D\u8D56\u7684\u5B9E\u9645\u7684 <code>package name</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	<span class="token operator">...</span><span class="token punctuation">,</span>
    <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    	<span class="token string-property property">&#39;react-shared&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token keyword">import</span><span class="token operator">:</span> <span class="token string">&#39;react&#39;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u672A\u6307\u5B9A\uFF0C\u9ED8\u8BA4\u4E3A\u7528\u6237\u81EA\u5B9A\u4E49\u7684\u5171\u4EAB\u4F9D\u8D56\u540D\uFF0C\u5373 <code>react-shared</code>\u3002\u5982\u679C\u662F\u8FD9\u6837\u7684\u8BDD\uFF0Cwebpack \u6253\u5305\u662F\u4F1A\u629B\u51FA\u5F02\u5E38\u7684\uFF0C\u56E0\u4E3A\u5B9E\u9645\u4E0A\u5E76\u6CA1\u6709 <code>react-shared</code> \u8FD9\u4E2A\u5305</p></li><li><p>singleton</p><p>\u662F\u5426\u5F00\u542F\u5355\u4F8B\u6A21\u5F0F\u3002\u5982\u679C\u503C\u4E3A <code>true</code>\uFF0C\u5F00\u542F\u5355\u4F8B\u6A21\u5F0F\uFF1B\u503C\u4E3A <code>false</code>\uFF0C\u4E0D\u5F00\u542F\u5355\u4F8B\u6A21\u5F0F\u3002\u9ED8\u8BA4\u503C\u4E3A <code>false</code>\uFF0C\u5373\u4E0D\u5F00\u5355\u4F8B\u6A21\u5F0F</p><p>\u5982\u4F55\u542F\u7528\u5355\u4F8B\u6A21\u5F0F\uFF0C\u90A3\u4E48 <code>remote</code> \u5E94\u7528\u7EC4\u4EF6\u548C <code>host</code> \u5E94\u7528\u5171\u4EAB\u7684\u4F9D\u8D56\u53EA\u52A0\u8F7D\u4E00\u6B21\uFF0C\u4E14\u4E0E\u7248\u672C\u65E0\u5173\u3002 \u5982\u679C\u7248\u672C\u4E0D\u4E00\u81F4\uFF0C\u4F1A\u7ED9\u51FA\u8B66\u544A</p><p>\u52A0\u8F7D\u7684\u4F9D\u8D56\u7684\u7248\u672C\u4E3A <code>remote</code> \u5E94\u7528\u548C <code>host</code> \u5E94\u7528\u4E2D\uFF0C\u7248\u672C\u6BD4\u8F83\u9AD8\u7684\u3002</p><p>\u4E0D\u5F00\u542F\u5355\u4F8B\u6A21\u5F0F\u4E0B\uFF0C\u5982\u679C <code>remote</code> \u5E94\u7528\u548C <code>host</code> \u5E94\u7528\u5171\u4EAB\u4F9D\u8D56\u7684\u7248\u672C\u4E0D\u4E00\u81F4\uFF0C<code>remote</code> \u5E94\u7528\u548C <code>host</code> \u5E94\u7528\u9700\u8981\u5206\u522B\u5404\u81EA\u52A0\u8F7D\u4F9D\u8D56</p></li><li><p>requiredVersion</p><p>\u6307\u5B9A\u5171\u4EAB\u4F9D\u8D56\u7684\u7248\u672C\uFF0C\u9ED8\u8BA4\u503C\u4E3A\u5F53\u524D\u5E94\u7528\u7684\u4F9D\u8D56\u7248\u672C\u3002</p><p>\u5982\u679C <code>requiredVersion</code> \u4E0E\u5B9E\u9645\u5E94\u7528\u7684\u4F9D\u8D56\u7684\u7248\u672C\u4E0D\u4E00\u81F4\uFF0C\u4F1A\u7ED9\u51FA\u8B66\u544A</p></li><li><p>strictVersion</p><p>\u662F\u5426\u9700\u8981\u4E25\u683C\u7684\u7248\u672C\u63A7\u5236</p><p>\u5355\u4F8B\u6A21\u5F0F\u4E0B\uFF0C\u5982\u679C <code>strictVersion</code> \u4E0E\u5B9E\u9645\u5E94\u7528\u7684\u4F9D\u8D56\u7684\u7248\u672C\u4E0D\u4E00\u81F4\uFF0C\u4F1A\u629B\u51FA\u5F02\u5E38</p><p>\u9ED8\u8BA4\u503C\u4E3A <code>false</code></p></li><li><p>shareKey\uFF1A\u5171\u4EAB\u4F9D\u8D56\u7684\u522B\u540D, \u9ED8\u8BA4\u503C\u4E3A <code>shared</code> \u914D\u7F6E\u9879\u7684 <code>key</code> \u503C</p></li><li><p>shareScope\uFF1A \u5F53\u524D\u5171\u4EAB\u4F9D\u8D56\u7684\u4F5C\u7528\u57DF\u540D\u79F0\uFF0C\u9ED8\u8BA4\u4E3A default\uFF0C\u4E4B\u524D\u7C9F\u5B50\u6709\u770B\u5230 <code>__webpack_require__.S</code> \u7684\u7ED3\u6784\u4E3A\uFF1A</p><p><img src="`+e+'" alt=""></p></li><li><p>eager:</p><p>\u5171\u4EAB\u4F9D\u8D56\u5728\u6253\u5305\u8FC7\u7A0B\u4E2D\u662F\u5426\u88AB\u5206\u79BB\u4E3A <code>async chunk</code>\u3002</p><p><code>eager</code> \u4E3A <code>false</code>\uFF0C \u5171\u4EAB\u4F9D\u8D56\u88AB\u5355\u72EC\u5206\u79BB\u4E3A <code>async chunk</code>\uFF1B <code>eager</code> \u4E3A <code>true</code>\uFF0C \u5171\u4EAB\u4F9D\u8D56\u4F1A\u6253\u5305\u5230 <code>main</code>\u3001<code>remoteEntry</code>\uFF0C\u4E0D\u4F1A\u88AB\u5206\u79BB\u3002</p><p>\u9ED8\u8BA4\u503C\u4E3A <code>false</code>\uFF0C\u5982\u679C\u8BBE\u7F6E\u4E3A <code>true</code>\uFF0C \u5171\u4EAB\u4F9D\u8D56\u5176\u5B9E\u662F\u6CA1\u6709\u610F\u4E49\u7684</p></li></ul><h3 id="sharescope" tabindex="-1"><a class="header-anchor" href="#sharescope" aria-hidden="true">#</a> <strong>shareScope</strong></h3><p>\u6240\u7528\u5171\u4EAB\u4F9D\u8D56\u7684\u4F5C\u7528\u57DF\u540D\u79F0\uFF0C\u9ED8\u8BA4\u4E3A <code>default</code>\u3002`</p><p>\u5982\u679C <code>shareScope</code> \u548C <code>share[&quot;xxx&quot;].shareScope</code> \u540C\u65F6\u5B58\u5728\uFF0C<code>share[&quot;xxx&quot;].shareScope</code> \u7684\u4F18\u5148\u7EA7\u66F4\u9AD8</p><h2 id="q-a" tabindex="-1"><a class="header-anchor" href="#q-a" aria-hidden="true">#</a> Q&amp;A</h2><h3 id="\u4E3A\u4EC0\u4E48-index-js-\u4E2D\u9700\u8981\u4EE5-import-\u7684\u65B9\u5F0F\u5F15\u5165-bootstrap-js" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48-index-js-\u4E2D\u9700\u8981\u4EE5-import-\u7684\u65B9\u5F0F\u5F15\u5165-bootstrap-js" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48 index.js \u4E2D\u9700\u8981\u4EE5 import() \u7684\u65B9\u5F0F\u5F15\u5165 bootstrap.js \uFF1F</h3><p>\u5728\u67E5\u770B module federation \u4F8B\u5B50\u7684\u65F6\u5019\uFF0C\u793A\u4F8B\u4E2D <code>index.js</code> \u4E2D\u4F7F\u7528 <code>import()</code> \u65B9\u6CD5\u5F15\u5165 <code>bootstrap.js</code> \uFF0C\u5982\u679C\u628A <code>bootstrap.js</code> \u4E2D\u7684\u5185\u5BB9\uFF0C\u76F4\u63A5\u7C98\u8D34\u5230 <code>index.js</code> \u4E2D\u3002\u542F\u52A8\u5C31\u4F1A\u62A5\u9519</p><p>\u539F\u56E0\u5728\u4E8E\u4F7F\u7528 <code>module federation</code> \u4EE5\u540E\uFF0C<code>react</code> \u4F1A\u4F5C\u4E3A\u5F02\u6B65\u6A21\u5757\uFF0C\u5728 <code>app1</code> \u7684 <code>main.js</code>\u3001<code>app2</code> \u7684 <code>remote.js</code> \u5B8C\u6210\u52A0\u8F7D\u5E76\u4E14\u521D\u59CB\u5316 <code>sharedScope</code> \u4EE5\u540E\uFF0C\u624D\u4F1A\u52A0\u8F7D\u5E76\u8FD0\u884C\u5BF9\u5E94\u7684\u6267\u884C\u65B9\u6CD5\u3002</p><p><strong>\u6240\u4EE5\u8FD9\u5E26\u6765\u601D\u8003\uFF1A\u5F02\u6B65\u540E\u9875\u9762\u7684\u52A0\u8F7D\u4E0D\u5C31\u53D8\u957F\u4E86\uFF1F</strong></p><h3 id="module-federation-\u662F\u5426\u53EF\u4EE5\u505A\u5230\u4E0E\u6280\u672F\u6808\u65E0\u5173" tabindex="-1"><a class="header-anchor" href="#module-federation-\u662F\u5426\u53EF\u4EE5\u505A\u5230\u4E0E\u6280\u672F\u6808\u65E0\u5173" aria-hidden="true">#</a> module federation \u662F\u5426\u53EF\u4EE5\u505A\u5230\u4E0E\u6280\u672F\u6808\u65E0\u5173\uFF1F</h3><p>\u7B54\u6848\u662F\u53EF\u4EE5\u7684\u3002</p><p>\u5047\u8BBE\u4E24\u4E2A\u5E94\u7528\uFF0C host \u5E94\u7528\u4F7F\u7528 react \u6280\u672F\u6808\uFF0C remote \u5E94\u7528\u4F7F\u7528 vue \u6280\u672F\u6808\uFF0Chost \u5E94\u7528\u5728\u4F7F\u7528 remote \u5E94\u7528\u63D0\u4F9B\u7684\u7EC4\u4EF6\u65F6\uFF0C\u4E0D\u80FD\u76F4\u63A5\u4F7F\u7528\uFF0C\u9700\u8981\u989D\u5916\u6267\u884C vue.mount(&#39;#xxx&#39;) \u65B9\u6CD5\uFF0C\u5C06 remote \u7EC4\u4EF6\u6302\u8F7D\u7684\u6307\u5B9A\u4F4D\u7F6E</p><h3 id="\u5171\u4EAB\u4F9D\u8D56\u7684\u7248\u672C\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#\u5171\u4EAB\u4F9D\u8D56\u7684\u7248\u672C\u63A7\u5236" aria-hidden="true">#</a> \u5171\u4EAB\u4F9D\u8D56\u7684\u7248\u672C\u63A7\u5236</h3><p>module federation \u5728\u521D\u59CB\u5316 <code>shareScope</code> \u65F6\uFF0C\u4F1A\u6BD4\u8F83 <code>host</code> \u5E94\u7528\u548C <code>remote</code> \u5E94\u7528\u4E4B\u95F4\u5171\u4EAB\u4F9D\u8D56\u7684\u7248\u672C\uFF0C\u5C06 <code>shareScope</code> \u4E2D\u5171\u4EAB\u4F9D\u8D56\u7684\u7248\u672C\u66F4\u65B0\u4E3A\u8F83\u9AD8\u7248\u672C\u3002</p><p>\u5728\u52A0\u8F7D\u5171\u4EAB\u4F9D\u8D56\u65F6\uFF0C\u5982\u679C\u53D1\u73B0\u5B9E\u9645\u9700\u8981\u7684\u7248\u672C\u548C <code>shareScope</code> \u4E2D\u5171\u4EAB\u4F9D\u8D56\u7684\u7248\u672C\u4E0D\u4E00\u81F4\u65F6\uFF0C\u4F1A\u6839\u636E <code>share</code> \u914D\u7F6E\u9879\u7684\u4E0D\u540C\u505A\u76F8\u5E94\u5904\u7406\uFF1A</p><ul><li><p>\u5982\u679C\u914D\u7F6E <code>singleton</code> \u4E3A <code>ture</code>\uFF0C\u5B9E\u9645\u4F7F\u7528 <code>shareScope</code> \u4E2D\u7684\u5171\u4EAB\u4F9D\u8D56\uFF0C\u63A7\u5236\u53F0\u4F1A\u6253\u5370\u7248\u672C\u4E0D\u4E00\u81F4\u8B66\u544A</p></li><li><p>\u5982\u679C\u914D\u7F6E <code>singleton</code> \u4E3A <code>ture</code>\uFF0C\u4E14 <code>strictVersion</code> \u4E3A <code>ture</code>\uFF0C\u5373\u9700\u8981\u4FDD\u8BC1\u7248\u672C\u5FC5\u987B\u4E00\u81F4\uFF0C\u4F1A\u629B\u51FA\u5F02\u5E38</p></li><li><p>\u5982\u679C\u914D\u7F6E <code>singleton</code> \u4E3A <code>false</code>\uFF0C\u90A3\u4E48\u5E94\u7528\u4E0D\u4F1A\u4F7F\u7528 <code>shareScope</code> \u4E2D\u7684\u5171\u4EAB\u4F9D\u8D56\uFF0C\u800C\u662F\u52A0\u8F7D\u5E94\u7528\u81EA\u5DF1\u7684\u4F9D\u8D56</p></li></ul><p>\u7EFC\u4E0A\uFF0C\u5982\u679C host \u5E94\u7528\u548C remote \u5E94\u7528\u5171\u4EAB\u4F9D\u8D56\u7684\u7248\u672C\u53EF\u4EE5\u517C\u5BB9\uFF0C\u53EF\u5C06 <code>singleton</code> \u914D\u7F6E\u4E3A <code>ture</code>\uFF1B\u5982\u679C\u5171\u4EAB\u4F9D\u8D56\u7248\u672C\u4E0D\u517C\u5BB9\uFF0C\u9700\u8981\u5C06 <code>singleton</code> \u914D\u7F6E\u4E3A <code>false</code></p><h3 id="\u591A\u4E2A\u5E94\u7528-\u8D85\u8FC7-2-\u4E2A-\u662F\u5426\u53EF\u5171\u7528\u4E00\u4E2A-sharescope" tabindex="-1"><a class="header-anchor" href="#\u591A\u4E2A\u5E94\u7528-\u8D85\u8FC7-2-\u4E2A-\u662F\u5426\u53EF\u5171\u7528\u4E00\u4E2A-sharescope" aria-hidden="true">#</a> \u591A\u4E2A\u5E94\u7528(\u8D85\u8FC7 2 \u4E2A) \u662F\u5426\u53EF\u5171\u7528\u4E00\u4E2A shareScope \uFF1F</h3><p>\u5047\u8BBE\u6709\u8FD9\u4E48\u4E00\u4E2A\u573A\u666F\uFF0C \u4E09\u4E2A\u5E94\u7528 - app1\u3001app2\u3001app3\uFF0C app2 \u662F app1 \u7684 remote \u5E94\u7528\uFF0C app3 \u662F app2 \u7684 remote \u5E94\u7528\uFF0C \u90A3\u4E48\u4ED6\u4EEC\u662F\u5426\u53EF\u5171\u7528\u4E00\u4E2A shareScope \uFF1F</p><p>\u7B54\u6848\u662F\u80AF\u5B9A\u7684\u3002</p><p>\u4F7F\u7528 module federation \u529F\u80FD\u4EE5\u540E\uFF0C\u6240\u6709\u5EFA\u7ACB\u8054\u7CFB\u7684\u5E94\u7528\uFF0C\u5171\u7528\u4E00\u4E2A shareScope</p><h3 id="\u591A\u4E2A\u5E94\u7528\u914D\u7F6E\u76F8\u540C\u7684-sharescope-\u6700\u7EC8\u4F7F\u7528\u54EA\u4E2A" tabindex="-1"><a class="header-anchor" href="#\u591A\u4E2A\u5E94\u7528\u914D\u7F6E\u76F8\u540C\u7684-sharescope-\u6700\u7EC8\u4F7F\u7528\u54EA\u4E2A" aria-hidden="true">#</a> \u591A\u4E2A\u5E94\u7528\u914D\u7F6E\u76F8\u540C\u7684 shareScope\uFF0C\u6700\u7EC8\u4F7F\u7528\u54EA\u4E2A\uFF1F</h3><h2 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h2><ul><li><p>\u4F7F\u7528 module federation\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5728\u4E00\u4E2A\u5E94\u7528\u4E2D\u52A8\u6001\u52A0\u8F7D\u5E76\u6267\u884C\u53E6\u4E00\u4E2A\u5E94\u7528\u7684\u4EE3\u7801\uFF0C\u4E14\u4E0E\u6280\u672F\u6808\u65E0\u5173\uFF1B</p></li><li><p>\u901A\u8FC7 module federation \u5EFA\u7ACB\u8FDE\u63A5\u7684\u5E94\u7528\uFF0C\u5171\u4EAB\u540C\u4E00\u4E2A <code>shareScope</code>\uFF0C\u53EF\u5B9E\u73B0\u4F9D\u8D56\u5171\u4EAB\uFF1B</p></li><li><p>host \u5E94\u7528\u7684\u5165\u53E3\u6587\u4EF6\uFF0C\u5FC5\u987B\u4F7F\u7528 <code>import()</code> \u7684\u65B9\u5F0F\uFF0C\u5426\u5219\u4F1A\u62A5\u9519\uFF1B</p></li><li><p>\u4F7F\u7528 module federation \u9700\u8981\u57FA\u4E8E webpack5</p></li></ul>',94),P={href:"https://www.qiyuandi.com/zhanzhang/zonghe/12450.html",target:"_blank",rel:"noopener noreferrer"},F=s("module federation \u6DF1\u5165\u4E86\u89E3");function N(V,T){const p=t("ExternalLinkIcon"),c=t("RouterLink");return i(),l("div",null,[d,n("p",null,[n("a",v,[m,a(p)]),_,b,g]),y,h,n("p",null,[f,a(c,{to:"/Node/Webpack/%E5%8E%9F%E7%90%86/code-split.html"},{default:r(()=>[w]),_:1}),q]),x,n("p",null,[j,n("a",S,[E,a(p)])]),M,n("blockquote",null,[n("p",null,[n("a",P,[F,a(p)])])])])}var B=u(k,[["render",N],["__file","ModuleFederation.html.vue"]]);export{B as default};
