<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>code-split | Hello Wold</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/lanjz/assets/css/0.styles.5dda244b.css" as="style"><link rel="preload" href="/lanjz/assets/js/app.e889b93f.js" as="script"><link rel="preload" href="/lanjz/assets/js/2.30c9612b.js" as="script"><link rel="preload" href="/lanjz/assets/js/123.204284e3.js" as="script"><link rel="prefetch" href="/lanjz/assets/js/10.de9ac23f.js"><link rel="prefetch" href="/lanjz/assets/js/100.4e35f4c5.js"><link rel="prefetch" href="/lanjz/assets/js/101.45b4796b.js"><link rel="prefetch" href="/lanjz/assets/js/102.854f637b.js"><link rel="prefetch" href="/lanjz/assets/js/103.fd5f5d88.js"><link rel="prefetch" href="/lanjz/assets/js/104.50ad4313.js"><link rel="prefetch" href="/lanjz/assets/js/105.ab0e47b2.js"><link rel="prefetch" href="/lanjz/assets/js/106.352324cb.js"><link rel="prefetch" href="/lanjz/assets/js/107.9f934f47.js"><link rel="prefetch" href="/lanjz/assets/js/108.bb58a6e5.js"><link rel="prefetch" href="/lanjz/assets/js/109.4c727ab4.js"><link rel="prefetch" href="/lanjz/assets/js/11.66afd1fc.js"><link rel="prefetch" href="/lanjz/assets/js/110.6b28b6b0.js"><link rel="prefetch" href="/lanjz/assets/js/111.e2bab1b2.js"><link rel="prefetch" href="/lanjz/assets/js/112.24aa2c03.js"><link rel="prefetch" href="/lanjz/assets/js/113.7b1c20a1.js"><link rel="prefetch" href="/lanjz/assets/js/114.4d1b08c8.js"><link rel="prefetch" href="/lanjz/assets/js/115.41664515.js"><link rel="prefetch" href="/lanjz/assets/js/116.ab71433d.js"><link rel="prefetch" href="/lanjz/assets/js/117.a80fa270.js"><link rel="prefetch" href="/lanjz/assets/js/118.f616dbb2.js"><link rel="prefetch" href="/lanjz/assets/js/119.c8294f2a.js"><link rel="prefetch" href="/lanjz/assets/js/12.c696265c.js"><link rel="prefetch" href="/lanjz/assets/js/120.8510540d.js"><link rel="prefetch" href="/lanjz/assets/js/121.6adf5de5.js"><link rel="prefetch" href="/lanjz/assets/js/122.0d6fd647.js"><link rel="prefetch" href="/lanjz/assets/js/124.ef4ab1cc.js"><link rel="prefetch" href="/lanjz/assets/js/125.d67cec13.js"><link rel="prefetch" href="/lanjz/assets/js/126.da5b6391.js"><link rel="prefetch" href="/lanjz/assets/js/127.1782a99e.js"><link rel="prefetch" href="/lanjz/assets/js/128.b1463c11.js"><link rel="prefetch" href="/lanjz/assets/js/129.a7cdd87b.js"><link rel="prefetch" href="/lanjz/assets/js/13.a85b29b2.js"><link rel="prefetch" href="/lanjz/assets/js/130.f2701c67.js"><link rel="prefetch" href="/lanjz/assets/js/131.041a4f25.js"><link rel="prefetch" href="/lanjz/assets/js/132.1e7eebfa.js"><link rel="prefetch" href="/lanjz/assets/js/133.04f64393.js"><link rel="prefetch" href="/lanjz/assets/js/134.b066bba7.js"><link rel="prefetch" href="/lanjz/assets/js/135.07343f16.js"><link rel="prefetch" href="/lanjz/assets/js/136.020992e4.js"><link rel="prefetch" href="/lanjz/assets/js/137.e4715b43.js"><link rel="prefetch" href="/lanjz/assets/js/138.6dd18765.js"><link rel="prefetch" href="/lanjz/assets/js/139.e02d6a63.js"><link rel="prefetch" href="/lanjz/assets/js/14.bce51efb.js"><link rel="prefetch" href="/lanjz/assets/js/140.463a33bc.js"><link rel="prefetch" href="/lanjz/assets/js/141.923c043b.js"><link rel="prefetch" href="/lanjz/assets/js/142.c9840a6f.js"><link rel="prefetch" href="/lanjz/assets/js/143.6b8161c6.js"><link rel="prefetch" href="/lanjz/assets/js/144.f292864d.js"><link rel="prefetch" href="/lanjz/assets/js/145.19e85b7a.js"><link rel="prefetch" href="/lanjz/assets/js/146.0d476036.js"><link rel="prefetch" href="/lanjz/assets/js/147.c39b62e4.js"><link rel="prefetch" href="/lanjz/assets/js/148.1371a22e.js"><link rel="prefetch" href="/lanjz/assets/js/149.47f6b421.js"><link rel="prefetch" href="/lanjz/assets/js/15.301639fa.js"><link rel="prefetch" href="/lanjz/assets/js/150.b2b49eb8.js"><link rel="prefetch" href="/lanjz/assets/js/151.4c7f1864.js"><link rel="prefetch" href="/lanjz/assets/js/152.c24428c3.js"><link rel="prefetch" href="/lanjz/assets/js/153.d6b7ec7d.js"><link rel="prefetch" href="/lanjz/assets/js/154.0bd6db87.js"><link rel="prefetch" href="/lanjz/assets/js/155.d89860ba.js"><link rel="prefetch" href="/lanjz/assets/js/156.9e36aa2c.js"><link rel="prefetch" href="/lanjz/assets/js/157.1cf120b5.js"><link rel="prefetch" href="/lanjz/assets/js/158.386a3a1b.js"><link rel="prefetch" href="/lanjz/assets/js/159.e81e6f99.js"><link rel="prefetch" href="/lanjz/assets/js/16.f4cfeed1.js"><link rel="prefetch" href="/lanjz/assets/js/160.c079f1d4.js"><link rel="prefetch" href="/lanjz/assets/js/161.63b717c5.js"><link rel="prefetch" href="/lanjz/assets/js/162.ee79ad24.js"><link rel="prefetch" href="/lanjz/assets/js/163.0f169c91.js"><link rel="prefetch" href="/lanjz/assets/js/164.9afb2729.js"><link rel="prefetch" href="/lanjz/assets/js/165.97d334bc.js"><link rel="prefetch" href="/lanjz/assets/js/166.f39fe304.js"><link rel="prefetch" href="/lanjz/assets/js/167.164420f7.js"><link rel="prefetch" href="/lanjz/assets/js/168.12f46eca.js"><link rel="prefetch" href="/lanjz/assets/js/169.437a8dfa.js"><link rel="prefetch" href="/lanjz/assets/js/17.a4b3436c.js"><link rel="prefetch" href="/lanjz/assets/js/170.da9d8fce.js"><link rel="prefetch" href="/lanjz/assets/js/171.79f81edf.js"><link rel="prefetch" href="/lanjz/assets/js/172.a82dcf80.js"><link rel="prefetch" href="/lanjz/assets/js/173.4f01600b.js"><link rel="prefetch" href="/lanjz/assets/js/174.f06577e8.js"><link rel="prefetch" href="/lanjz/assets/js/175.82a1be2a.js"><link rel="prefetch" href="/lanjz/assets/js/176.8a814f9a.js"><link rel="prefetch" href="/lanjz/assets/js/177.82929e79.js"><link rel="prefetch" href="/lanjz/assets/js/178.7eb42f3f.js"><link rel="prefetch" href="/lanjz/assets/js/179.e67d78c9.js"><link rel="prefetch" href="/lanjz/assets/js/18.0f9bab3d.js"><link rel="prefetch" href="/lanjz/assets/js/180.8904c601.js"><link rel="prefetch" href="/lanjz/assets/js/181.8767416c.js"><link rel="prefetch" href="/lanjz/assets/js/182.1ccf1e4c.js"><link rel="prefetch" href="/lanjz/assets/js/183.fb1660fa.js"><link rel="prefetch" href="/lanjz/assets/js/184.cca16cf5.js"><link rel="prefetch" href="/lanjz/assets/js/185.41d279d6.js"><link rel="prefetch" href="/lanjz/assets/js/186.d1d2cbe1.js"><link rel="prefetch" href="/lanjz/assets/js/187.7c0a6fbd.js"><link rel="prefetch" href="/lanjz/assets/js/188.7a9c15dc.js"><link rel="prefetch" href="/lanjz/assets/js/189.8735963e.js"><link rel="prefetch" href="/lanjz/assets/js/19.1b26e5ec.js"><link rel="prefetch" href="/lanjz/assets/js/190.ded7237d.js"><link rel="prefetch" href="/lanjz/assets/js/191.c6825143.js"><link rel="prefetch" href="/lanjz/assets/js/192.36f885f8.js"><link rel="prefetch" href="/lanjz/assets/js/193.434e54b1.js"><link rel="prefetch" href="/lanjz/assets/js/194.d2736de9.js"><link rel="prefetch" href="/lanjz/assets/js/195.f1e4cee3.js"><link rel="prefetch" href="/lanjz/assets/js/196.c9d242b9.js"><link rel="prefetch" href="/lanjz/assets/js/197.90a70dd8.js"><link rel="prefetch" href="/lanjz/assets/js/198.986fa9e5.js"><link rel="prefetch" href="/lanjz/assets/js/199.f6e8cd62.js"><link rel="prefetch" href="/lanjz/assets/js/20.2996c893.js"><link rel="prefetch" href="/lanjz/assets/js/200.2b2d2eff.js"><link rel="prefetch" href="/lanjz/assets/js/201.90f9d9e7.js"><link rel="prefetch" href="/lanjz/assets/js/202.781e775e.js"><link rel="prefetch" href="/lanjz/assets/js/203.4f7b9381.js"><link rel="prefetch" href="/lanjz/assets/js/204.14d1415d.js"><link rel="prefetch" href="/lanjz/assets/js/205.a8ef77d5.js"><link rel="prefetch" href="/lanjz/assets/js/206.cecdcb0d.js"><link rel="prefetch" href="/lanjz/assets/js/207.30009dab.js"><link rel="prefetch" href="/lanjz/assets/js/208.a9e5c013.js"><link rel="prefetch" href="/lanjz/assets/js/209.ba850d54.js"><link rel="prefetch" href="/lanjz/assets/js/21.1fb96bb1.js"><link rel="prefetch" href="/lanjz/assets/js/210.9f99d6de.js"><link rel="prefetch" href="/lanjz/assets/js/211.74f6aef4.js"><link rel="prefetch" href="/lanjz/assets/js/212.c03ef1e5.js"><link rel="prefetch" href="/lanjz/assets/js/22.29edc1d3.js"><link rel="prefetch" href="/lanjz/assets/js/23.9064ebc5.js"><link rel="prefetch" href="/lanjz/assets/js/24.bd632e3d.js"><link rel="prefetch" href="/lanjz/assets/js/25.11a57cef.js"><link rel="prefetch" href="/lanjz/assets/js/26.3b1c9fc0.js"><link rel="prefetch" href="/lanjz/assets/js/27.0b74e252.js"><link rel="prefetch" href="/lanjz/assets/js/28.ce356e2f.js"><link rel="prefetch" href="/lanjz/assets/js/29.809ea4a5.js"><link rel="prefetch" href="/lanjz/assets/js/3.f58818d1.js"><link rel="prefetch" href="/lanjz/assets/js/30.0c7b8bfd.js"><link rel="prefetch" href="/lanjz/assets/js/31.40eabd5c.js"><link rel="prefetch" href="/lanjz/assets/js/32.6c70da89.js"><link rel="prefetch" href="/lanjz/assets/js/33.cab03b59.js"><link rel="prefetch" href="/lanjz/assets/js/34.3db6323e.js"><link rel="prefetch" href="/lanjz/assets/js/35.6afe70c6.js"><link rel="prefetch" href="/lanjz/assets/js/36.fa682bb0.js"><link rel="prefetch" href="/lanjz/assets/js/37.14e22fc7.js"><link rel="prefetch" href="/lanjz/assets/js/38.f6e37055.js"><link rel="prefetch" href="/lanjz/assets/js/39.57cf63c3.js"><link rel="prefetch" href="/lanjz/assets/js/4.9615b643.js"><link rel="prefetch" href="/lanjz/assets/js/40.4a1e407a.js"><link rel="prefetch" href="/lanjz/assets/js/41.aa3e770a.js"><link rel="prefetch" href="/lanjz/assets/js/42.a2d69dbc.js"><link rel="prefetch" href="/lanjz/assets/js/43.f3336fa1.js"><link rel="prefetch" href="/lanjz/assets/js/44.64cba701.js"><link rel="prefetch" href="/lanjz/assets/js/45.502a03d7.js"><link rel="prefetch" href="/lanjz/assets/js/46.900d0131.js"><link rel="prefetch" href="/lanjz/assets/js/47.2599a969.js"><link rel="prefetch" href="/lanjz/assets/js/48.cc486645.js"><link rel="prefetch" href="/lanjz/assets/js/49.0090d76f.js"><link rel="prefetch" href="/lanjz/assets/js/5.1b9a30f9.js"><link rel="prefetch" href="/lanjz/assets/js/50.bd96bad0.js"><link rel="prefetch" href="/lanjz/assets/js/51.a1e5aa35.js"><link rel="prefetch" href="/lanjz/assets/js/52.2969e098.js"><link rel="prefetch" href="/lanjz/assets/js/53.98928f65.js"><link rel="prefetch" href="/lanjz/assets/js/54.2cb44d02.js"><link rel="prefetch" href="/lanjz/assets/js/55.046c30d5.js"><link rel="prefetch" href="/lanjz/assets/js/56.1b096eae.js"><link rel="prefetch" href="/lanjz/assets/js/57.7276ce3d.js"><link rel="prefetch" href="/lanjz/assets/js/58.d86f8e5c.js"><link rel="prefetch" href="/lanjz/assets/js/59.a3c85371.js"><link rel="prefetch" href="/lanjz/assets/js/6.b5ed71e8.js"><link rel="prefetch" href="/lanjz/assets/js/60.abe1c6f7.js"><link rel="prefetch" href="/lanjz/assets/js/61.6202e2d8.js"><link rel="prefetch" href="/lanjz/assets/js/62.edc87a05.js"><link rel="prefetch" href="/lanjz/assets/js/63.dd6518fc.js"><link rel="prefetch" href="/lanjz/assets/js/64.86f1fd70.js"><link rel="prefetch" href="/lanjz/assets/js/65.a7b54608.js"><link rel="prefetch" href="/lanjz/assets/js/66.18153618.js"><link rel="prefetch" href="/lanjz/assets/js/67.3bd0828b.js"><link rel="prefetch" href="/lanjz/assets/js/68.ed199eb7.js"><link rel="prefetch" href="/lanjz/assets/js/69.11cf4bf3.js"><link rel="prefetch" href="/lanjz/assets/js/7.6fafab4c.js"><link rel="prefetch" href="/lanjz/assets/js/70.d7411b7b.js"><link rel="prefetch" href="/lanjz/assets/js/71.7098b0d3.js"><link rel="prefetch" href="/lanjz/assets/js/72.a1063990.js"><link rel="prefetch" href="/lanjz/assets/js/73.2f90718b.js"><link rel="prefetch" href="/lanjz/assets/js/74.48c9d693.js"><link rel="prefetch" href="/lanjz/assets/js/75.c60cea8c.js"><link rel="prefetch" href="/lanjz/assets/js/76.ea57e27d.js"><link rel="prefetch" href="/lanjz/assets/js/77.ec9e6171.js"><link rel="prefetch" href="/lanjz/assets/js/78.99bd3385.js"><link rel="prefetch" href="/lanjz/assets/js/79.a493ccc0.js"><link rel="prefetch" href="/lanjz/assets/js/8.d4016234.js"><link rel="prefetch" href="/lanjz/assets/js/80.526f070b.js"><link rel="prefetch" href="/lanjz/assets/js/81.4d49acaa.js"><link rel="prefetch" href="/lanjz/assets/js/82.9565685e.js"><link rel="prefetch" href="/lanjz/assets/js/83.3363a629.js"><link rel="prefetch" href="/lanjz/assets/js/84.1b2fae0e.js"><link rel="prefetch" href="/lanjz/assets/js/85.91dd4cf9.js"><link rel="prefetch" href="/lanjz/assets/js/86.928e7c4a.js"><link rel="prefetch" href="/lanjz/assets/js/87.054f56b3.js"><link rel="prefetch" href="/lanjz/assets/js/88.0213a077.js"><link rel="prefetch" href="/lanjz/assets/js/89.f85cf355.js"><link rel="prefetch" href="/lanjz/assets/js/9.71c8a646.js"><link rel="prefetch" href="/lanjz/assets/js/90.66ee1b7f.js"><link rel="prefetch" href="/lanjz/assets/js/91.36315d64.js"><link rel="prefetch" href="/lanjz/assets/js/92.057ba58b.js"><link rel="prefetch" href="/lanjz/assets/js/93.f237933d.js"><link rel="prefetch" href="/lanjz/assets/js/94.21db5be7.js"><link rel="prefetch" href="/lanjz/assets/js/95.c52d541a.js"><link rel="prefetch" href="/lanjz/assets/js/96.37be205e.js"><link rel="prefetch" href="/lanjz/assets/js/97.8755f8f3.js"><link rel="prefetch" href="/lanjz/assets/js/98.c132f270.js"><link rel="prefetch" href="/lanjz/assets/js/99.e945fd40.js">
    <link rel="stylesheet" href="/lanjz/assets/css/0.styles.5dda244b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/lanjz/" class="home-link router-link-active"><!----> <span class="site-name">Hello Wold</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/lanjz/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/ES6/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/HTML5/" class="nav-link">
  HTML5
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Browser/" class="nav-link">
  Browser
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络&amp;算法" class="dropdown-title"><span class="title">网络&amp;算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="网络&amp;算法" class="mobile-dropdown-title"><span class="title">网络&amp;算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/network/" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Algorithm/" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/secure/" class="nav-link">
  Web安全
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Vue3/" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/qiankun/" class="nav-link">
  qiankun
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/NA/" class="nav-link">
  跨平台
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/Node/基础/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Package/" class="nav-link">
  yarn&amp;npm
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Webpack/" class="nav-link router-link-active">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Vite/" class="nav-link">
  Vite
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/数据库/" class="nav-link">
  SQL
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow down"></span></button> <button type="button" aria-label="工程化" class="mobile-dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/工程化/前端优化总结/" class="nav-link">
  前端优化总结
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/系统设计/" class="nav-link">
  系统设计
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/预加载&amp;预解析.html" class="nav-link">
  预加载&amp;预解析
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/重构改善既有代码的设计.html" class="nav-link">
  重构代码原则
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/开发与调试技巧.html" class="nav-link">
  开发与调试
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/组件设计的基本原则.html" class="nav-link">
  组件设计
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/公共模块管理.html" class="nav-link">
  公共模块管理
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/内存泄漏.html" class="nav-link">
  内存泄漏
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/前端异常捕获.html" class="nav-link">
  前端异常捕获
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/自动化部署.html" class="nav-link">
  自动化部署
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/疑难杂症.html" class="nav-link">
  问题小计
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="利其器" class="dropdown-title"><span class="title">利其器</span> <span class="arrow down"></span></button> <button type="button" aria-label="利其器" class="mobile-dropdown-title"><span class="title">利其器</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/利其器/Mac.html" class="nav-link">
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/利其器/Github.html" class="nav-link">
  Github
</a></li></ul></div></div><div class="nav-item"><a href="/lanjz/Im/" class="nav-link">
  关于我
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/lanjz/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/ES6/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/HTML5/" class="nav-link">
  HTML5
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Browser/" class="nav-link">
  Browser
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络&amp;算法" class="dropdown-title"><span class="title">网络&amp;算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="网络&amp;算法" class="mobile-dropdown-title"><span class="title">网络&amp;算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/network/" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Algorithm/" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/secure/" class="nav-link">
  Web安全
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Vue3/" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/qiankun/" class="nav-link">
  qiankun
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/NA/" class="nav-link">
  跨平台
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/Node/基础/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Package/" class="nav-link">
  yarn&amp;npm
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Webpack/" class="nav-link router-link-active">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/Vite/" class="nav-link">
  Vite
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/Node/数据库/" class="nav-link">
  SQL
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow down"></span></button> <button type="button" aria-label="工程化" class="mobile-dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/工程化/前端优化总结/" class="nav-link">
  前端优化总结
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/系统设计/" class="nav-link">
  系统设计
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/预加载&amp;预解析.html" class="nav-link">
  预加载&amp;预解析
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/重构改善既有代码的设计.html" class="nav-link">
  重构代码原则
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/开发与调试技巧.html" class="nav-link">
  开发与调试
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/组件设计的基本原则.html" class="nav-link">
  组件设计
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/公共模块管理.html" class="nav-link">
  公共模块管理
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/内存泄漏.html" class="nav-link">
  内存泄漏
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/前端异常捕获.html" class="nav-link">
  前端异常捕获
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/自动化部署.html" class="nav-link">
  自动化部署
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/工程化/疑难杂症.html" class="nav-link">
  问题小计
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="利其器" class="dropdown-title"><span class="title">利其器</span> <span class="arrow down"></span></button> <button type="button" aria-label="利其器" class="mobile-dropdown-title"><span class="title">利其器</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lanjz/利其器/Mac.html" class="nav-link">
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/lanjz/利其器/Github.html" class="nav-link">
  Github
</a></li></ul></div></div><div class="nav-item"><a href="/lanjz/Im/" class="nav-link">
  关于我
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/lanjz/Node/Webpack/Plugin.html" class="sidebar-link">Plugin</a></li><li><a href="/lanjz/Node/Webpack/Loader.html" class="sidebar-link">Loader</a></li><li><a href="/lanjz/Node/Webpack/Babel-Loader.html" class="sidebar-link">Babel</a></li><li><a href="/lanjz/Node/Webpack/css-loader&amp;style-loader.html" class="sidebar-link">CSS/Style-Loader</a></li><li><a href="/lanjz/Node/Webpack/library.html" class="sidebar-link">library</a></li><li><a href="/lanjz/Node/Webpack/原理/tree-shaking.html" class="sidebar-link">tree-shaking</a></li><li><a href="/lanjz/Node/Webpack/原理/code-split.html" class="active sidebar-link">code-split</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/lanjz/Node/Webpack/原理/code-split.html#prefetch-preload-modules" class="sidebar-link">Prefetch/Preload modules</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/lanjz/Node/Webpack/原理/code-split.html#demo" class="sidebar-link">Demo</a></li></ul></li><li class="sidebar-sub-header"><a href="/lanjz/Node/Webpack/原理/code-split.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/lanjz/Node/Webpack/原理/模块热替换.html" class="sidebar-link">HotModulePlacement</a></li><li><a href="/lanjz/Node/Webpack/构建优化方案.html" class="sidebar-link">构建优化方案</a></li><li><a href="/lanjz/Node/Webpack/配置小记.html" class="sidebar-link">配置小记</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="code-split"><a href="#code-split" class="header-anchor">#</a> code-split</h1> <p>在 webpack 启动的项目中，使用 <code>import()</code> 方法就可以实现动态加载模块，被动态加载的模块会被 webpack 分割成独立文件</p> <p>通过一个动态加载的粟子来看下 webpack 打包后的文件是如何处理分割后模块的</p> <p>源文件：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'AAAAAAAAAAAAA'</span><span class="token punctuation">)</span>

<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./modules/utils'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token constant">MB</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'MB'</span><span class="token punctuation">,</span> <span class="token constant">MB</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">'An error occurred while loading theS hllComponent'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ./modules/utils</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token constant">MA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行MA'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token constant">MB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行MB'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>打包后在 <code>dist</code> 文件下生成两个JS文件:</p> <ul><li><p><code>index.bundle.js</code></p></li> <li><p><code>src_modules_utils_js.bundle.js</code></p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.bundle.js</span>
<span class="token comment">/*! 下面中的代码为方便阅读稍手动做了点格式化 */</span>
<span class="token comment">/*! For license information please see index.bundle.js.LICENSE.txt */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> __webpack_modules__ <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> __webpack_module_cache__ <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> inProgress<span class="token punctuation">,</span> dataWebpackPrefix<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 获取模块的 export
     * @params {String} e: 模块
     * */</span>
    <span class="token keyword">function</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果已经获取过，则直接拿出来使用</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>__webpack_module_cache__<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> __webpack_module_cache__<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
        <span class="token keyword">var</span> r <span class="token operator">=</span> __webpack_module_cache__<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> __webpack_modules__<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> r<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    __webpack_require__<span class="token punctuation">.</span>m <span class="token operator">=</span> __webpack_modules__
    <span class="token comment">/**
     * 将模块中的方法映射到 e(r.exports)中
     * @params {Object} exports
     * @params {Object} r: 模块内 导出的方法
     * */</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">d</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> r</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> _ <span class="token keyword">in</span> r<span class="token punctuation">)</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            enumerable<span class="token operator">:</span> <span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">,</span>
            get<span class="token operator">:</span> r<span class="token punctuation">[</span>_<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    __webpack_require__<span class="token punctuation">.</span>f <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">e</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// __webpack_require__.f 保存着要加载的模块，遍历这些模块分别获取模块</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span>f<span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r<span class="token punctuation">,</span> _</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token comment">// 这里会执行 __webpack_require__.f.j</span>
              <span class="token comment">// 真正获取某模块的方法 e=&gt;模块名 r =&gt; 当前Promise[]</span>
              <span class="token keyword">return</span> __webpack_require__<span class="token punctuation">.</span>f<span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> r
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">u</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> e <span class="token operator">+</span> <span class="token string">&quot;.bundle.js&quot;</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">g</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;object&quot;</span> <span class="token operator">==</span> <span class="token keyword">typeof</span> globalThis<span class="token punctuation">)</span> <span class="token keyword">return</span> globalThis<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span> <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">&quot;return this&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;object&quot;</span> <span class="token operator">==</span> <span class="token keyword">typeof</span> window<span class="token punctuation">)</span> <span class="token keyword">return</span> window<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">o</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> r</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
    inProgress <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    dataWebpackPrefix <span class="token operator">=</span> <span class="token string">&quot;mind-map:&quot;</span>
    <span class="token comment">/**
     * @params {String} e : 模块路径
     * @params {Function} r
     * @params {String} _ : &quot;chunk-&quot; + 模块
     * */</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">l</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> r<span class="token punctuation">,</span> _</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>inProgress<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 如果 inProgress[e] 已存在，将当前函数添加到 inProgress[e] 队列中</span>
            inProgress<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> a<span class="token punctuation">,</span> t<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">!==</span> _<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> o <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> o <span class="token operator">&lt;</span> i<span class="token punctuation">.</span>length<span class="token punctuation">;</span> o<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 判断当前要加载模块是否已经存在于 dom中</span>
                    <span class="token keyword">var</span> c <span class="token operator">=</span> i<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> e <span class="token operator">||</span> c<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;data-webpack&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> dataWebpackPrefix <span class="token operator">+</span> _<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment">// 如果存在刚保存到变量a</span>
                        a <span class="token operator">=</span> c<span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">/* a || (t = !0, (a = document.createElement(&quot;script&quot;)).charset = &quot;utf-8&quot;, a.timeout = 120,
            __webpack_require__.nc &amp;&amp; a.setAttribute(&quot;nonce&quot;, __webpack_require__.nc), a.setAttribute(&quot;data-webpack&quot;, dataWebpackPrefix + _),
            a.src = e), inProgress[e] = [ r ];*/</span>
            <span class="token comment">// 将上面的注释的源代码转换了下，方便阅读</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">// 动态创建 script 标签加载模块</span>
                t <span class="token operator">=</span> <span class="token operator">!</span><span class="token number">0</span> <span class="token comment">// t = true</span>
                a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span>
                a<span class="token punctuation">.</span>charset <span class="token operator">=</span> <span class="token string">&quot;utf-8&quot;</span>
                a<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">120</span>
                __webpack_require__<span class="token punctuation">.</span>nc <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;nonce&quot;</span><span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span>nc<span class="token punctuation">)</span>
                a<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;data-webpack&quot;</span><span class="token punctuation">,</span> dataWebpackPrefix <span class="token operator">+</span> _<span class="token punctuation">)</span> <span class="token comment">// 标记 data-webpack 属性</span>
                a<span class="token punctuation">.</span>src <span class="token operator">=</span> e
            <span class="token punctuation">}</span>
            inProgress<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span> r <span class="token punctuation">]</span> <span class="token comment">// inProgress创建对象的队列</span>
            <span class="token comment">// n的作用就是当模块加载成功或者失败或者超时要做的事情</span>
            <span class="token comment">// 当成功时，r=a.onload方法，_=成功的事件信息，取出inProgress中保存的回调一一执行 t.forEach((e =&gt; e(_))，此时 _ 为成功后事件信息</span>
            <span class="token comment">// 当失败时，r=a.onerror，_=失败的事件信息，取出inProgress中保存的回调一一执行 t.forEach((e =&gt; e(_))，此时 _ 为失败后事件信息</span>
            <span class="token comment">// 当超时时，_ 为 {type: &quot;timeout&quot;,target: a}</span>
            <span class="token keyword">var</span> <span class="token function-variable function">n</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">r<span class="token punctuation">,</span> _</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                a<span class="token punctuation">.</span>onerror <span class="token operator">=</span> a<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> t <span class="token operator">=</span> inProgress<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">delete</span> inProgress<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>parentNode <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> t <span class="token operator">&amp;&amp;</span> t<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token function">e</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                r<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">r</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> u <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token function">n</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                type<span class="token operator">:</span> <span class="token string">&quot;timeout&quot;</span><span class="token punctuation">,</span>
                target<span class="token operator">:</span> a
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">12e4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 将动态创建script 标签 添加添加DOM,开始下载模块，并定义对应的 onerror 和 onload 方法</span>
            a<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token function">n</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>onerror<span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token function">n</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>onload<span class="token punctuation">)</span><span class="token punctuation">,</span> t <span class="token operator">&amp;&amp;</span> document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">r</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;undefined&quot;</span> <span class="token operator">!=</span> <span class="token keyword">typeof</span> Symbol <span class="token operator">&amp;&amp;</span> Symbol<span class="token punctuation">.</span>toStringTag <span class="token operator">&amp;&amp;</span> Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            value<span class="token operator">:</span> <span class="token string">&quot;Module&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">&quot;__esModule&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            value<span class="token operator">:</span> <span class="token operator">!</span><span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> e<span class="token punctuation">;</span>
        <span class="token comment">// importScripts 返回的undefined，暂不确定表示什么</span>
        __webpack_require__<span class="token punctuation">.</span>g<span class="token punctuation">.</span>importScripts <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>e <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span>g<span class="token punctuation">.</span>location <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> r <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span>g<span class="token punctuation">.</span>document<span class="token punctuation">;</span>
        <span class="token comment">// currentScript 表示当前执行脚本的信息，获取脚本的路径并赋值给 e</span>
        <span class="token comment">// 当前例子 e=http://localhost:63342/Hello-Word/mind-map-js/dist/index.bundle.js</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>e <span class="token operator">&amp;&amp;</span> r <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>r<span class="token punctuation">.</span>currentScript <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>e <span class="token operator">=</span> r<span class="token punctuation">.</span>currentScript<span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">!</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 如果没上一步获取不到，则通过获取 script 标签来获取脚本路径</span>
            <span class="token keyword">var</span> _ <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            _<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>e <span class="token operator">=</span> _<span class="token punctuation">[</span>_<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>e<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Automatic publicPath is not supported in this browser&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取脚本所在目录 __webpack_require__.p = e = http://localhost:63342/Hello-Word/mind-map-js/dist/</span>
        e <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">#.*$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\?.*$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\/[^\/]+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span>p <span class="token operator">=</span> e<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token punctuation">{</span>
            index<span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">/**
         * @params {String} r: 模块名，当前例子为 &quot;src_modules_utils_js&quot;
         * @params {Array&lt;Promise&gt;&gt;} _: 异步数组
         * */</span>
        <span class="token comment">// 参数 r 表示要获取的模块名</span>
        __webpack_require__<span class="token punctuation">.</span>f<span class="token punctuation">.</span><span class="token function-variable function">j</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">r<span class="token punctuation">,</span> _</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 等同于Object.prototype.hasOwnProperty.call(e, r)，判断 r(key) 是否包含在 e 中(是否之前获取过)</span>
            <span class="token keyword">var</span> a <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> r<span class="token punctuation">)</span> <span class="token operator">?</span> e<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">!==</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    _<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 如果a有值，则将 a[2] 保存到 _中，a[2]的意思下面的else分支会介绍到</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        <span class="token comment">// Promise 构造函数是同步的，这里面 “_” 表示 `resolve`, “t” 表示 `reject`</span>
                        <span class="token comment">// 将 `resolve` 和 `reject`，保存到 e[r]和变量a中</span>
                        a <span class="token operator">=</span> e<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span> _<span class="token punctuation">,</span> t <span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 将上文返回的Promise 一方面添加添加到 a[2]中，另一方面添加到 _ 中</span>
                    _<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// a[0] =&gt; Promise.resolve   a[1] =&gt; Promise.reject  a[2] =&gt; Promise</span>
                    <span class="token comment">// 获取这个模块的完整的路径，这里返回 // http://localhost:63342/Hello-Word/mind-map-js/dist/src_modules_utils_js.bundle.js</span>
                    <span class="token keyword">var</span> i <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span>p <span class="token operator">+</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">u</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">;</span>
                    <span class="token comment">// 加载模块i，加载完成后执行第二个函数参数</span>
                    __webpack_require__<span class="token punctuation">.</span><span class="token function">l</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        <span class="token comment">// 如果模块加载成功，执行这个回调时e[r]为0，所以 if 块中的代码只有失败的时候才能会执行</span>
                        <span class="token keyword">debugger</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> r<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">!==</span> <span class="token punctuation">(</span>a <span class="token operator">=</span> e<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>e<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">var</span> t <span class="token operator">=</span> _ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token string">&quot;load&quot;</span> <span class="token operator">===</span> _<span class="token punctuation">.</span>type <span class="token operator">?</span> <span class="token string">&quot;missing&quot;</span> <span class="token operator">:</span> _<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span> i <span class="token operator">=</span> _ <span class="token operator">&amp;&amp;</span> _<span class="token punctuation">.</span>target <span class="token operator">&amp;&amp;</span> _<span class="token punctuation">.</span>target<span class="token punctuation">.</span>src<span class="token punctuation">;</span>
                            o<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;Loading chunk &quot;</span> <span class="token operator">+</span> r <span class="token operator">+</span> <span class="token string">&quot; failed.\n(&quot;</span> <span class="token operator">+</span> t <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span>
                            o<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;ChunkLoadError&quot;</span>
                            o<span class="token punctuation">.</span>type <span class="token operator">=</span> t
                            o<span class="token punctuation">.</span>request <span class="token operator">=</span> i<span class="token punctuation">,</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;chunk-&quot;</span> <span class="token operator">+</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">// 保存 self.webpackChunkmind_map 原生 push 方法</span>
        <span class="token keyword">var</span> r <span class="token operator">=</span> self<span class="token punctuation">.</span>webpackChunkmind_map <span class="token operator">=</span> self<span class="token punctuation">.</span>webpackChunkmind_map <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> _ <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/**
         * 重写 push 方法
         * 这个 push方法 是要加载的模块（src_modules_utils_js）下载成功后，模块（src_modules_utils_js）内触发的
         * @params {Array} r: 成功下载模块后返回的内容
         * */</span>
        r<span class="token punctuation">.</span><span class="token function-variable function">push</span> <span class="token operator">=</span> <span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> a<span class="token punctuation">,</span> t<span class="token punctuation">,</span> <span class="token punctuation">[</span>i<span class="token punctuation">,</span> o<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> u <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> i<span class="token punctuation">.</span>length<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 下载成功后，将e中保存 resolve 保存到 u 中，并将 e[t] 重置为0</span>
                t <span class="token operator">=</span> i<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token comment">// t表示模块名</span>
                <span class="token comment">// e 是否包含这个 t 这个属性，</span>
                __webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> t<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> e<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>e<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                e<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// o： { 模块： 添加模块的方法}</span>
            <span class="token comment">// 将这个模块及对应的方法 保存到  __webpack_require__.m 中</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>a <span class="token keyword">in</span> o<span class="token punctuation">)</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span>m<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> o<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>c <span class="token operator">&amp;&amp;</span> <span class="token function">c</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span> u<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token punctuation">)</span> u<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 取出 resolve 并执行</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'AAAAAAAAAAAAA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;src_modules_utils_js&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 获取模块</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">__webpack_require__</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">,</span> <span class="token string">&quot;./src/modules/utils.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_ref</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> <span class="token constant">MB</span> <span class="token operator">=</span> _ref<span class="token punctuation">.</span><span class="token constant">MB</span><span class="token punctuation">;</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'MB'</span><span class="token punctuation">,</span> <span class="token constant">MB</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">'An error occurred while loading theS hllComponent'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//# sourceURL=webpack://mind-map/./src/index.js?</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 分离的模块</span>
<span class="token comment">/*! For license information please see src_modules_utils_js.bundle.js.LICENSE.txt */</span>
<span class="token punctuation">(</span>self<span class="token punctuation">.</span>webpackChunkmind_map <span class="token operator">=</span> self<span class="token punctuation">.</span>webpackChunkmind_map <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">[</span> <span class="token string">&quot;src_modules_utils_js&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;./src/modules/utils.js&quot;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">__unused_webpack_module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// eval(&quot;__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \&quot;MA\&quot;: () =&gt; /* binding */ MA,\n/* harmony export */   \&quot;MB\&quot;: () =&gt; /* binding */ MB\n/* harmony export */ });\nfunction MA() {\n  console.log('执行MA');\n}\nfunction MB() {\n  console.log('执行MB');\n}\n\n//# sourceURL=webpack://mind-map/./src/modules/utils.js?&quot;);</span>
        __webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span>
        __webpack_require__<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">MA</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">MA</span><span class="token punctuation">,</span>
            <span class="token function-variable function">MB</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">MB</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">function</span> <span class="token constant">MA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行MA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token keyword">function</span> <span class="token constant">MB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行MB'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="bundle代码分析"><a href="#bundle代码分析" class="header-anchor">#</a> bundle代码分析</h3> <p>首先要知道打包出来的文件代码都使用自执行函数形成一个单独的块级作用域</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'lan'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'jz'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面的两个 <code>name</code> 仅限于自己所在块级作用域中有效</p> <p>之后看下打包出来的入口文件中两个重要包含的属性和方法：</p> <p><strong><strong>webpack_require</strong></strong></p> <p>实现模块化的核心方法，作用就是返回模块导出的方法（<code>exports</code>），首先会尝试从 <code>__webpack_module_cache__</code> 中获取，如果 <code>__webpack_module_cache__</code> 中不存在，则通过执行 <code>__webpack_modules__[e](r, r.exports, __webpack_require__)</code> 获取 <code>exports</code></p> <p><strong><strong>webpack_modules</strong></strong></p> <p>当分离的文件下载完成后，模块中的要执行的内容将保存到 <code>__webpack_modules__</code> 对象中，所以先根据打包的例子（<code>src_modules_utils_js.bundle.js</code>）分析下其内容</p> <p><code>self.webpackChunkmind_map</code> 等于 <code>window.webpackChunkmind_map</code> 是在入口文件 <code>index.bundle</code> 中的定义的， <code>src_modules_utils_js.bundle.js</code> 的作用就是向 <code>webpackChunkmind_map</code> 属性 <code>push</code>了一个长度为 2 的数组，上文有注释这个 <code>push</code> 是 <code>webpack</code> 重写后的 <code>push</code>，这个数组的内容为：</p> <p><code>0</code>： - 模块名</p> <p><code>1</code>：  - 函数：<code>Function(__unused_webpack_module, __webpack_exports__, __webpack_require__)</code>，这个函数要执行代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>__webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span>
__webpack_require__<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">MA</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">MA</span><span class="token punctuation">,</span>
    <span class="token function-variable function">MB</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">MB</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token constant">MA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行MA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token constant">MB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行MB'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>  
<span class="token comment">// __webpack_require__.d 是 index.bundle.js 中定义的方法</span>
  __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">d</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> r</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> _ <span class="token keyword">in</span> r<span class="token punctuation">)</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          enumerable<span class="token operator">:</span> <span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">,</span>
          get<span class="token operator">:</span> r<span class="token punctuation">[</span>_<span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>重点看下第二行执行的方法 <code>__webpack_require__.d</code> ，<code>__webpack_require__.d</code> 的作用将当前文件中的导出的方法映射到当前参数 <code>__webpack_exports__</code> 中</p> <p>也就是上文 <code>__webpack_require__</code> 介绍中执行 <code>__webpack_modules__[e]</code> 的作用</p> <ul><li><p><code>__webpack_require__e(&quot;模块名&quot;)</code>: 获模块导出的所有方法和属性</p></li> <li><p><code>__webpack_require__.o(e, r)</code>:  <code>(e, r) =&gt; Object.prototype.hasOwnProperty.call(e, r)</code>，判断是否包含属性 <code>r</code></p></li> <li><p><code>__webpack_require__.g</code>: 当前运行的全局环境，当前例子指向 <code>window</code></p></li> <li><p><code>__webpack_require__.p</code>: 当前运行的JS模块所在目录</p></li> <li><p><code>__webpack_require__.u</code>: 返回模块的完成文件名 <code>__webpack_require__.u('abc')</code> 返回 <code>abc.bundle.js</code></p></li> <li><p><code>__webpack_require__.l(模块名，加载后回调，当前模块的一个标记)</code>：动态创建 <code>script</code> 下载模块</p></li></ul> <h3 id="执行bundler过程分析"><a href="#执行bundler过程分析" class="header-anchor">#</a> 执行bundler过程分析</h3> <ul><li><p>执行主文件方法 <code>console.log('AAAAAAAAAAAAA')</code></p></li> <li><p>调用 <code>__webpack_require__.e(&quot;src_modules_utils_js&quot;)</code> 获取 &quot;src_modules_utils_js&quot; 模块内容</p> <div class="language-js extra-class"><pre class="language-js"><code>  __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">e</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// __webpack_require__.f 保存着要加载的模块，遍历这些模块分别获取模块</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span>f<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r<span class="token punctuation">,</span> _</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// 真正获取某模块的方法 e=&gt;模块名 r =&gt; 当前Promise[]</span>
          <span class="token keyword">return</span> __webpack_require__<span class="token punctuation">.</span>f<span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> r
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
</code></pre></div><ul><li><p>调用 <code>__webpack_require__.f[_]</code> 获取模块,这里实际执行的是 <code>__webpack_require__.f.j</code></p></li> <li><p>执行 <code>__webpack_require__.l</code> 动态创建 <code>script</code> 下载模块，下完成将做两件事情：</p> <ol><li><p>下载的模块内将执行 <code>self.webpackChunkmind_map.push()</code> 方法，<code>push</code> 执行时，将下载的模块要主要代码主容保存到 <code>__webpack_require__.m</code> 对象中</p></li> <li><p>执行  <code>__webpack_require__.e(&quot;src_modules_utils_js&quot;)</code> 的 <code>resove()</code></p></li></ol></li></ul></li> <li><p>执行第一个 <code>then</code> 回调 <code>__webpack_require__.bind(__webpack_require__, &quot;./src/modules/utils.js&quot;)</code></p></li> <li><p>执行 <code>__webpack_require__(e)</code> 方法时，因为是首将加载这个模块，所以会执行 <code>__webpack_modules__[e](r, r.exports, __webpack_require__)</code> 方法，将下载的模块中的方法和属性保存到 <code>r.exports</code> 中返回</p></li> <li><p>执行第一个 <code>then</code> 回调，在回调中执行我们依赖分离模块的代码</p></li></ul> <h2 id="prefetch-preload-modules"><a href="#prefetch-preload-modules" class="header-anchor">#</a> Prefetch/Preload modules</h2> <p><code>Prefetch</code> 和 <code>Preload</code> 的区别</p> <ul><li><p><code>Preload</code> 在当前页面可能会用到，资源会与父块资源并行加载</p></li> <li><p><code>Prefetch</code> 可能是用于其它页面使用，资源会在当前页面空闲资源加载完后在空闲时间开始</p></li></ul> <p><strong>Prefetch</strong></p> <p>将之前代码改造如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'AAAAAAAAAAAAA'</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPrefetch: true */</span> <span class="token string">'./modules/utils'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token constant">MB</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'MB'</span><span class="token punctuation">,</span> <span class="token constant">MB</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">'An error occurred while loading theS hllComponent'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>打包后代码将会立即执行一个 <code>__webpack_require__.x()</code> 方法, 然后执行 <code>__webpack_require__.F.j</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// __webpack_require__.F.j</span>
__webpack_require__<span class="token punctuation">.</span><span class="token constant">F</span><span class="token punctuation">.</span><span class="token function-variable function">j</span> <span class="token operator">=</span> <span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">===</span> e<span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">[</span>_<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> r <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;link&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                __webpack_require__<span class="token punctuation">.</span>nc <span class="token operator">&amp;&amp;</span> r<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;nonce&quot;</span><span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">.</span>nc<span class="token punctuation">)</span>
                r<span class="token punctuation">.</span>rel <span class="token operator">=</span> <span class="token string">&quot;prefetch&quot;</span>
                r<span class="token punctuation">.</span>as <span class="token operator">=</span> <span class="token string">&quot;script&quot;</span>
                r<span class="token punctuation">.</span>href <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span>p <span class="token operator">+</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">u</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span>
                document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre></div><p><code>__webpack_require__.F.j</code> 的作用就是动态创建了一个 <code>&lt;link rel=&quot;prefetch&quot; as=&quot;script&quot; href=&quot;http://localhost:63342/Hello-Word/mind-map-js/dist/src_modules_utils_js.bundle.js&quot;&gt;</code> 到 <code>document</code> 中，这将指示浏览器在空闲时间预取 <code>src_modules_utils_js.bundle.js</code> 文件</p> <p><strong>Prefetch</strong></p> <p>使用 <code>Prefetch</code> 需要添加配置 <code>preload-webpack-plugin</code></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'AAAAAAAAAAAAA'</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPreload: true */</span> <span class="token string">'./modules/utils'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token constant">MB</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'MB'</span><span class="token punctuation">,</span> <span class="token constant">MB</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">'An error occurred while loading theS hllComponent'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>使用 <code>Prefetch</code> 主要是对 <code>index.html</code> 添加 <code>link</code> 标签，跟分割模块的逻辑没啥影响</p> <h3 id="demo"><a href="#demo" class="header-anchor">#</a> Demo</h3> <p>上面的分析反复看到过自己都有点懵，所以写个简单的 demo 方便理解 webpack 的模块化原理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> modules <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 用于保存模块</span>
	<span class="token keyword">let</span> _resolve <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token comment">// 获取模块，如果已经加载过则直接取，如果未加载过则直接 JSONP 加载模块</span>
    <span class="token keyword">function</span> <span class="token function">getModule</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>modules<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                _resolve <span class="token operator">=</span> resolve
                <span class="token function">JSonP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 子模块会调用这个方法，保存下载的模块到 modules</span>
    <span class="token keyword">var</span> <span class="token function-variable function">webpackJsonpCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 关于这行的作用，直接看后面的解释，当前选略过</span>
            <span class="token function">parent</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        modules<span class="token punctuation">[</span>data<span class="token punctuation">.</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>content
        _resolve<span class="token operator">&amp;&amp;</span><span class="token function">_resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
	<span class="token keyword">var</span> chunkLoadingGlobal <span class="token operator">=</span> self<span class="token punctuation">[</span><span class="token string">&quot;webpackChunkbase&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">[</span><span class="token string">&quot;webpackChunkbase&quot;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	chunkLoadingGlobal<span class="token punctuation">.</span>push <span class="token operator">=</span> <span class="token function">webpackJsonpCallback</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> chunkLoadingGlobal<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>chunkLoadingGlobal<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务代码</span>
	<span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span>
	btn<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">'按钮'</span>
	btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">getModule</span><span class="token punctuation">(</span><span class="token string">'module1'</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成功加载了模块MB'</span><span class="token punctuation">,</span> modules<span class="token punctuation">[</span><span class="token string">'module1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">'An error occurred while loading theS hllComponent'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>btn<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 模块子模块加截完成</span>
<span class="token keyword">function</span> <span class="token function">JSonP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		self<span class="token punctuation">[</span><span class="token string">&quot;webpackChunkbase&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          key<span class="token operator">:</span> <span class="token string">'module1'</span><span class="token punctuation">,</span>
          content<span class="token operator">:</span> <span class="token string">&quot;我是module1&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>关于子模块加载的思考：</strong></p> <p>从上文分析我们知道当子模块加载后会执行一个全局的方法 <code>(self.webpackChunkmind_map = self.webpackChunkmind_map || []).push()</code>，将当前模块内容保存到主模块 <code>webpack_module_cache</code> 中。</p> <p>那么问题了，如果当前页面同时加了多个被 webpack 打包出来的文件，也就是存在多个主模块，这里每个主模块都实现了相同的模块加载的方法，那么当子模块加载的时候怎么知道当前添加到哪个主文件中呢，按正常的逻辑 <code>self.webpackChunkmind_map</code> 应该是指向最后一个赋值的地方，那么无论哪个主模块加载的子模块都将添加到最后个加载的主模块中，如果真这样的话肯定会有问题，webpack 考虑到了这一点，所以注意一下这行代码：</p> <div class="language-js extra-class"><pre class="language-js"><code>	<span class="token keyword">var</span> chunkLoadingGlobal <span class="token operator">=</span> self<span class="token punctuation">[</span><span class="token string">&quot;webpackChunkbase&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">[</span><span class="token string">&quot;webpackChunkbase&quot;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	chunkLoadingGlobal<span class="token punctuation">.</span>push <span class="token operator">=</span> <span class="token function">webpackJsonpCallback</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> chunkLoadingGlobal<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>chunkLoadingGlobal<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>假设当前有页面加载了两个 webpack 打包出来的文件，第一个主模块运行时没有 <code>self[&quot;webpackChunkbase&quot;]</code>，所以 <code>chunkLoadingGlobal = []</code>，将这个方法通过下面那行的 <code>bind</code>保存到 <code>webpackJsonpCallback</code> 参数中</p> <p>当加载了第二个主模块时 <code>self[&quot;webpackChunkbase&quot;] = 之前模块的chunkLoadingGlobal</code>，也通过 <code>bind</code> 保存到 <code>webpackJsonpCallback</code> 参数中</p> <p>之后当子模块加载完后执行 <code>webpackJsonpCallback</code> 方法，看代码：</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">var</span> <span class="token function-variable function">webpackJsonpCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 有parent，执行之前的 webpackJsonpCallback 方法</span>
            <span class="token function">parent</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        modules<span class="token punctuation">[</span>data<span class="token punctuation">.</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>content
        _resolve<span class="token operator">&amp;&amp;</span><span class="token function">_resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><p><code>parent</code> 表示之前模块的 <code>webpackJsonpCallback</code> 方法，有的话就执行。也就是说某个主模块加载的子模块，将会被所有主模块收集！</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>webpack 实现自己实现了一个 <code>_webpack_reuqire_</code> 来模拟 <code>import</code> 的导入，并定义了一个全局属性<code>__webpack_modules__</code> 来保存模块</p> <p>使用动态创建 <code>script</code> 标签的方式来加载模块，被加载的模块在加载运行时，会添加到 <code>__webpack_modules__</code> 属性中，之后再获取模块内的方法和属性存到到 <code>export</code> 属性供调用者使用</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/lanjz/Node/Webpack/原理/tree-shaking.html" class="prev">
        tree-shaking
      </a></span> <span class="next"><a href="/lanjz/Node/Webpack/原理/模块热替换.html">
        HotModulePlacement
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/lanjz/assets/js/app.e889b93f.js" defer></script><script src="/lanjz/assets/js/2.30c9612b.js" defer></script><script src="/lanjz/assets/js/123.204284e3.js" defer></script>
  </body>
</html>
