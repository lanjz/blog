<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.0">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>createApp | 前端知识体系</title><meta name="description" content="前端总结与记录">
    <link rel="preload" href="/lanjz/assets/style-W1-NA_tl.css" as="style"><link rel="stylesheet" href="/lanjz/assets/style-W1-NA_tl.css">
    <link rel="modulepreload" href="/lanjz/assets/app-Ald2FT2K.js"><link rel="modulepreload" href="/lanjz/assets/createApp.html-awcKl4GT.js"><link rel="modulepreload" href="/lanjz/assets/createApp.html-6-59QIgY.js">
    <link rel="prefetch" href="/lanjz/assets/index.html-JVIXsN6C.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-K-Zta-lB.js" as="script"><link rel="prefetch" href="/lanjz/assets/剑指offer二.html-XU5_nfFm.js" as="script"><link rel="prefetch" href="/lanjz/assets/动态规划.html-f2tXLEcB.js" as="script"><link rel="prefetch" href="/lanjz/assets/回文串.html-RGloNiL6.js" as="script"><link rel="prefetch" href="/lanjz/assets/回溯.html-MFmuk0Vh.js" as="script"><link rel="prefetch" href="/lanjz/assets/字节前端.html-Vs6LGc4j.js" as="script"><link rel="prefetch" href="/lanjz/assets/小题.html-mpcfU0cQ.js" as="script"><link rel="prefetch" href="/lanjz/assets/时间_空间复杂度.html-Fd8bdk5A.js" as="script"><link rel="prefetch" href="/lanjz/assets/树.html-ErTTgM6L.js" as="script"><link rel="prefetch" href="/lanjz/assets/简单排序.html-ZHJcarxm.js" as="script"><link rel="prefetch" href="/lanjz/assets/HTML渲染过程.html-CJO0q71a.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html--TpyyQTm.js" as="script"><link rel="prefetch" href="/lanjz/assets/浏览器中的进程与线程.html-FvaO7GOB.js" as="script"><link rel="prefetch" href="/lanjz/assets/BFC和IFC.html-YcTRPUlu.js" as="script"><link rel="prefetch" href="/lanjz/assets/CSS3新特性.html-Qn5fIu-X.js" as="script"><link rel="prefetch" href="/lanjz/assets/Flex.html-2wd28ApR.js" as="script"><link rel="prefetch" href="/lanjz/assets/Image.html-Cn2RAlIn.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-YOJuWk8X.js" as="script"><link rel="prefetch" href="/lanjz/assets/多列.html-7ErAzjhR.js" as="script"><link rel="prefetch" href="/lanjz/assets/换肤.html-xdA19Wnn.js" as="script"><link rel="prefetch" href="/lanjz/assets/样式实现.html-bZi2_EWD.js" as="script"><link rel="prefetch" href="/lanjz/assets/移动端一像素问题.html-gROtSNvS.js" as="script"><link rel="prefetch" href="/lanjz/assets/移动端适配方案.html-1TSVSc2G.js" as="script"><link rel="prefetch" href="/lanjz/assets/适配iponeX.html-hf5PG0Ut.js" as="script"><link rel="prefetch" href="/lanjz/assets/Class.html-OG7IROpm.js" as="script"><link rel="prefetch" href="/lanjz/assets/Class继承.html-OppKcV7-.js" as="script"><link rel="prefetch" href="/lanjz/assets/Generater应用.html-hZZNA_Ks.js" as="script"><link rel="prefetch" href="/lanjz/assets/Generator.html-6ORuoafT.js" as="script"><link rel="prefetch" href="/lanjz/assets/Iterator.html-y-urD-Lx.js" as="script"><link rel="prefetch" href="/lanjz/assets/Map和WeakMap.html-JqaRDqGz.js" as="script"><link rel="prefetch" href="/lanjz/assets/Module.html-x6JW6YRT.js" as="script"><link rel="prefetch" href="/lanjz/assets/Module的加载实现.html-sdaFTKnq.js" as="script"><link rel="prefetch" href="/lanjz/assets/Promise.html-nuT73tHO.js" as="script"><link rel="prefetch" href="/lanjz/assets/Proxy.html-lP6tbkzu.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-NaQFGMHQ.js" as="script"><link rel="prefetch" href="/lanjz/assets/Set和WeakSet.html-H2UGarJs.js" as="script"><link rel="prefetch" href="/lanjz/assets/Symbol.html-WshncAi8.js" as="script"><link rel="prefetch" href="/lanjz/assets/async函数.html-kuvY0wv5.js" as="script"><link rel="prefetch" href="/lanjz/assets/函数的扩展.html-Iyo48GTW.js" as="script"><link rel="prefetch" href="/lanjz/assets/对象.html-5dKfIb87.js" as="script"><link rel="prefetch" href="/lanjz/assets/数组.html-qtaOa_1M.js" as="script"><link rel="prefetch" href="/lanjz/assets/装饰器.html-zSKtr7Ye.js" as="script"><link rel="prefetch" href="/lanjz/assets/HTML5新特性.html-Fn7S3-Dv.js" as="script"><link rel="prefetch" href="/lanjz/assets/IntersectionObserver.html-KIV9GeWE.js" as="script"><link rel="prefetch" href="/lanjz/assets/Preload和Prefetch.html-NCsBajp3.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-Qgo0itjr.js" as="script"><link rel="prefetch" href="/lanjz/assets/SVG.html-W61Lx9WL.js" as="script"><link rel="prefetch" href="/lanjz/assets/Worker.html-F_NlicHP.js" as="script"><link rel="prefetch" href="/lanjz/assets/requestIdleCallback和requestAnimationFrame.html-xCfAGjrE.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-rSDTuFMF.js" as="script"><link rel="prefetch" href="/lanjz/assets/DOM.html-m494CFjk.js" as="script"><link rel="prefetch" href="/lanjz/assets/JS基础.html-LI-Dfj3T.js" as="script"><link rel="prefetch" href="/lanjz/assets/JS核心.html-xbW06IL7.js" as="script"><link rel="prefetch" href="/lanjz/assets/JS面象对象.html-itclDhaS.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-DmxeSiKL.js" as="script"><link rel="prefetch" href="/lanjz/assets/事件.html-gJsKJm4n.js" as="script"><link rel="prefetch" href="/lanjz/assets/代码实现.html-WJh7Bt-t.js" as="script"><link rel="prefetch" href="/lanjz/assets/全面解析Module模式.html-HCNN4L4T.js" as="script"><link rel="prefetch" href="/lanjz/assets/函数.html-84R6Zulo.js" as="script"><link rel="prefetch" href="/lanjz/assets/吱不吱.html-ZCzroGDE.js" as="script"><link rel="prefetch" href="/lanjz/assets/吱不吱二.html-71MG43pB.js" as="script"><link rel="prefetch" href="/lanjz/assets/对象创建模式.html-EY9WS47-.js" as="script"><link rel="prefetch" href="/lanjz/assets/正则.html-zP8cDttd.js" as="script"><link rel="prefetch" href="/lanjz/assets/编写高质量JavaScript代码的基本要点.html-h67pNRVS.js" as="script"><link rel="prefetch" href="/lanjz/assets/设计模式.html-2dYB5rbb.js" as="script"><link rel="prefetch" href="/lanjz/assets/闭包.html-FXd2pYu9.js" as="script"><link rel="prefetch" href="/lanjz/assets/JSBridge.html-VaWAtYSJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-Wv_XIALy.js" as="script"><link rel="prefetch" href="/lanjz/assets/uniapp.html-XII-y5zd.js" as="script"><link rel="prefetch" href="/lanjz/assets/微信小程序.html-fKGuPSg9.js" as="script"><link rel="prefetch" href="/lanjz/assets/Component.html-7irTSv6K.js" as="script"><link rel="prefetch" href="/lanjz/assets/Diff.html-Njs99fYk.js" as="script"><link rel="prefetch" href="/lanjz/assets/Fiber.html-UjqvWCRG.js" as="script"><link rel="prefetch" href="/lanjz/assets/Hook.html-RW-IbvI0.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-hsgK4Mmy.js" as="script"><link rel="prefetch" href="/lanjz/assets/React-router5.html-hqmSFXv6.js" as="script"><link rel="prefetch" href="/lanjz/assets/React.html-cTKQvQXz.js" as="script"><link rel="prefetch" href="/lanjz/assets/React16新特性.html-cPl0TnlR.js" as="script"><link rel="prefetch" href="/lanjz/assets/ReactDOM.render.html-S37fpeG0.js" as="script"><link rel="prefetch" href="/lanjz/assets/React高级指引.html-PG1ncEho.js" as="script"><link rel="prefetch" href="/lanjz/assets/VirtualDom.html-hqnPajzV.js" as="script"><link rel="prefetch" href="/lanjz/assets/vsVue.html--fbgyxuZ.js" as="script"><link rel="prefetch" href="/lanjz/assets/吱不吱.html-iYfQ7HJq.js" as="script"><link rel="prefetch" href="/lanjz/assets/性能优化.html-jwg-xiWA.js" as="script"><link rel="prefetch" href="/lanjz/assets/时间切片.html-m9rqw2AF.js" as="script"><link rel="prefetch" href="/lanjz/assets/更新机制.html-g6F8kb9p.js" as="script"><link rel="prefetch" href="/lanjz/assets/服务端渲染.html-HtgcLnSJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/渲染过程.html-MGa0Z4sZ.js" as="script"><link rel="prefetch" href="/lanjz/assets/高阶组件.html-YyrmEkrT.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-Iv1Sfk1p.js" as="script"><link rel="prefetch" href="/lanjz/assets/nextTick.html-fvV6Bf7Q.js" as="script"><link rel="prefetch" href="/lanjz/assets/set.html-DRDlttHX.js" as="script"><link rel="prefetch" href="/lanjz/assets/Computed.html-uTFzDhC7.js" as="script"><link rel="prefetch" href="/lanjz/assets/Extend.html-9ejJMos_.js" as="script"><link rel="prefetch" href="/lanjz/assets/Paas应用.html-l3TaKcWu.js" as="script"><link rel="prefetch" href="/lanjz/assets/PatchNode.html-pknkOJAt.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-eZ-kIQZb.js" as="script"><link rel="prefetch" href="/lanjz/assets/Render.html-rVSt4IQy.js" as="script"><link rel="prefetch" href="/lanjz/assets/SSR.html-GI3OK809.js" as="script"><link rel="prefetch" href="/lanjz/assets/VueRouter.html-uvmwXVzV.js" as="script"><link rel="prefetch" href="/lanjz/assets/Vuex.html-DU70LyxY.js" as="script"><link rel="prefetch" href="/lanjz/assets/Vue性能优化.html-9GQ8Mo6_.js" as="script"><link rel="prefetch" href="/lanjz/assets/Watch.html-Pi60FZy9.js" as="script"><link rel="prefetch" href="/lanjz/assets/Watcher更新顺序.html-xW61Nn8W.js" as="script"><link rel="prefetch" href="/lanjz/assets/v-model.html-CWe6fvhp.js" as="script"><link rel="prefetch" href="/lanjz/assets/共享状态思想.html-L6j0qJwJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/吱不吱.html-41jjoQqC.js" as="script"><link rel="prefetch" href="/lanjz/assets/响应式原理.html-1zZVInb6.js" as="script"><link rel="prefetch" href="/lanjz/assets/数据代理.html-rSJ0qZCT.js" as="script"><link rel="prefetch" href="/lanjz/assets/模板到DOM.html-X5xBgfQO.js" as="script"><link rel="prefetch" href="/lanjz/assets/组件通信.html--bzEbma3.js" as="script"><link rel="prefetch" href="/lanjz/assets/Diff.html-iZknVISd.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-altxtlJH.js" as="script"><link rel="prefetch" href="/lanjz/assets/SFC还是JSX.html-9kHH01FQ.js" as="script"><link rel="prefetch" href="/lanjz/assets/V3升级目的.html-XOFTRam-.js" as="script"><link rel="prefetch" href="/lanjz/assets/setup.html-agbKrjho.js" as="script"><link rel="prefetch" href="/lanjz/assets/watch.html-Rv2xYs1Y.js" as="script"><link rel="prefetch" href="/lanjz/assets/使用区别.html-BRdKg_VF.js" as="script"><link rel="prefetch" href="/lanjz/assets/响应式API.html-kLMpDe61.js" as="script"><link rel="prefetch" href="/lanjz/assets/响应式原理.html-VElUtOck.js" as="script"><link rel="prefetch" href="/lanjz/assets/预渲染.html-iKQnYlrv.js" as="script"><link rel="prefetch" href="/lanjz/assets/CDN.html-d3-pEwZ4.js" as="script"><link rel="prefetch" href="/lanjz/assets/Cookie.html-tWMucGGe.js" as="script"><link rel="prefetch" href="/lanjz/assets/Cookie、Session、Token、JWT.html-c-iaw00X.js" as="script"><link rel="prefetch" href="/lanjz/assets/DNS.html-sMmeTlaH.js" as="script"><link rel="prefetch" href="/lanjz/assets/HTTPS.html-1oJT00Lv.js" as="script"><link rel="prefetch" href="/lanjz/assets/HTTP及演变.html-ZZKsszaQ.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-YU3PNDXQ.js" as="script"><link rel="prefetch" href="/lanjz/assets/Socket.html-CMmMXzlk.js" as="script"><link rel="prefetch" href="/lanjz/assets/TCP.html-YweI_rve.js" as="script"><link rel="prefetch" href="/lanjz/assets/WebSocket.html-hET2vNsJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/keep-alive.html-dyIjGQE3.js" as="script"><link rel="prefetch" href="/lanjz/assets/浏览器缓存.html-F0pC8CZB.js" as="script"><link rel="prefetch" href="/lanjz/assets/网络层的优化.html-Ny0iLBmG.js" as="script"><link rel="prefetch" href="/lanjz/assets/跨域.html-k1ak-RnT.js" as="script"><link rel="prefetch" href="/lanjz/assets/MD.html-riZ0FXUd.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-lFN4HhrJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/importHtmlEntry.html-Bt_-HVAA.js" as="script"><link rel="prefetch" href="/lanjz/assets/qiankun原理.html-sn4szg4h.js" as="script"><link rel="prefetch" href="/lanjz/assets/微前端.html-9SD87gSP.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-AAY0FVbL.js" as="script"><link rel="prefetch" href="/lanjz/assets/FE重构.html-DwIAtRSI.js" as="script"><link rel="prefetch" href="/lanjz/assets/Performance.html-XJwnOgeP.js" as="script"><link rel="prefetch" href="/lanjz/assets/Webpack构建优化.html-qu3TMVjc.js" as="script"><link rel="prefetch" href="/lanjz/assets/che.html-EIvE2k_c.js" as="script"><link rel="prefetch" href="/lanjz/assets/响应式原理分享.html-5hzrBJSS.js" as="script"><link rel="prefetch" href="/lanjz/assets/埋点分享.html-tNcPFOtE.js" as="script"><link rel="prefetch" href="/lanjz/assets/评审.html-CFy2hnMu.js" as="script"><link rel="prefetch" href="/lanjz/assets/Git.html-asACDm2Y.js" as="script"><link rel="prefetch" href="/lanjz/assets/Mac.html-FHuIo917.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-FWwyJ7Wz.js" as="script"><link rel="prefetch" href="/lanjz/assets/公共模块管理.html-vK2TZJi_.js" as="script"><link rel="prefetch" href="/lanjz/assets/内存泄漏.html-vhEJqtNV.js" as="script"><link rel="prefetch" href="/lanjz/assets/前端优化总结.html-IbH0-wJa.js" as="script"><link rel="prefetch" href="/lanjz/assets/前端异常捕获.html-8MT0OOQo.js" as="script"><link rel="prefetch" href="/lanjz/assets/埋点方案.html-7O0DCqan.js" as="script"><link rel="prefetch" href="/lanjz/assets/开发与调试技巧.html-9CFE-uoD.js" as="script"><link rel="prefetch" href="/lanjz/assets/性能定位.html-Olk8QhYZ.js" as="script"><link rel="prefetch" href="/lanjz/assets/性能指标.html-BPJF7vu_.js" as="script"><link rel="prefetch" href="/lanjz/assets/疑难杂症.html-ZbP_z218.js" as="script"><link rel="prefetch" href="/lanjz/assets/组件设计的基本原则.html-j2Shgk8T.js" as="script"><link rel="prefetch" href="/lanjz/assets/自动化部署.html-MJUe06km.js" as="script"><link rel="prefetch" href="/lanjz/assets/自动引入组和ICON.html-uHXvNg3m.js" as="script"><link rel="prefetch" href="/lanjz/assets/重构改善既有代码的设计.html-oSpjUemU.js" as="script"><link rel="prefetch" href="/lanjz/assets/预加载_预解析.html-9-GEq6Ab.js" as="script"><link rel="prefetch" href="/lanjz/assets/WebStorage.html-0oYETzTM.js" as="script"><link rel="prefetch" href="/lanjz/assets/svgMap.html-41xRVffe.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-sVgRWkMy.js" as="script"><link rel="prefetch" href="/lanjz/assets/README2.html-3bffviz3.js" as="script"><link rel="prefetch" href="/lanjz/assets/使用小记.html-3Drg9SlU.js" as="script"><link rel="prefetch" href="/lanjz/assets/Buffer.html-mauoMYEA.js" as="script"><link rel="prefetch" href="/lanjz/assets/Node中的进程和线程.html-UP4Qf6VZ.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-a9GSWKmB.js" as="script"><link rel="prefetch" href="/lanjz/assets/流.html-ZE0QLS4m.js" as="script"><link rel="prefetch" href="/lanjz/assets/待看.html-vyH8mypX.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-gsBFgZ5_.js" as="script"><link rel="prefetch" href="/lanjz/assets/NPM.html-WhhAhk-D.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-i6wfaGtI.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-bOnvkrvz.js" as="script"><link rel="prefetch" href="/lanjz/assets/Vite是啥.html-Yxp9sl-q.js" as="script"><link rel="prefetch" href="/lanjz/assets/Babel-Loader.html-IW4T3qlP.js" as="script"><link rel="prefetch" href="/lanjz/assets/Loader.html-C5I5wsxa.js" as="script"><link rel="prefetch" href="/lanjz/assets/ModuleFederation.html-cqMzwC4d.js" as="script"><link rel="prefetch" href="/lanjz/assets/Plugin.html-MM-fK6BG.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-46xZ8PYZ.js" as="script"><link rel="prefetch" href="/lanjz/assets/Webpack5新特性.html-5gabZ94D.js" as="script"><link rel="prefetch" href="/lanjz/assets/css-loader_style-loader.html-pLSX4Okd.js" as="script"><link rel="prefetch" href="/lanjz/assets/library.html-6naZcFqb.js" as="script"><link rel="prefetch" href="/lanjz/assets/优化实践之Vue-Cli.html-xTTPfaWi.js" as="script"><link rel="prefetch" href="/lanjz/assets/构建优化方案.html-wHYP-D34.js" as="script"><link rel="prefetch" href="/lanjz/assets/配置小记.html-4aZSEy87.js" as="script"><link rel="prefetch" href="/lanjz/assets/Node模块.html-u-jHCau1.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-8l6OotxC.js" as="script"><link rel="prefetch" href="/lanjz/assets/事件循环.html-Wm858CZQ.js" as="script"><link rel="prefetch" href="/lanjz/assets/内存泄露.html-3WfMbGkf.js" as="script"><link rel="prefetch" href="/lanjz/assets/吱不吱.html-Vy9XdT8o.js" as="script"><link rel="prefetch" href="/lanjz/assets/基础使用.html-7wTUZl_Y.js" as="script"><link rel="prefetch" href="/lanjz/assets/守护服务.html-eXy7-M62.js" as="script"><link rel="prefetch" href="/lanjz/assets/认识Node.html-hrvlYTWY.js" as="script"><link rel="prefetch" href="/lanjz/assets/进程和线程.html-rfrdXmW3.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-6FIp5ZXw.js" as="script"><link rel="prefetch" href="/lanjz/assets/setState.html-kr6OK3uK.js" as="script"><link rel="prefetch" href="/lanjz/assets/前端规范.html-A_RQL1aT.js" as="script"><link rel="prefetch" href="/lanjz/assets/项目模板.html-bYDltpX0.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-RctyhXey.js" as="script"><link rel="prefetch" href="/lanjz/assets/登录系统.html-vMK-Sfoz.js" as="script"><link rel="prefetch" href="/lanjz/assets/页面鉴权.html-Ncpj25CX.js" as="script"><link rel="prefetch" href="/lanjz/assets/code-split.html-KciLulg7.js" as="script"><link rel="prefetch" href="/lanjz/assets/tree-shaking.html-1AVHuCU8.js" as="script"><link rel="prefetch" href="/lanjz/assets/模块热替换.html-kMfYN6Rx.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-m2OxUXvl.js" as="script"><link rel="prefetch" href="/lanjz/assets/404.html-r6aI8Oiv.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-gCGnsD1d.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-Rv2x7gDj.js" as="script"><link rel="prefetch" href="/lanjz/assets/剑指offer二.html-dPW3jh4i.js" as="script"><link rel="prefetch" href="/lanjz/assets/动态规划.html-qNfdIr0S.js" as="script"><link rel="prefetch" href="/lanjz/assets/回文串.html-WQ6447Nk.js" as="script"><link rel="prefetch" href="/lanjz/assets/回溯.html-ikPcVAGj.js" as="script"><link rel="prefetch" href="/lanjz/assets/字节前端.html-mQhSDoRW.js" as="script"><link rel="prefetch" href="/lanjz/assets/小题.html-QEhnwKXG.js" as="script"><link rel="prefetch" href="/lanjz/assets/时间_空间复杂度.html-P26wGsrc.js" as="script"><link rel="prefetch" href="/lanjz/assets/树.html-eKG3mj_n.js" as="script"><link rel="prefetch" href="/lanjz/assets/简单排序.html-tGJhmktc.js" as="script"><link rel="prefetch" href="/lanjz/assets/HTML渲染过程.html-whNFsC3x.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-2ZJ_S4xJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/浏览器中的进程与线程.html-_dh8qCRm.js" as="script"><link rel="prefetch" href="/lanjz/assets/BFC和IFC.html-Sq6x0Td6.js" as="script"><link rel="prefetch" href="/lanjz/assets/CSS3新特性.html-7jDy2CwW.js" as="script"><link rel="prefetch" href="/lanjz/assets/Flex.html-5Gi3XiTZ.js" as="script"><link rel="prefetch" href="/lanjz/assets/Image.html-QCqE-0gd.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-zXojiK0o.js" as="script"><link rel="prefetch" href="/lanjz/assets/多列.html-QwPGzwAg.js" as="script"><link rel="prefetch" href="/lanjz/assets/换肤.html-xFudMRPx.js" as="script"><link rel="prefetch" href="/lanjz/assets/样式实现.html-Y3bdRzfc.js" as="script"><link rel="prefetch" href="/lanjz/assets/移动端一像素问题.html-cEYPvVUL.js" as="script"><link rel="prefetch" href="/lanjz/assets/移动端适配方案.html-OBSNKZ10.js" as="script"><link rel="prefetch" href="/lanjz/assets/适配iponeX.html-jz0GqIcK.js" as="script"><link rel="prefetch" href="/lanjz/assets/Class.html-f158sDF4.js" as="script"><link rel="prefetch" href="/lanjz/assets/Class继承.html-Vr1IfwSF.js" as="script"><link rel="prefetch" href="/lanjz/assets/Generater应用.html-fxrtYa80.js" as="script"><link rel="prefetch" href="/lanjz/assets/Generator.html-m1ZiWqhx.js" as="script"><link rel="prefetch" href="/lanjz/assets/Iterator.html-0qvonAXK.js" as="script"><link rel="prefetch" href="/lanjz/assets/Map和WeakMap.html-5ZfwNy8D.js" as="script"><link rel="prefetch" href="/lanjz/assets/Module.html-lrSCOfiP.js" as="script"><link rel="prefetch" href="/lanjz/assets/Module的加载实现.html-fVVrO5FZ.js" as="script"><link rel="prefetch" href="/lanjz/assets/Promise.html-QONhWTnt.js" as="script"><link rel="prefetch" href="/lanjz/assets/Proxy.html-Rd__sjGO.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-iMe-qnxk.js" as="script"><link rel="prefetch" href="/lanjz/assets/Set和WeakSet.html-h3Fp8LPH.js" as="script"><link rel="prefetch" href="/lanjz/assets/Symbol.html--U9oYW_T.js" as="script"><link rel="prefetch" href="/lanjz/assets/async函数.html-azEUnyhJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/函数的扩展.html-cr47W2NS.js" as="script"><link rel="prefetch" href="/lanjz/assets/对象.html-15LzYNMa.js" as="script"><link rel="prefetch" href="/lanjz/assets/数组.html-ST_FiCZC.js" as="script"><link rel="prefetch" href="/lanjz/assets/装饰器.html-XRPKtCKq.js" as="script"><link rel="prefetch" href="/lanjz/assets/HTML5新特性.html-3lo7BjxE.js" as="script"><link rel="prefetch" href="/lanjz/assets/IntersectionObserver.html-J_31XHSs.js" as="script"><link rel="prefetch" href="/lanjz/assets/Preload和Prefetch.html-NqSVn26z.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-oK8lV1b7.js" as="script"><link rel="prefetch" href="/lanjz/assets/SVG.html-ZUENktRQ.js" as="script"><link rel="prefetch" href="/lanjz/assets/Worker.html-345gsFNJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/requestIdleCallback和requestAnimationFrame.html-pwWJwQUA.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-sLu3-wda.js" as="script"><link rel="prefetch" href="/lanjz/assets/DOM.html-RYkdhWoU.js" as="script"><link rel="prefetch" href="/lanjz/assets/JS基础.html-95rWDjtE.js" as="script"><link rel="prefetch" href="/lanjz/assets/JS核心.html-1Unrxq6P.js" as="script"><link rel="prefetch" href="/lanjz/assets/JS面象对象.html-jHvALjix.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-hluk1qk4.js" as="script"><link rel="prefetch" href="/lanjz/assets/事件.html-IzBa1XIK.js" as="script"><link rel="prefetch" href="/lanjz/assets/代码实现.html-DPhJCP5q.js" as="script"><link rel="prefetch" href="/lanjz/assets/全面解析Module模式.html-Jowp4ScJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/函数.html-J8am2CqG.js" as="script"><link rel="prefetch" href="/lanjz/assets/吱不吱.html-g_Ul3Pyg.js" as="script"><link rel="prefetch" href="/lanjz/assets/吱不吱二.html-ABDTuU4k.js" as="script"><link rel="prefetch" href="/lanjz/assets/对象创建模式.html-3nv5HxG7.js" as="script"><link rel="prefetch" href="/lanjz/assets/正则.html-z5oCvr4w.js" as="script"><link rel="prefetch" href="/lanjz/assets/编写高质量JavaScript代码的基本要点.html-yJon5WBt.js" as="script"><link rel="prefetch" href="/lanjz/assets/设计模式.html-nx2P4fAa.js" as="script"><link rel="prefetch" href="/lanjz/assets/闭包.html-eQsYLdh5.js" as="script"><link rel="prefetch" href="/lanjz/assets/JSBridge.html-9InNOpg2.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-q_wVqNec.js" as="script"><link rel="prefetch" href="/lanjz/assets/uniapp.html-lwNVI-_D.js" as="script"><link rel="prefetch" href="/lanjz/assets/微信小程序.html-KMpOvu3s.js" as="script"><link rel="prefetch" href="/lanjz/assets/Component.html-vVGV9ry_.js" as="script"><link rel="prefetch" href="/lanjz/assets/Diff.html-k_3K2ptk.js" as="script"><link rel="prefetch" href="/lanjz/assets/Fiber.html-rU61o90-.js" as="script"><link rel="prefetch" href="/lanjz/assets/Hook.html-voe1E9gY.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-C1VWlx2L.js" as="script"><link rel="prefetch" href="/lanjz/assets/React-router5.html-bPyvD_p-.js" as="script"><link rel="prefetch" href="/lanjz/assets/React.html-mug5w1sD.js" as="script"><link rel="prefetch" href="/lanjz/assets/React16新特性.html-Ylo-dCLf.js" as="script"><link rel="prefetch" href="/lanjz/assets/ReactDOM.render.html-Ad16suaX.js" as="script"><link rel="prefetch" href="/lanjz/assets/React高级指引.html-1luR9uua.js" as="script"><link rel="prefetch" href="/lanjz/assets/VirtualDom.html-GNDo4Hqj.js" as="script"><link rel="prefetch" href="/lanjz/assets/vsVue.html-g8Dbon-t.js" as="script"><link rel="prefetch" href="/lanjz/assets/吱不吱.html-rvn5-7B2.js" as="script"><link rel="prefetch" href="/lanjz/assets/性能优化.html-ifrKrbMF.js" as="script"><link rel="prefetch" href="/lanjz/assets/时间切片.html-C0KjN_Jg.js" as="script"><link rel="prefetch" href="/lanjz/assets/更新机制.html-id0LXzAC.js" as="script"><link rel="prefetch" href="/lanjz/assets/服务端渲染.html-TzOTqgod.js" as="script"><link rel="prefetch" href="/lanjz/assets/渲染过程.html-JQbptwPj.js" as="script"><link rel="prefetch" href="/lanjz/assets/高阶组件.html-sVr7tjTb.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-yxsOZFS3.js" as="script"><link rel="prefetch" href="/lanjz/assets/nextTick.html-YMBaFxTf.js" as="script"><link rel="prefetch" href="/lanjz/assets/set.html-eNCcf9nk.js" as="script"><link rel="prefetch" href="/lanjz/assets/Computed.html-bvaibU3W.js" as="script"><link rel="prefetch" href="/lanjz/assets/Extend.html-J61IPUHr.js" as="script"><link rel="prefetch" href="/lanjz/assets/Paas应用.html-wb0QAHu-.js" as="script"><link rel="prefetch" href="/lanjz/assets/PatchNode.html-ZgQB71SU.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-QrquqpLL.js" as="script"><link rel="prefetch" href="/lanjz/assets/Render.html-Wg-4dJAc.js" as="script"><link rel="prefetch" href="/lanjz/assets/SSR.html-qWwJICNi.js" as="script"><link rel="prefetch" href="/lanjz/assets/VueRouter.html-K4QWJtME.js" as="script"><link rel="prefetch" href="/lanjz/assets/Vuex.html-4L0MS8at.js" as="script"><link rel="prefetch" href="/lanjz/assets/Vue性能优化.html-O1n9XJjM.js" as="script"><link rel="prefetch" href="/lanjz/assets/Watch.html-TXRPsi72.js" as="script"><link rel="prefetch" href="/lanjz/assets/Watcher更新顺序.html-Ef6Vc_d-.js" as="script"><link rel="prefetch" href="/lanjz/assets/v-model.html-03JWjc-g.js" as="script"><link rel="prefetch" href="/lanjz/assets/共享状态思想.html-3fz9MNnD.js" as="script"><link rel="prefetch" href="/lanjz/assets/吱不吱.html-OFy-vwdj.js" as="script"><link rel="prefetch" href="/lanjz/assets/响应式原理.html-E3IM1sND.js" as="script"><link rel="prefetch" href="/lanjz/assets/数据代理.html-WpqjcTdj.js" as="script"><link rel="prefetch" href="/lanjz/assets/模板到DOM.html-GMInOwlO.js" as="script"><link rel="prefetch" href="/lanjz/assets/组件通信.html-NQduKhVK.js" as="script"><link rel="prefetch" href="/lanjz/assets/Diff.html-TPw5otIm.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-xmJN32AI.js" as="script"><link rel="prefetch" href="/lanjz/assets/SFC还是JSX.html-dJI76Qp0.js" as="script"><link rel="prefetch" href="/lanjz/assets/V3升级目的.html-gjXuhN18.js" as="script"><link rel="prefetch" href="/lanjz/assets/setup.html-WRW84w0F.js" as="script"><link rel="prefetch" href="/lanjz/assets/watch.html-S0Hs4nSB.js" as="script"><link rel="prefetch" href="/lanjz/assets/使用区别.html-esH9Eebh.js" as="script"><link rel="prefetch" href="/lanjz/assets/响应式API.html-OoV8H7XC.js" as="script"><link rel="prefetch" href="/lanjz/assets/响应式原理.html-612jqGeq.js" as="script"><link rel="prefetch" href="/lanjz/assets/预渲染.html-jvb63vR1.js" as="script"><link rel="prefetch" href="/lanjz/assets/CDN.html-mHYm74bc.js" as="script"><link rel="prefetch" href="/lanjz/assets/Cookie.html-wc8JFet9.js" as="script"><link rel="prefetch" href="/lanjz/assets/Cookie、Session、Token、JWT.html-REFios2C.js" as="script"><link rel="prefetch" href="/lanjz/assets/DNS.html-vzqSW8Rv.js" as="script"><link rel="prefetch" href="/lanjz/assets/HTTPS.html-G4zsrPiY.js" as="script"><link rel="prefetch" href="/lanjz/assets/HTTP及演变.html-bLROXtCU.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-nIVjdETx.js" as="script"><link rel="prefetch" href="/lanjz/assets/Socket.html-Xd18dbXt.js" as="script"><link rel="prefetch" href="/lanjz/assets/TCP.html-03qvZf5K.js" as="script"><link rel="prefetch" href="/lanjz/assets/WebSocket.html-tV0OEju8.js" as="script"><link rel="prefetch" href="/lanjz/assets/keep-alive.html-P0l2ljac.js" as="script"><link rel="prefetch" href="/lanjz/assets/浏览器缓存.html-VnuSzIvu.js" as="script"><link rel="prefetch" href="/lanjz/assets/网络层的优化.html-05bHi6ns.js" as="script"><link rel="prefetch" href="/lanjz/assets/跨域.html-aPD6_mE9.js" as="script"><link rel="prefetch" href="/lanjz/assets/MD.html--VpcwVK5.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-YIpqrGda.js" as="script"><link rel="prefetch" href="/lanjz/assets/importHtmlEntry.html-Sl2QGpSg.js" as="script"><link rel="prefetch" href="/lanjz/assets/qiankun原理.html-hryyorAq.js" as="script"><link rel="prefetch" href="/lanjz/assets/微前端.html-yQgF43tL.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-g--RGFIp.js" as="script"><link rel="prefetch" href="/lanjz/assets/FE重构.html-cenuyfYw.js" as="script"><link rel="prefetch" href="/lanjz/assets/Performance.html-W7YA1Jxv.js" as="script"><link rel="prefetch" href="/lanjz/assets/Webpack构建优化.html-WZNmaKP0.js" as="script"><link rel="prefetch" href="/lanjz/assets/che.html-DVzlnAJB.js" as="script"><link rel="prefetch" href="/lanjz/assets/响应式原理分享.html-bJo4Y9JJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/埋点分享.html-Bkf2NBUB.js" as="script"><link rel="prefetch" href="/lanjz/assets/评审.html-9A-uJDQJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/Git.html-NtMDP-l7.js" as="script"><link rel="prefetch" href="/lanjz/assets/Mac.html-Da9ofStt.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-1_wonII5.js" as="script"><link rel="prefetch" href="/lanjz/assets/公共模块管理.html-rKK9G12p.js" as="script"><link rel="prefetch" href="/lanjz/assets/内存泄漏.html-A4MzLZTp.js" as="script"><link rel="prefetch" href="/lanjz/assets/前端优化总结.html-cJJwytrd.js" as="script"><link rel="prefetch" href="/lanjz/assets/前端异常捕获.html-cgxMuNGm.js" as="script"><link rel="prefetch" href="/lanjz/assets/埋点方案.html-z8EMI9Ym.js" as="script"><link rel="prefetch" href="/lanjz/assets/开发与调试技巧.html-cfb9WPIw.js" as="script"><link rel="prefetch" href="/lanjz/assets/性能定位.html-MyOwopuu.js" as="script"><link rel="prefetch" href="/lanjz/assets/性能指标.html-FiOGbvpg.js" as="script"><link rel="prefetch" href="/lanjz/assets/疑难杂症.html-laLWr_jm.js" as="script"><link rel="prefetch" href="/lanjz/assets/组件设计的基本原则.html-xouctjep.js" as="script"><link rel="prefetch" href="/lanjz/assets/自动化部署.html-ezFI4rd7.js" as="script"><link rel="prefetch" href="/lanjz/assets/自动引入组和ICON.html-51Kq7z_7.js" as="script"><link rel="prefetch" href="/lanjz/assets/重构改善既有代码的设计.html-VgHN3zpm.js" as="script"><link rel="prefetch" href="/lanjz/assets/预加载_预解析.html-fEyHi2D8.js" as="script"><link rel="prefetch" href="/lanjz/assets/WebStorage.html-5I2Ie-9V.js" as="script"><link rel="prefetch" href="/lanjz/assets/svgMap.html-9gs8TqLi.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-MZJ7gI82.js" as="script"><link rel="prefetch" href="/lanjz/assets/README2.html-eiThyMdk.js" as="script"><link rel="prefetch" href="/lanjz/assets/使用小记.html-GHYn6nza.js" as="script"><link rel="prefetch" href="/lanjz/assets/Buffer.html-PUjAypTk.js" as="script"><link rel="prefetch" href="/lanjz/assets/Node中的进程和线程.html-DJ0qKfhE.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-OP7qSl1I.js" as="script"><link rel="prefetch" href="/lanjz/assets/流.html-Ew9xdJRm.js" as="script"><link rel="prefetch" href="/lanjz/assets/待看.html-tKkAsW6r.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-bA4XTfMc.js" as="script"><link rel="prefetch" href="/lanjz/assets/NPM.html-PKgg6HNa.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-uykfjMJS.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-wVLsNFOk.js" as="script"><link rel="prefetch" href="/lanjz/assets/Vite是啥.html-odU5Q1Em.js" as="script"><link rel="prefetch" href="/lanjz/assets/Babel-Loader.html-wBKvh0xD.js" as="script"><link rel="prefetch" href="/lanjz/assets/Loader.html-SylkqTPJ.js" as="script"><link rel="prefetch" href="/lanjz/assets/ModuleFederation.html-KAUYmc4b.js" as="script"><link rel="prefetch" href="/lanjz/assets/Plugin.html-tR1KOI2M.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-QO1yxp4G.js" as="script"><link rel="prefetch" href="/lanjz/assets/Webpack5新特性.html-D6zzisAc.js" as="script"><link rel="prefetch" href="/lanjz/assets/css-loader_style-loader.html-Le8Myuff.js" as="script"><link rel="prefetch" href="/lanjz/assets/library.html-SVONEWKO.js" as="script"><link rel="prefetch" href="/lanjz/assets/优化实践之Vue-Cli.html-ws41JVjR.js" as="script"><link rel="prefetch" href="/lanjz/assets/构建优化方案.html-1sssXgwF.js" as="script"><link rel="prefetch" href="/lanjz/assets/配置小记.html-INptdL4Z.js" as="script"><link rel="prefetch" href="/lanjz/assets/Node模块.html-QHcWmale.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-se_U3O7k.js" as="script"><link rel="prefetch" href="/lanjz/assets/事件循环.html-8damQTn7.js" as="script"><link rel="prefetch" href="/lanjz/assets/内存泄露.html-ZiELe7oU.js" as="script"><link rel="prefetch" href="/lanjz/assets/吱不吱.html-dccFizbB.js" as="script"><link rel="prefetch" href="/lanjz/assets/基础使用.html-CywaQMxy.js" as="script"><link rel="prefetch" href="/lanjz/assets/守护服务.html-cN85Ia-X.js" as="script"><link rel="prefetch" href="/lanjz/assets/认识Node.html-e9qPZcdN.js" as="script"><link rel="prefetch" href="/lanjz/assets/进程和线程.html-BwFNkID6.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-fXrX4lrQ.js" as="script"><link rel="prefetch" href="/lanjz/assets/setState.html-UUIVBrMu.js" as="script"><link rel="prefetch" href="/lanjz/assets/前端规范.html-OF4DSR-5.js" as="script"><link rel="prefetch" href="/lanjz/assets/项目模板.html-4TZtSKHN.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-MJsGlSgr.js" as="script"><link rel="prefetch" href="/lanjz/assets/登录系统.html-XTln-tg-.js" as="script"><link rel="prefetch" href="/lanjz/assets/页面鉴权.html-DRUws0X7.js" as="script"><link rel="prefetch" href="/lanjz/assets/code-split.html-ssFY32_n.js" as="script"><link rel="prefetch" href="/lanjz/assets/tree-shaking.html-_o7suHcI.js" as="script"><link rel="prefetch" href="/lanjz/assets/模块热替换.html-oDoM-7zc.js" as="script"><link rel="prefetch" href="/lanjz/assets/index.html-wmxi4rQm.js" as="script"><link rel="prefetch" href="/lanjz/assets/404.html-FcKlCuRc.js" as="script"><link rel="prefetch" href="/lanjz/assets/Home-EeLRKCXk.js" as="script"><link rel="prefetch" href="/lanjz/assets/My-vgSJWZ2L.js" as="script"><link rel="prefetch" href="/lanjz/assets/NavSvg-vdeVFHp1.js" as="script"><link rel="prefetch" href="/lanjz/assets/Resume-y18x56ty.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/lanjz/" class=""><!----><span class="site-name">前端知识体系</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/lanjz/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/JavaScript/" class="" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/ES6/" class="" aria-label="ES6"><!--[--><!--]--> ES6 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/HTML5/" class="" aria-label="HTML5"><!--[--><!--]--> HTML5 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/CSS/" class="" aria-label="CSS"><!--[--><!--]--> CSS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Browser/" class="" aria-label="Browser"><!--[--><!--]--> Browser <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="网络&amp;算法"><span class="title">网络&amp;算法</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="网络&amp;算法"><span class="title">网络&amp;算法</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/network/" class="" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Algorithm/" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/secure/" class="" aria-label="Web安全"><!--[--><!--]--> Web安全 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="框架"><span class="title">框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="框架"><span class="title">框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/Vue/" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Vue3/" class="router-link-active" aria-label="Vue3"><!--[--><!--]--> Vue3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/React/" class="" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/qiankun/" class="" aria-label="qiankun"><!--[--><!--]--> qiankun <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/NA/" class="" aria-label="跨平台"><!--[--><!--]--> 跨平台 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Node"><span class="title">Node</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Node"><span class="title">Node</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/Node/基础/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/Api/" class="" aria-label="API"><!--[--><!--]--> API <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/Package/" class="" aria-label="yarn&amp;npm"><!--[--><!--]--> yarn&amp;npm <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/Webpack/" class="" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/Vite/" class="" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/ESBuild/" class="" aria-label="esbuild"><!--[--><!--]--> esbuild <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/数据库/" class="" aria-label="SQL"><!--[--><!--]--> SQL <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工程化"><span class="title">工程化</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工程化"><span class="title">工程化</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/工程化/前端优化总结.md" class="" aria-label="前端优化总结"><!--[--><!--]--> 前端优化总结 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/系统设计/" class="" aria-label="系统设计"><!--[--><!--]--> 系统设计 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/预加载&amp;预解析.md" class="" aria-label="预加载&amp;预解析"><!--[--><!--]--> 预加载&amp;预解析 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/重构改善既有代码的设计.md" class="" aria-label="重构代码原则"><!--[--><!--]--> 重构代码原则 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/开发与调试技巧.md" class="" aria-label="开发与调试"><!--[--><!--]--> 开发与调试 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/组件设计的基本原则.md" class="" aria-label="组件设计"><!--[--><!--]--> 组件设计 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/公共模块管理.md" class="" aria-label="公共模块管理"><!--[--><!--]--> 公共模块管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/内存泄漏.md" class="" aria-label="内存泄漏"><!--[--><!--]--> 内存泄漏 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/前端异常捕获.md" class="" aria-label="前端异常捕获"><!--[--><!--]--> 前端异常捕获 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/自动化部署.md" class="" aria-label="自动化部署"><!--[--><!--]--> 自动化部署 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/疑难杂症.md" class="" aria-label="问题小计"><!--[--><!--]--> 问题小计 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/性能指标.md" class="" aria-label="性能指标"><!--[--><!--]--> 性能指标 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/性能定位.md" class="" aria-label="性能定位"><!--[--><!--]--> 性能定位 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/前端规范/" class="" aria-label="规范"><!--[--><!--]--> 规范 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/前端规范/前端规范.md" class="" aria-label="前端规范"><!--[--><!--]--> 前端规范 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/前端规范/项目模板.md" class="" aria-label="项目模板"><!--[--><!--]--> 项目模板 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/埋点方案.md" class="" aria-label="埋点"><!--[--><!--]--> 埋点 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="利其器"><span class="title">利其器</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="利其器"><span class="title">利其器</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/利其器/Mac.md" class="" aria-label="Mac"><!--[--><!--]--> Mac <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/利其器/Git.md" class="" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="小工具"><span class="title">小工具</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="小工具"><span class="title">小工具</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/online-tools/MD.md" class="" aria-label="MD"><!--[--><!--]--> MD <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/lanjz/Im/" class="" aria-label="关于我"><!--[--><!--]--> 关于我 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/lanjz/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/JavaScript/" class="" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/ES6/" class="" aria-label="ES6"><!--[--><!--]--> ES6 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/HTML5/" class="" aria-label="HTML5"><!--[--><!--]--> HTML5 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/CSS/" class="" aria-label="CSS"><!--[--><!--]--> CSS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Browser/" class="" aria-label="Browser"><!--[--><!--]--> Browser <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="网络&amp;算法"><span class="title">网络&amp;算法</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="网络&amp;算法"><span class="title">网络&amp;算法</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/network/" class="" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Algorithm/" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/secure/" class="" aria-label="Web安全"><!--[--><!--]--> Web安全 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="框架"><span class="title">框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="框架"><span class="title">框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/Vue/" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Vue3/" class="router-link-active" aria-label="Vue3"><!--[--><!--]--> Vue3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/React/" class="" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/qiankun/" class="" aria-label="qiankun"><!--[--><!--]--> qiankun <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/NA/" class="" aria-label="跨平台"><!--[--><!--]--> 跨平台 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Node"><span class="title">Node</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Node"><span class="title">Node</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/Node/基础/" class="" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/Api/" class="" aria-label="API"><!--[--><!--]--> API <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/Package/" class="" aria-label="yarn&amp;npm"><!--[--><!--]--> yarn&amp;npm <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/Webpack/" class="" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/Vite/" class="" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/ESBuild/" class="" aria-label="esbuild"><!--[--><!--]--> esbuild <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/Node/数据库/" class="" aria-label="SQL"><!--[--><!--]--> SQL <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工程化"><span class="title">工程化</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工程化"><span class="title">工程化</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/工程化/前端优化总结.md" class="" aria-label="前端优化总结"><!--[--><!--]--> 前端优化总结 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/系统设计/" class="" aria-label="系统设计"><!--[--><!--]--> 系统设计 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/预加载&amp;预解析.md" class="" aria-label="预加载&amp;预解析"><!--[--><!--]--> 预加载&amp;预解析 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/重构改善既有代码的设计.md" class="" aria-label="重构代码原则"><!--[--><!--]--> 重构代码原则 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/开发与调试技巧.md" class="" aria-label="开发与调试"><!--[--><!--]--> 开发与调试 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/组件设计的基本原则.md" class="" aria-label="组件设计"><!--[--><!--]--> 组件设计 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/公共模块管理.md" class="" aria-label="公共模块管理"><!--[--><!--]--> 公共模块管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/内存泄漏.md" class="" aria-label="内存泄漏"><!--[--><!--]--> 内存泄漏 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/前端异常捕获.md" class="" aria-label="前端异常捕获"><!--[--><!--]--> 前端异常捕获 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/自动化部署.md" class="" aria-label="自动化部署"><!--[--><!--]--> 自动化部署 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/疑难杂症.md" class="" aria-label="问题小计"><!--[--><!--]--> 问题小计 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/性能指标.md" class="" aria-label="性能指标"><!--[--><!--]--> 性能指标 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/性能定位.md" class="" aria-label="性能定位"><!--[--><!--]--> 性能定位 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/前端规范/" class="" aria-label="规范"><!--[--><!--]--> 规范 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/前端规范/前端规范.md" class="" aria-label="前端规范"><!--[--><!--]--> 前端规范 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/前端规范/项目模板.md" class="" aria-label="项目模板"><!--[--><!--]--> 项目模板 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/工程化/埋点方案.md" class="" aria-label="埋点"><!--[--><!--]--> 埋点 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="利其器"><span class="title">利其器</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="利其器"><span class="title">利其器</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/利其器/Mac.md" class="" aria-label="Mac"><!--[--><!--]--> Mac <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lanjz/利其器/Git.md" class="" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="小工具"><span class="title">小工具</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="小工具"><span class="title">小工具</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/lanjz/online-tools/MD.md" class="" aria-label="MD"><!--[--><!--]--> MD <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/lanjz/Im/" class="" aria-label="关于我"><!--[--><!--]--> 关于我 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/lanjz/Vue3/V3%E5%8D%87%E7%BA%A7%E7%9B%AE%E7%9A%84.html" class="sidebar-item sidebar-heading" aria-label="V3升级目的"><!--[--><!--]--> V3升级目的 <!--[--><!--]--></a><!----></li><li><a href="/lanjz/Vue3/%E4%BD%BF%E7%94%A8%E5%8C%BA%E5%88%AB.html" class="sidebar-item sidebar-heading" aria-label="Vue3相比Vue2使用差异"><!--[--><!--]--> Vue3相比Vue2使用差异 <!--[--><!--]--></a><!----></li><li><a href="/lanjz/Vue3/SFC%E8%BF%98%E6%98%AFJSX.html" class="sidebar-item sidebar-heading" aria-label="SCF还是JSX"><!--[--><!--]--> SCF还是JSX <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/lanjz/Vue3/createApp.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="createApp"><!--[--><!--]--> createApp <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/lanjz/Vue3/createApp.html#app创建" class="router-link-active router-link-exact-active sidebar-item" aria-label="app创建"><!--[--><!--]--> app创建 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/lanjz/Vue3/createApp.html#mounted" class="router-link-active router-link-exact-active sidebar-item" aria-label="mounted"><!--[--><!--]--> mounted <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/lanjz/Vue3/createApp.html#组件更新" class="router-link-active router-link-exact-active sidebar-item" aria-label="组件更新"><!--[--><!--]--> 组件更新 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/lanjz/Vue3/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86.html" class="sidebar-item sidebar-heading" aria-label="响应式原理"><!--[--><!--]--> 响应式原理 <!--[--><!--]--></a><!----></li><li><a href="/lanjz/Vue3/watch.html" class="sidebar-item sidebar-heading" aria-label="Watch"><!--[--><!--]--> Watch <!--[--><!--]--></a><!----></li><li><a href="/lanjz/Vue3/setup.html" class="sidebar-item sidebar-heading" aria-label="setup"><!--[--><!--]--> setup <!--[--><!--]--></a><!----></li><li><a href="/lanjz/Vue3/%E5%93%8D%E5%BA%94%E5%BC%8FAPI.html" class="sidebar-item sidebar-heading" aria-label="粗读响应式API"><!--[--><!--]--> 粗读响应式API <!--[--><!--]--></a><!----></li><li><a href="/lanjz/Vue3/Diff.html" class="sidebar-item sidebar-heading" aria-label="Diff"><!--[--><!--]--> Diff <!--[--><!--]--></a><!----></li><li><a href="/lanjz/Vue3/%E9%A2%84%E6%B8%B2%E6%9F%93.html" class="sidebar-item sidebar-heading" aria-label="预渲染"><!--[--><!--]--> 预渲染 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="createapp" tabindex="-1"><a class="header-anchor" href="#createapp" aria-hidden="true">#</a> createApp</h1><p>Vue3.0和Vue2.0 创建应用的区别</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 2.0</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token comment">// 全局混入</span>
Vue<span class="token punctuation">.</span><span class="token function">minxin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 注册全局指令</span>
Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">&#39;focus&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 注册全局组件</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&#39;my-component-name&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 注册插件</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//绑定的全局方法和变量</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>xxx <span class="token operator">=</span> xxx
<span class="token comment">// 挂载</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    router<span class="token punctuation">,</span>
    <span class="token function-variable function">render</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 3.0</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 混</span>
app<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 注册全局组件</span>
app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&#39;SearchInput&#39;</span><span class="token punctuation">,</span> SearchInputComponent<span class="token punctuation">)</span>
<span class="token comment">// 注册全局指令</span>
app<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">&#39;focus&#39;</span><span class="token punctuation">,</span> FocusDirective<span class="token punctuation">)</span>
<span class="token comment">// 注册插件</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>LocalePlugin<span class="token punctuation">)</span>
<span class="token comment">// 添加全局属性</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span>$message <span class="token operator">=</span> message 
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#counter&#39;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3.0 将通过 <code>Vue.createApp({}).mount(&#39;#counter&#39;)</code> 创建一个应用并挂载实例，并在这个实例上面注册一些全局API</p><p>接下来分别看下 <code>createApp</code> 和 <code>mount</code> 方法的定义</p><h2 id="app创建" tabindex="-1"><a class="header-anchor" href="#app创建" aria-hidden="true">#</a> app创建</h2><p><code>createApp</code> 在源码中的定义：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>  <span class="token keyword">const</span> createApp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">ensureRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
      <span class="token function">injectNativeTagCheck</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">;</span>
    app<span class="token punctuation">.</span><span class="token function-variable function">mount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">containerOrSelector</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token comment">// mount 方法</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> app<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">function</span> <span class="token function">ensureRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这一步说明 renderer 只有一个，renderer 是通过 createRenderer 创建</span>
    <span class="token comment">// rendererOptions 是一些处理 DOM 元素相关的方法</span>
    <span class="token keyword">return</span> renderer <span class="token operator">||</span> <span class="token punctuation">(</span>renderer <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span>rendererOptions<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">baseCreateRenderer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">baseCreateRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 定义了一些操作更新 VNode 的一些方法</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      render<span class="token punctuation">,</span>
      hydrate<span class="token punctuation">,</span>
      <span class="token literal-property property">createApp</span><span class="token operator">:</span> <span class="token function">createAppAPI</span><span class="token punctuation">(</span>render<span class="token punctuation">,</span> hydrate<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从上面代码可以看到首先是通过 <code>createRenderer</code> 创建的一个 <code>renderer</code>, 这个<code>renderer</code> 只包含了三个属性</p><ul><li><p><code>render</code>： 创建VNode方法</p></li><li><p><code>hydrate</code>: 是否服务渲染的标识</p></li><li><p><code>createApp</code>: 通过 <code>createAppAPI(render, hydrate)</code> 返回一个创建Vue应用实例的方法</p></li></ul><p><code>createAppAPI(render, hydrate)</code> 定义如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>  <span class="token keyword">function</span> <span class="token function">createAppAPI</span><span class="token punctuation">(</span><span class="token parameter">render<span class="token punctuation">,</span> hydrate</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// rootComponent 正常就是我们传入的根 vue 组件</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token parameter">rootComponent<span class="token punctuation">,</span> rootProps <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>rootProps <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>rootProps<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">root props passed to app.mount() must be an object.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rootProps <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 创建当前 app 的上下文， 说白了就是存一些配置信息的一个对象，这个对象包含了 app、config、mixins、components、directives、provides属性</span>
      <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token function">createAppContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> installedPlugins <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> isMounted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span>app <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 创建一个 app 应用并保存到 context.app 中</span>
        <span class="token literal-property property">_uid</span><span class="token operator">:</span> uid$1<span class="token operator">++</span><span class="token punctuation">,</span>
        <span class="token literal-property property">_component</span><span class="token operator">:</span> rootComponent<span class="token punctuation">,</span>
        <span class="token literal-property property">_props</span><span class="token operator">:</span> rootProps<span class="token punctuation">,</span>
        <span class="token literal-property property">_container</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        <span class="token literal-property property">_context</span><span class="token operator">:</span> context<span class="token punctuation">,</span>
        version<span class="token punctuation">,</span>
        <span class="token keyword">get</span> <span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> context<span class="token punctuation">.</span>config<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">set</span> <span class="token function">config</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token punctuation">{</span>
            <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">app.config cannot be replaced. Modify individual options instead.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">plugin<span class="token punctuation">,</span> <span class="token operator">...</span>options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>installedPlugins<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Plugin has already been applied to target app.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>plugin <span class="token operator">&amp;&amp;</span> <span class="token function">isFunction</span><span class="token punctuation">(</span>plugin<span class="token punctuation">.</span>install<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            installedPlugins<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
            plugin<span class="token punctuation">.</span><span class="token function">install</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> <span class="token operator">...</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isFunction</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            installedPlugins<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">plugin</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> <span class="token operator">...</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">A plugin must either be a function or an object with an &quot;install&quot; </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
              <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">function.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> app<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">mixin</span><span class="token punctuation">(</span><span class="token parameter">mixin</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>context<span class="token punctuation">.</span>mixins<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>mixin<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              context<span class="token punctuation">.</span>mixins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>mixin<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token comment">// global mixin with props/emits de-optimizes props/emits</span>
              <span class="token comment">// normalization caching.</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>mixin<span class="token punctuation">.</span>props <span class="token operator">||</span> mixin<span class="token punctuation">.</span>emits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                context<span class="token punctuation">.</span>deopt <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
              <span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&#39;Mixin has already been applied to target app&#39;</span> <span class="token operator">+</span>
                <span class="token punctuation">(</span>mixin<span class="token punctuation">.</span>name <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mixin<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> app<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">component</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> component</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token punctuation">{</span>
            <span class="token function">validateComponentName</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> context<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>component<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> context<span class="token punctuation">.</span>components<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> context<span class="token punctuation">.</span>components<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Component &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; has already been registered in target app.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          context<span class="token punctuation">.</span>components<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> component<span class="token punctuation">;</span>
          <span class="token keyword">return</span> app<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">directive</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> directive</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token punctuation">{</span>
            <span class="token function">validateDirectiveName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>directive<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> context<span class="token punctuation">.</span>directives<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> context<span class="token punctuation">.</span>directives<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Directive &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; has already been registered in target app.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          context<span class="token punctuation">.</span>directives<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> directive<span class="token punctuation">;</span>
          <span class="token keyword">return</span> app<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">rootContainer<span class="token punctuation">,</span> isHydrate</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMounted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token function">createVNode</span><span class="token punctuation">(</span>rootComponent<span class="token punctuation">,</span> rootProps<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// store app context on the root VNode.</span>
            <span class="token comment">// this will be set on the root instance on initial mount.</span>
            vnode<span class="token punctuation">.</span>appContext <span class="token operator">=</span> context<span class="token punctuation">;</span>
            <span class="token comment">// HMR root reload</span>
            <span class="token punctuation">{</span>
              context<span class="token punctuation">.</span><span class="token function-variable function">reload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">render</span><span class="token punctuation">(</span><span class="token function">cloneVNode</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">,</span> rootContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isHydrate <span class="token operator">&amp;&amp;</span> hydrate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token function">hydrate</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> rootContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
              <span class="token function">render</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> rootContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            isMounted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            app<span class="token punctuation">.</span>_container <span class="token operator">=</span> rootContainer<span class="token punctuation">;</span>
            rootContainer<span class="token punctuation">.</span>__vue_app__ <span class="token operator">=</span> app<span class="token punctuation">;</span>
            <span class="token punctuation">{</span>
              <span class="token function">devtoolsInitApp</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> version<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> vnode<span class="token punctuation">.</span>component<span class="token punctuation">.</span>proxy<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">App has already been mounted.\n</span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
              <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">If you want to remount the same app, move your app creation logic </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
              <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">into a factory function and create fresh app instances for each </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
              <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mount - e.g. \`const createMyApp = () =&gt; createApp(App)\`</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>isMounted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>_container<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">{</span>
              <span class="token function">devtoolsUnmountApp</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Cannot unmount an app that is not mounted.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">provide</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> key <span class="token keyword">in</span> context<span class="token punctuation">.</span>provides<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">App already provides property with key &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">String</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;. </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
              <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">It will be overwritten with the new value.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token comment">// TypeScript doesn&#39;t allow symbols as index type</span>
          <span class="token comment">// https://github.com/Microsoft/TypeScript/issues/24587</span>
          context<span class="token punctuation">.</span>provides<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
          <span class="token keyword">return</span> app<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> app<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>createAppAPI</code> 方法返回的是 <code>createApp</code> 方法，也就是说 <code>Vue.createApp(CounterApp).mount(&#39;#counter&#39;) =&gt; const app = ensureRenderer().createApp(...args)</code>, 实际上执行的就是这里返回的 <code>createApp</code> 方法</p><p>从上面代码可以看到 <code>createApp</code> 返回一个 <code>app</code> 对象，这个对象就是返回的 vue 应用实例，这个对象定义了 <code>use</code>、<code>mixin</code>、<code>component</code>、<code>mount</code>等方法让我们可以添加全局方法、插件、组件等</p><p>至此， <code>app</code> 的创建大概捋了下，整个过程就是利用闭包创建一个对象， 一个app 的包含的属性如下图：</p><p><img src="/lanjz/assets/app-mw7BuA8m.jpg" alt=""></p><p>接下来看下 <code>mounted</code> 方法的调用，看下应用怎么挂载的</p><h2 id="mounted" tabindex="-1"><a class="header-anchor" href="#mounted" aria-hidden="true">#</a> mounted</h2><p><code>mounted</code> 是 <code>app</code> 中的属性，定义如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">rootContainer<span class="token punctuation">,</span> isHydrate</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMounted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token function">createVNode</span><span class="token punctuation">(</span>rootComponent<span class="token punctuation">,</span> rootProps<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// store app context on the root VNode.</span>
    <span class="token comment">// this will be set on the root instance on initial mount.</span>
    <span class="token comment">// vnode.appContext 保存 当前 app 的属性信息</span>
    vnode<span class="token punctuation">.</span>appContext <span class="token operator">=</span> context<span class="token punctuation">;</span>
    <span class="token comment">// HMR root reload</span>
    <span class="token punctuation">{</span>
      context<span class="token punctuation">.</span><span class="token function-variable function">reload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token function">cloneVNode</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">,</span> rootContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isHydrate <span class="token operator">&amp;&amp;</span> hydrate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">hydrate</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> rootContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">render</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> rootContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    isMounted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    app<span class="token punctuation">.</span>_container <span class="token operator">=</span> rootContainer<span class="token punctuation">;</span>
    rootContainer<span class="token punctuation">.</span>__vue_app__ <span class="token operator">=</span> app<span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
      <span class="token function">devtoolsInitApp</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> version<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> vnode<span class="token punctuation">.</span>component<span class="token punctuation">.</span>proxy<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">App has already been mounted.\n</span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">If you want to remount the same app, move your app creation logic </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">into a factory function and create fresh app instances for each </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mount - e.g. \`const createMyApp = () =&gt; createApp(App)\`</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>mounted</code> 重点做两件事：</p><ul><li><p><code>createVNode(rootComponent, rootProps)</code>： 创建 VNode， 暂不细究这里</p></li><li><p><code>render(vnode, rootContainer)</code>：渲染组件</p></li></ul><p>大致看下 <code>render</code> 方法：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// render</span>
<span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>vnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>container<span class="token punctuation">.</span>_vnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">unmount</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>_vnode<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">patch</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>_vnode <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">flushPostFlushCbs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  container<span class="token punctuation">.</span>_vnode <span class="token operator">=</span> vnode<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>render</code> 中执行 <code>patch</code> 方法,<code>patch</code> 也是 <code>diff</code> VNode节点的地方，这里是加载根元素，所以在 <code>patch</code> 方法内执行 <code>processComponent(n1, n2, container, anchor, parentComponent, parentSuspense, isSVG, optimized)</code> 方法，此的参数为：</p><ul><li><p>n1: <code>null</code></p></li><li><p>n2: 上文创建的 VNode 对象</p></li><li><p>container： 要挂载的 DOM 元素</p></li><li><p>其它参数均为 <code>null</code> 或 <code>false</code></p></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">processComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> container<span class="token punctuation">,</span> anchor<span class="token punctuation">,</span> parentComponent<span class="token punctuation">,</span> parentSuspense<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> optimized</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n1 <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n2<span class="token punctuation">.</span>shapeFlag <span class="token operator">&amp;</span> <span class="token number">512</span> <span class="token comment">/* COMPONENT_KEPT_ALIVE */</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      parentComponent<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">activate</span><span class="token punctuation">(</span>n2<span class="token punctuation">,</span> container<span class="token punctuation">,</span> anchor<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> optimized<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">mountComponent</span><span class="token punctuation">(</span>n2<span class="token punctuation">,</span> container<span class="token punctuation">,</span> anchor<span class="token punctuation">,</span> parentComponent<span class="token punctuation">,</span> parentSuspense<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> optimized<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">updateComponent</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> optimized<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>processComponent</code> 内部再执行 <code>mountComponent(n2, container, anchor, parentComponent, parentSuspense, isSVG, optimized)</code> 方法</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">mountComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">initialVNode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> anchor<span class="token punctuation">,</span> parentComponent<span class="token punctuation">,</span> parentSuspense<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> optimized</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建组件实例</span>
  <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token punctuation">(</span>initialVNode<span class="token punctuation">.</span>component <span class="token operator">=</span> <span class="token function">createComponentInstance</span><span class="token punctuation">(</span>initialVNode<span class="token punctuation">,</span> parentComponent<span class="token punctuation">,</span> parentSuspense<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> instance<span class="token punctuation">.</span>type<span class="token punctuation">.</span>__hmrId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">registerHMR</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// 将当前vnode 添加到全局栈 stack 中</span>
    <span class="token function">pushWarningContext</span><span class="token punctuation">(</span>initialVNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">startMeasure</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mount</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// inject renderer internals for keepAlive</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isKeepAlive</span><span class="token punctuation">(</span>initialVNode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    instance<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>renderer <span class="token operator">=</span> internals<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// resolve props and slots for setup context</span>
  <span class="token punctuation">{</span>
    <span class="token function">startMeasure</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">init</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 通过组件属性(data, compunted, watch 等)，组装组件实例</span>
  <span class="token function">setupComponent</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{</span>
    <span class="token function">endMeasure</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">init</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// setup() is async. This component relies on async logic to be resolved</span>
  <span class="token comment">// before proceeding</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> instance<span class="token punctuation">.</span>asyncDep<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    parentSuspense <span class="token operator">&amp;&amp;</span> parentSuspense<span class="token punctuation">.</span><span class="token function">registerDep</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> setupRenderEffect<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Give it a placeholder if this is not hydration</span>
    <span class="token comment">// TODO handle self-defined fallback</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>initialVNode<span class="token punctuation">.</span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> placeholder <span class="token operator">=</span> <span class="token punctuation">(</span>instance<span class="token punctuation">.</span>subTree <span class="token operator">=</span> <span class="token function">createVNode</span><span class="token punctuation">(</span>Comment<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">processCommentNode</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> placeholder<span class="token punctuation">,</span> container<span class="token punctuation">,</span> anchor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">setupRenderEffect</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> initialVNode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> anchor<span class="token punctuation">,</span> parentSuspense<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> optimized<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{</span>
    <span class="token function">popWarningContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">endMeasure</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mount</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>mountComponent</code> 方法先是通过 <code>createComponentInstance</code> 创建一个对象，这里暂时取名就组件实例对象，源码：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>  <span class="token keyword">function</span> <span class="token function">createComponentInstance</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> suspense</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取 type， type是当前根组件信息，下面是一个type的例子</span>
    <span class="token comment">// data: ƒ data()</span>
    <span class="token comment">// mounted: ƒ mounted()</span>
    <span class="token comment">// render: ƒ render(_ctx, _cache)</span>
    <span class="token comment">// template: &quot;↵    Counter: {{ counter }}↵&quot;</span>
    <span class="token comment">// __emits: null</span>
    <span class="token comment">// __props: []</span>
    <span class="token comment">// __proto__: Object</span>

    <span class="token keyword">const</span> type <span class="token operator">=</span> vnode<span class="token punctuation">.</span>type<span class="token punctuation">;</span>
    <span class="token comment">// vnode.appContext 是 createApp方法中，定义的上下文,粟：</span>
    <span class="token comment">// app: {_uid: 0, _component: {…}, _props: null, _container: null, _context: {…}, …}</span>
    <span class="token comment">// components: {}</span>
    <span class="token comment">// config: {performance: false, globalProperties: {…}, optionMergeStrategies: {…}, isNativeTag: ƒ, isCustomElement: ƒ, …}</span>
    <span class="token comment">// directives: {}</span>
    <span class="token comment">// mixins: []</span>
    <span class="token comment">// provides: {}</span>
    <span class="token comment">// reload: () =&gt; {…}</span>

    <span class="token keyword">const</span> appContext <span class="token operator">=</span> <span class="token punctuation">(</span>parent <span class="token operator">?</span> parent<span class="token punctuation">.</span>appContext <span class="token operator">:</span> vnode<span class="token punctuation">.</span>appContext<span class="token punctuation">)</span> <span class="token operator">||</span> emptyAppContext<span class="token punctuation">;</span>
    <span class="token comment">// 创建一个 instance 对象</span>
    <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">uid</span><span class="token operator">:</span> uid$2<span class="token operator">++</span><span class="token punctuation">,</span>
      vnode<span class="token punctuation">,</span>
      type<span class="token punctuation">,</span>
      parent<span class="token punctuation">,</span>
      appContext<span class="token punctuation">,</span>
      <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">next</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">subTree</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">update</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">render</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">exposed</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">withProxy</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">effects</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">provides</span><span class="token operator">:</span> parent <span class="token operator">?</span> parent<span class="token punctuation">.</span>provides <span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>appContext<span class="token punctuation">.</span>provides<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">accessCache</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">renderCache</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// local resovled assets</span>
      <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">directives</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token comment">// resolved props and emits options</span>
      <span class="token literal-property property">propsOptions</span><span class="token operator">:</span> <span class="token function">normalizePropsOptions</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> appContext<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">emitsOptions</span><span class="token operator">:</span> <span class="token function">normalizeEmitsOptions</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> appContext<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// emit</span>
      <span class="token literal-property property">emit</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">emitted</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token comment">// state</span>
      <span class="token literal-property property">ctx</span><span class="token operator">:</span> <span class="token constant">EMPTY_OBJ</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token constant">EMPTY_OBJ</span><span class="token punctuation">,</span>
      <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token constant">EMPTY_OBJ</span><span class="token punctuation">,</span>
      <span class="token literal-property property">attrs</span><span class="token operator">:</span> <span class="token constant">EMPTY_OBJ</span><span class="token punctuation">,</span>
      <span class="token literal-property property">slots</span><span class="token operator">:</span> <span class="token constant">EMPTY_OBJ</span><span class="token punctuation">,</span>
      <span class="token literal-property property">refs</span><span class="token operator">:</span> <span class="token constant">EMPTY_OBJ</span><span class="token punctuation">,</span>
      <span class="token literal-property property">setupState</span><span class="token operator">:</span> <span class="token constant">EMPTY_OBJ</span><span class="token punctuation">,</span>
      <span class="token literal-property property">setupContext</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token comment">// suspense related</span>
      suspense<span class="token punctuation">,</span>
      <span class="token literal-property property">suspenseId</span><span class="token operator">:</span> suspense <span class="token operator">?</span> suspense<span class="token punctuation">.</span>pendingId <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">asyncDep</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">asyncResolved</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token comment">// lifecycle hooks</span>
      <span class="token comment">// not using enums here because it results in computed properties</span>
      <span class="token literal-property property">isMounted</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">isUnmounted</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">isDeactivated</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">bc</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">bm</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">m</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">bu</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">u</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">um</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">bum</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">da</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">rtg</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">rtc</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">ec</span><span class="token operator">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
      instance<span class="token punctuation">.</span>ctx <span class="token operator">=</span> <span class="token function">createRenderContext</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// root 指定当前 instance</span>
    instance<span class="token punctuation">.</span>root <span class="token operator">=</span> parent <span class="token operator">?</span> parent<span class="token punctuation">.</span>root <span class="token operator">:</span> instance<span class="token punctuation">;</span>
    instance<span class="token punctuation">.</span>emit <span class="token operator">=</span> <span class="token function">emit</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
      <span class="token function">devtoolsComponentAdded</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>createRenderContext</code> 的方法定义如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>  <span class="token keyword">function</span> <span class="token function">createRenderContext</span><span class="token punctuation">(</span><span class="token parameter">instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// expose internal instance for proxy handlers</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> instance
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// expose public properties</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>publicPropertiesMap<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> publicPropertiesMap<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// intercepted by the proxy so no need for implementation,</span>
        <span class="token comment">// but needed to prevent set errors</span>
        <span class="token literal-property property">set</span><span class="token operator">:</span> <span class="token constant">NOOP</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// expose global properties</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> globalProperties <span class="token punctuation">}</span> <span class="token operator">=</span> instance<span class="token punctuation">.</span>appContext<span class="token punctuation">.</span>config<span class="token punctuation">;</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>globalProperties<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> globalProperties<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">set</span><span class="token operator">:</span> <span class="token constant">NOOP</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> target<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>createRenderContext</code> 方法的目的就是给当前组件 <code>insatcne</code> 代理一些方法：</p><ul><li><p><code>$el</code>、<code>$data</code>、<code>$attrs</code>、<code>$props</code>等等</p></li><li><p>包括使用 <code>app.config.globalProperties</code> 添加的全局属性和方法，也在这里做了代理</p></li></ul><p><code>createComponentInstance</code> 执行完后返回当前创建的 <code>instance</code>,回到 <code>mountComponent</code> 方法中，接下直接看 <code>setupRenderEffect(instance, initialVNode, container, anchor, parentSuspense, isSVG, optimized);</code> 方法的调用</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">setupRenderEffect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">instance<span class="token punctuation">,</span> initialVNode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> anchor<span class="token punctuation">,</span> parentSuspense<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> optimized</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// create reactive effect for rendering</span>
  instance<span class="token punctuation">.</span>update <span class="token operator">=</span> <span class="token function">effect</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">componentEffect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// componentEffect 代码</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token function">createDevEffectOptions</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// createDevEffectOptions 返回四个属性</span>
<span class="token keyword">function</span> <span class="token function">createDevEffectOptions</span><span class="token punctuation">(</span><span class="token parameter">instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
     <span class="token literal-property property">scheduler</span><span class="token operator">:</span> queueJob<span class="token punctuation">,</span>
     <span class="token literal-property property">allowRecurse</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
     <span class="token literal-property property">onTrack</span><span class="token operator">:</span> instance<span class="token punctuation">.</span>rtc <span class="token operator">?</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token function">invokeArrayFns</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>rtc<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span>
     <span class="token literal-property property">onTrigger</span><span class="token operator">:</span> instance<span class="token punctuation">.</span>rtg <span class="token operator">?</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token function">invokeArrayFns</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>rtg<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">void</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面给 <code>instance.update</code> 赋值一个 <code>effect</code>，先看下 <code>effect</code> 的定义，<strong>终于来了一个重点：这里的 <code>effect</code> 相当于 vue2.0的 <code>watcher</code></strong></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>  <span class="token comment">// effect</span>
  <span class="token keyword">function</span> <span class="token function">effect</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token constant">EMPTY_OBJ</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEffect</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fn <span class="token operator">=</span> fn<span class="token punctuation">.</span>raw<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 中式翻译：创建响度式效果</span>
    <span class="token comment">// effect 是个函数</span>
    <span class="token keyword">const</span> effect <span class="token operator">=</span> <span class="token function">createReactiveEffect</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>lazy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 执行 effect</span>
      <span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> effect<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">// createReactiveEffect： 创建一个 effect 函数</span>
  <span class="token keyword">function</span> <span class="token function">createReactiveEffect</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">effect</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">reactiveEffect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>effect<span class="token punctuation">.</span>active<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> options<span class="token punctuation">.</span>scheduler <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// effectStack 是个全局属性，收集 effect</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>effectStack<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">cleanup</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 清除 effect.deps 中收集到的 effect，当前是首次挂载根组件，所以 deps 是没东西中</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token comment">// 启动跟踪, 往全局属性 trackStack 添加一个 true</span>
          <span class="token function">enableTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          effectStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 添加当前的 effect 到 effectStack 数组中</span>
          activeEffect <span class="token operator">=</span> effect<span class="token punctuation">;</span> <span class="token comment">// activeEffect 为全局属性，保存当前的 effect</span>
          <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 执行回调， 即 componentEffect 方法</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">finally</span> <span class="token punctuation">{</span>
          <span class="token comment">// 渲染完成后将当前的 effect 推出</span>
          effectStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">resetTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          activeEffect <span class="token operator">=</span> effectStack<span class="token punctuation">[</span>effectStack<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>id <span class="token operator">=</span> uid<span class="token operator">++</span><span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>allowRecurse <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>allowRecurse<span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>_isEffect <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>active <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>raw <span class="token operator">=</span> fn<span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>deps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 看到了个奇怪的属性，在vue2中 deps是跟事件收集有关系的东西</span>
    effect<span class="token punctuation">.</span>options <span class="token operator">=</span> options<span class="token punctuation">;</span>
    <span class="token keyword">return</span> effect<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">// cleanup</span>
  <span class="token keyword">function</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token parameter">effect</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> deps <span class="token punctuation">}</span> <span class="token operator">=</span> effect<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>deps<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> deps<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        deps<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      deps<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>  <span class="token keyword">let</span> shouldTrack <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> trackStack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">pauseTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    trackStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>shouldTrack<span class="token punctuation">)</span><span class="token punctuation">;</span>
    shouldTrack <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">enableTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    trackStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>shouldTrack<span class="token punctuation">)</span><span class="token punctuation">;</span>
    shouldTrack <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当执行的 <code>effect</code> 的时候，将当前 <code>effect</code> 保存到全局，最后执行回调 <code>fn</code> 即 <code>componentEffect</code> 方法渲染组件到DOM，这部分的过程先不细究，这里就完成了组件一次渲染同时在渲染过程中问到依赖的属性时，全局的 <code>effect</code> 就被当前的属性收集</p><h2 id="组件更新" tabindex="-1"><a class="header-anchor" href="#组件更新" aria-hidden="true">#</a> 组件更新</h2><p>接下来大概分析当属性更新时，如果重新触发组件的更新</p><p>当属性更新时，被 <code>proxy</code> 的 <code>set</code> 劫持，执行 <code>trigger(target, &quot;set&quot; /* SET */, key, value, oldValue)</code> 方法，这个方法就是取出收集的 <code>effect</code> 执行 <code>effect.options.scheduler(effect)</code> 方法</p><p>回到上文找到<code>scheduler</code> 方法定义的位置，在 <code>setupRenderEffect</code> 中的 <code>createDevEffectOptions</code> 中</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">setupRenderEffect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">instance<span class="token punctuation">,</span> initialVNode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> anchor<span class="token punctuation">,</span> parentSuspense<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> optimized</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// create reactive effect for rendering</span>
  instance<span class="token punctuation">.</span>update <span class="token operator">=</span> <span class="token function">effect</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">componentEffect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// componentEffect 代码</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token function">createDevEffectOptions</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// createDevEffectOptions 返回四个属性</span>
<span class="token keyword">function</span> <span class="token function">createDevEffectOptions</span><span class="token punctuation">(</span><span class="token parameter">instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
     <span class="token literal-property property">scheduler</span><span class="token operator">:</span> queueJob<span class="token punctuation">,</span>
     <span class="token literal-property property">allowRecurse</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
     <span class="token literal-property property">onTrack</span><span class="token operator">:</span> instance<span class="token punctuation">.</span>rtc <span class="token operator">?</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token function">invokeArrayFns</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>rtc<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span>
     <span class="token literal-property property">onTrigger</span><span class="token operator">:</span> instance<span class="token punctuation">.</span>rtg <span class="token operator">?</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token function">invokeArrayFns</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>rtg<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">void</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//queueJob</span>
  <span class="token keyword">function</span> <span class="token function">queueJob</span><span class="token punctuation">(</span><span class="token parameter">job</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// the dedupe search uses the startIndex argument of Array.includes()</span>
    <span class="token comment">// by default the search index includes the current job that is being run</span>
    <span class="token comment">// so it cannot recursively trigger itself again.</span>
    <span class="token comment">// if the job is a watch() callback, the search will start with a +1 index to</span>
    <span class="token comment">// allow it recursively trigger itself - it is the user&#39;s responsibility to</span>
    <span class="token comment">// ensure it doesn&#39;t end up in an infinite loop.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span>length <span class="token operator">||</span>
      <span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>job<span class="token punctuation">,</span> isFlushing <span class="token operator">&amp;&amp;</span> job<span class="token punctuation">.</span>allowRecurse <span class="token operator">?</span> flushIndex <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">:</span> flushIndex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
      job <span class="token operator">!==</span> currentPreFlushParentJob<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">queueFlush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>根据上文， <code>scheduler</code> 的作用就是将当前 <code>effect</code> 添加到微任务队列 <code>queue</code> 中，执行 <code>queueFlush();</code>, 待事件循环清理</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>  <span class="token keyword">function</span> <span class="token function">queueFlush</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isFlushing <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isFlushPending<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      isFlushPending <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      currentFlushPromise <span class="token operator">=</span> resolvedPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>flushJobs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>  <span class="token keyword">function</span> <span class="token function">flushJobs</span><span class="token punctuation">(</span><span class="token parameter">seen</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isFlushPending <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    isFlushing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
      seen <span class="token operator">=</span> seen <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">flushPreFlushCbs</span><span class="token punctuation">(</span>seen<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Sort queue before flush.</span>
    <span class="token comment">// This ensures that:</span>
    <span class="token comment">// 1. Components are updated from parent to child. (because parent is always</span>
    <span class="token comment">//    created before the child so its render effect will have smaller</span>
    <span class="token comment">//    priority number)</span>
    <span class="token comment">// 2. If a component is unmounted during a parent component&#39;s update,</span>
    <span class="token comment">//    its update can be skipped.</span>
    queue<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">getId</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">getId</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span>flushIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> flushIndex <span class="token operator">&lt;</span> queue<span class="token punctuation">.</span>length<span class="token punctuation">;</span> flushIndex<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> job <span class="token operator">=</span> queue<span class="token punctuation">[</span>flushIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>job<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">checkRecursiveUpdates</span><span class="token punctuation">(</span>seen<span class="token punctuation">,</span> job<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token function">callWithErrorHandling</span><span class="token punctuation">(</span>job<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">14</span> <span class="token comment">/* SCHEDULER */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      flushIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      queue<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">flushPostFlushCbs</span><span class="token punctuation">(</span>seen<span class="token punctuation">)</span><span class="token punctuation">;</span>
      isFlushing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      currentFlushPromise <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token comment">// some postFlushCb queued jobs!</span>
      <span class="token comment">// keep flushing until it drains.</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span>length <span class="token operator">||</span> pendingPostFlushCbs<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">flushJobs</span><span class="token punctuation">(</span>seen<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>  <span class="token keyword">function</span> <span class="token function">callWithErrorHandling</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> type<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> res<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      res <span class="token operator">=</span> args <span class="token operator">?</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">handleError</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最终会执行的 <code>job</code> 回调， 加成一下 <code>createReactiveEffect</code> 方法的调用</p><p>根据上文中的 <code>scheduler</code> 的调用， <code>effect.options.scheduler(effect)</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>  <span class="token keyword">function</span> <span class="token function">createReactiveEffect</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">effect</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">reactiveEffect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>effect<span class="token punctuation">.</span>active<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> options<span class="token punctuation">.</span>scheduler <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>effectStack<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">cleanup</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token function">enableTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          effectStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">;</span>
          activeEffect <span class="token operator">=</span> effect<span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">finally</span> <span class="token punctuation">{</span>
          effectStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">resetTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          activeEffect <span class="token operator">=</span> effectStack<span class="token punctuation">[</span>effectStack<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>id <span class="token operator">=</span> uid<span class="token operator">++</span><span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>allowRecurse <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>allowRecurse<span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>_isEffect <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>active <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>raw <span class="token operator">=</span> fn<span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>deps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    effect<span class="token punctuation">.</span>options <span class="token operator">=</span> options<span class="token punctuation">;</span>
    <span class="token keyword">return</span> effect<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到队列中的的 <code>job</code> 就是 <code>reactiveEffect</code>， <code>reactiveEffect</code> 执行 <code>fn</code> 回调 即 <code>componentEffect</code> 方法渲染组件</p><p>好像跑题了~</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 156081289@qq.com">156081289@qq.com</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/lanjz/Vue3/SFC%E8%BF%98%E6%98%AFJSX.html" class="" aria-label="SCF还是JSX"><!--[--><!--]--> SCF还是JSX <!--[--><!--]--></a></span><span class="next"><a href="/lanjz/Vue3/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86.html" class="" aria-label="响应式原理"><!--[--><!--]--> 响应式原理 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/lanjz/assets/app-Ald2FT2K.js" defer></script>
  </body>
</html>
